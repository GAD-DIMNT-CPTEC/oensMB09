       !        
       !        Cray Inc. Decompilation
       !        Notice - This output is provided for information only.
       !        
       !        Cray Inc. reserves the right to change the format of this
       !        information at any time and does not guarantee the
       !        readability or accuracy of this information.
       !        
       !        This information may not be compilable and corresponds to
       !        the internal representation of the program during the
       !        optimization phase of the compilation process.
       !        
       !        Source                :  RadiationDriver.f90
       !        File                  :  RadiationDriver.opt
       !        Network               :  Gemini interconnect
       !        Target                :  X86, 64-bit, sse3
       !        
  149.       
  149.       subroutine initradiationdriver( monl, yrl, kmax, sl, nls )
  128.       t$9 = kmax
  133.       t$45 = _zla( 0, kmax )
  135.       if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'LCH' ) then
  128.          goto 10
  135.       else if (  _substr(ilwrad,1,_ltrim(  _substr(ilwrad,1,3) )) == 'HRS' ) then
  135.    10    continue
  136.          call initradcola
  136.       endif
  141.       if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'UKM' ) then
  137.          goto 20
  141.       else if (  _substr(ilwrad,1,_ltrim(  _substr(ilwrad,1,3) )) == 'UKM' ) then
  141.    20    continue
  142.          call initradukmo( kmax, sl(1), nls )
  142.       endif
  145.       monday(1) = 0
  145.       $monday_WR0_R0 = 0
  145.       $I_L145_6 = 0
  145. !dir$ unroll 4
  145.       do
  145.          $monday_WR0_R0 = $monday_WR0_R0 + monl(1 + $I_L145_6)
  145.          monday(2 + $I_L145_6) = $monday_WR0_R0
  145.          $I_L145_6 = 1 + $I_L145_6
  145.          if ( $I_L145_6 >= 11 ) exit
  145.       enddo
  147.       call initgetoz( yrl, kmax, sl(1) )
  149.       return
  149.       end
  149.       
  151.       
  151.       subroutine initradtim( monl )
  154.       monday(1) = 0
  155.       $monday_WR0_R0 = 0
  155.       $I_L155_6 = 0
  155. !dir$ unroll 4
  155.       do
  156.          $monday_WR0_R0 = $monday_WR0_R0 + monl(1 + $I_L155_6)
  156.          monday(2 + $I_L155_6) = $monday_WR0_R0
  157.          $I_L155_6 = 1 + $I_L155_6
  155.          if ( $I_L155_6 >= 11 ) exit
  155.       enddo
  158.       return
  158.       end
  158.       
  160.       
  160.       subroutine initgetoz( yrl, kmax, sl )
  160.       t$10 = kmax
  164.       t$46 = _zla( 0, kmax )
  170.       ozone%header%a_contig = 1
  170.       ozone%dim_1%LB = 1
  170.       ozone%dim_1%EX = 18
  170.       ozone%dim_1%SM = 1
  170.       ozone%dim_2%LB = 1
  170.       ozone%dim_2%EX = 37
  170.       ozone%dim_2%SM = 18
  170.       ozone%dim_3%LB = 1
  170.       ozone%dim_3%EX = 4
  170.       ozone%dim_3%SM = 666
  170.       $_allo_P0(0) = 0x1000000000001L
  170.       $_allo_P0(1) = loc( ozone )
  170.       call __allocate( $_allo_P0, 0, 0, _fcd( 0, 0 ) )
  189.       $I_L189_20 = 0
  189.       do
  189.          $I_L189_8 = 0
  189. !dir$ ivdep
  189.          do
  189.             (ozone%base_addr)(1 + $I_L189_8, 1 + $I_L189_20, 1, 0) = t$429(1 + $I_L189_8, 1 + $I_L189_20)
  212.             (ozone%base_addr)(1 + $I_L189_8, 7 + $I_L189_20, 1, 0) = t$432(1 + $I_L189_8, 1 + $I_L189_20)
  235.             (ozone%base_addr)(1 + $I_L189_8, 13 + $I_L189_20, 1, 0) = t$435(1 + $I_L189_8, 1 + $I_L189_20)
  258.             (ozone%base_addr)(1 + $I_L189_8, 19 + $I_L189_20, 1, 0) = t$438(1 + $I_L189_8, 1 + $I_L189_20)
  281.             (ozone%base_addr)(1 + $I_L189_8, 25 + $I_L189_20, 1, 0) = t$441(1 + $I_L189_8, 1 + $I_L189_20)
  304.             (ozone%base_addr)(1 + $I_L189_8, 31 + $I_L189_20, 1, 0) = t$444(1 + $I_L189_8, 1 + $I_L189_20)
  189.             $I_L189_8 = 1 + $I_L189_8
  189.             if ( $I_L189_8 >= 18 ) exit
  189.          enddo
  334.          $I_L334_12 = 0
  334. !dir$ ivdep
  334.          do
  334.             (ozone%base_addr)(1 + $I_L334_12, 1 + $I_L189_20, 2, 0) = t$448(1 + $I_L334_12, 1 + $I_L189_20)
  354.             (ozone%base_addr)(1 + $I_L334_12, 7 + $I_L189_20, 2, 0) = t$451(1 + $I_L334_12, 1 + $I_L189_20)
  374.             (ozone%base_addr)(1 + $I_L334_12, 13 + $I_L189_20, 2, 0) = t$454(1 + $I_L334_12, 1 + $I_L189_20)
  394.             (ozone%base_addr)(1 + $I_L334_12, 19 + $I_L189_20, 2, 0) = t$457(1 + $I_L334_12, 1 + $I_L189_20)
  414.             (ozone%base_addr)(1 + $I_L334_12, 25 + $I_L189_20, 2, 0) = t$460(1 + $I_L334_12, 1 + $I_L189_20)
  434.             (ozone%base_addr)(1 + $I_L334_12, 31 + $I_L189_20, 2, 0) = t$463(1 + $I_L334_12, 1 + $I_L189_20)
  334.             $I_L334_12 = 1 + $I_L334_12
  334.             if ( $I_L334_12 >= 18 ) exit
  334.          enddo
  461.          $I_L461_14 = 0
  461. !dir$ ivdep
  461.          do
  461.             (ozone%base_addr)(1 + $I_L461_14, 1 + $I_L189_20, 3, 0) = t$467(1 + $I_L461_14, 1 + $I_L189_20)
  481.             (ozone%base_addr)(1 + $I_L461_14, 7 + $I_L189_20, 3, 0) = t$470(1 + $I_L461_14, 1 + $I_L189_20)
  501.             (ozone%base_addr)(1 + $I_L461_14, 13 + $I_L189_20, 3, 0) = t$473(1 + $I_L461_14, 1 + $I_L189_20)
  521.             (ozone%base_addr)(1 + $I_L461_14, 19 + $I_L189_20, 3, 0) = t$476(1 + $I_L461_14, 1 + $I_L189_20)
  541.             (ozone%base_addr)(1 + $I_L461_14, 25 + $I_L189_20, 3, 0) = t$479(1 + $I_L461_14, 1 + $I_L189_20)
  561.             (ozone%base_addr)(1 + $I_L461_14, 31 + $I_L189_20, 3, 0) = t$482(1 + $I_L461_14, 1 + $I_L189_20)
  461.             $I_L461_14 = 1 + $I_L461_14
  461.             if ( $I_L461_14 >= 18 ) exit
  461.          enddo
  588.          $I_L588_16 = 0
  588. !dir$ ivdep
  588.          do
  588.             (ozone%base_addr)(1 + $I_L588_16, 1 + $I_L189_20, 4, 0) = t$486(1 + $I_L588_16, 1 + $I_L189_20)
  608.             (ozone%base_addr)(1 + $I_L588_16, 7 + $I_L189_20, 4, 0) = t$489(1 + $I_L588_16, 1 + $I_L189_20)
  628.             (ozone%base_addr)(1 + $I_L588_16, 13 + $I_L189_20, 4, 0) = t$492(1 + $I_L588_16, 1 + $I_L189_20)
  648.             (ozone%base_addr)(1 + $I_L588_16, 19 + $I_L189_20, 4, 0) = t$495(1 + $I_L588_16, 1 + $I_L189_20)
  668.             (ozone%base_addr)(1 + $I_L588_16, 25 + $I_L189_20, 4, 0) = t$498(1 + $I_L588_16, 1 + $I_L189_20)
  588.             $I_L588_16 = 1 + $I_L588_16
  588.             if ( $I_L588_16 >= 18 ) exit
  588.          enddo
  189.          $I_L189_20 = 1 + $I_L189_20
  189.          if ( $I_L189_20 >= 6 ) exit
  189.       enddo
  327.       $I_L327_10 = 0
  327. !dir$ ivdep
  327.       do
  327.          (ozone%base_addr)(1 + $I_L327_10, 37, 1, 0) = t$445(1 + $I_L327_10)
  713.          ozsig(1 + $I_L327_10) = t$503(1 + $I_L327_10)
  454.          (ozone%base_addr)(1 + $I_L327_10, 37, 2, 0) = t$464(1 + $I_L327_10)
  581.          (ozone%base_addr)(1 + $I_L327_10, 37, 3, 0) = t$483(1 + $I_L327_10)
  708.          (ozone%base_addr)(1 + $I_L327_10, 37, 4, 0) = t$502(1 + $I_L327_10)
  327.          $I_L327_10 = 1 + $I_L327_10
  327.          if ( $I_L327_10 >= 18 ) exit
  327.       enddo
  688.       $I_L688_22 = 0
  688.       do
  688.          $I_L688_18 = 0
  688. !dir$ ivdep
  688.          do
  688.             (ozone%base_addr)(1 + $I_L688_18, 31 + $I_L688_22, 4, 0) = t$501(1 + $I_L688_18, 1 + $I_L688_22)
  688.             $I_L688_18 = 1 + $I_L688_18
  688.             if ( $I_L688_18 >= 18 ) exit
  688.          enddo
  688.          $I_L688_22 = 1 + $I_L688_22
  688.          if ( $I_L688_22 >= 6 ) exit
  688.       enddo
  722.       mon_getoz = int( 8.3333333333333329e-2 * yrl )
  723.       year_getoz = yrl
  724.       if ( kmax /= 18 ) then
  725.          inter_getoz = .true.
  725.       else
  727.          inter_getoz = .false.
  728.          $I_L728_6 = 0
  728. !dir$ ivdep
  728.          do
  730.             if ( abs( ozsig(1 + $I_L728_6) + -sl(18 + -$I_L728_6) ) > 1.0e-4 ) then
  730.                inter_getoz = .true.
  730.             endif
  731.             $I_L728_6 = 1 + $I_L728_6
  730.             if ( $I_L728_6 >= 18 ) exit
  730.          enddo
  730.       endif
  733.       first_getoz = .false.
  735.       return
  735.       end
  735.       
 1318.       
 1318.       subroutine radiationdriver( first, ifday, lcnvl, lthncl, nfin0, nfin1, nfcnv0, intcosz, kt, mxrdcc, yrl, idatec, idate, tod, jdt, delt, trint, swint, colrad, lonrad, zenith, cos2d, sig, sigml, delsig, latco, ncols, kmax, nls, nlcs, imask, gps, gtt, gqq, tsurf, omg, tsea, convts, convcs, convbs, convc, convt, convb, albvisdiff, albnirdiff, albvisbeam, albnirbeam, rswtoadown, rvisdiff, rnirdiff, rvisbeam, rnirbeam, rvisdiffc, rnirdiffc, rvisbeamc, rnirbeamc, rswsfcnet, rswsfcnetc, yswtoadown, yvisdiff, ynirdiff, yvisbeam, ynirbeam, yvisdiffc, ynirdiffc, yvisbeamc, ynirbeamc, yswheatrate, yswheatratec, yswsfcnet, yswsfcnetc, xvisdiff, xnirdiff, xvisbeam, xnirbeam, lwcoolrate, lwsfcdown, lwsfcnet, lwtoaup, lwcoolratec, lwsfcdownc, lwsfcnetc, lwtoaupc, slrad, ssib_visbeam, ssib_visdiff, ssib_nirbeam, ssib_nirdiff, cldsav, cldcovtot, cldcovinv, cldcovsat, cldcovcon, cldcovsha, cldliqwatpath, emisd, taud, co2val, o3mix )
  738.       t$11 = ncols
  985.       t$47 = _zla( 0, ncols )
  738.       t$12 = kmax
  989.       t$48 = _zla( 0, kmax )
  738.       t$13 = ( 1 + kmax )
  990.       t$49 = _zla( 0, ( 1 + kmax ) )
  738.       t$50 = _zla( 0, ncols )
  738.       t$51 = _zla( 0, ncols ) * _zla( 0, kmax )
 1125.       t$54 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8
 1126.       t$55 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8
 1126.       t$57 = _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 1127.       t$58 = _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 1127.       t$60 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24
 1117.       t$61 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24
 1117.       t$63 = 8 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 24
 1118.       t$64 = 8 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 24
 1118.       t$66 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 16 * _zla( 0, ncols )
 1109.       t$67 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 16 * _zla( 0, ncols )
 1109.       t$69 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 24 * _zla( 0, ncols )
 1110.       t$70 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 24 * _zla( 0, ncols )
 1110.       t$72 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 32 * _zla( 0, ncols )
 1102.       t$73 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 32 * _zla( 0, ncols )
 1102.       t$75 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 40 * _zla( 0, ncols )
 1100.       t$76 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 40 * _zla( 0, ncols )
 1100.       t$78 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 48 * _zla( 0, ncols )
 1114.       t$79 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 48 * _zla( 0, ncols )
 1114.       t$81 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 56 * _zla( 0, ncols )
 1115.       t$82 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 56 * _zla( 0, ncols )
 1115.       t$84 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 64 * _zla( 0, ncols )
 1098.       t$85 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 64 * _zla( 0, ncols )
 1098.       t$87 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 72 * _zla( 0, ncols )
 1101.       t$88 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 72 * _zla( 0, ncols )
 1101.       t$90 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 80 * _zla( 0, ncols )
 1099.       t$91 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 80 * _zla( 0, ncols )
 1099.       t$93 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 88 * _zla( 0, ncols )
 1122.       t$94 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 88 * _zla( 0, ncols )
 1122.       t$96 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 96 * _zla( 0, ncols )
 1123.       t$97 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 96 * _zla( 0, ncols )
 1123.       t$99 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 104 * _zla( 0, ncols )
 1120.       t$100 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 104 * _zla( 0, ncols )
 1120.       t$102 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 112 * _zla( 0, ncols )
 1121.       t$103 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 112 * _zla( 0, ncols )
 1121.       t$105 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 120 * _zla( 0, ncols )
  738.       t$52 = int( _alloc( _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 120 * _zla( 0, ncols ) ), 8 )
 1125.       t$53 = t$52
 1126.       t$56 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8
 1127.       t$59 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 1117.       t$62 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24
 1118.       t$65 = t$52 + 8 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 24
 1109.       t$68 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 16 * _zla( 0, ncols )
 1110.       t$71 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 24 * _zla( 0, ncols )
 1102.       t$74 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 32 * _zla( 0, ncols )
 1100.       t$77 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 40 * _zla( 0, ncols )
 1114.       t$80 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 48 * _zla( 0, ncols )
 1115.       t$83 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 56 * _zla( 0, ncols )
 1098.       t$86 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 64 * _zla( 0, ncols )
 1101.       t$89 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 72 * _zla( 0, ncols )
 1099.       t$92 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 80 * _zla( 0, ncols )
 1122.       t$95 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 88 * _zla( 0, ncols )
 1123.       t$98 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 96 * _zla( 0, ncols )
 1120.       t$101 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 104 * _zla( 0, ncols )
 1121.       t$104 = t$52 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24 + 112 * _zla( 0, ncols )
 1144.       $ghl_local_S13 = isgridhistoryon
 1151.       t$508 = int( _alloc( 8 * _zla( 0, ncols ) ), 8 )
 1151.       $F_A33 = ncols
 1151.       if ( ncols > 0 ) then
 1151.          $I_L1151_46 = 0
 1151. !dir$ ivdep
 1151.          do
 1151.             t$507(1 + $I_L1151_46) = 1.0000000000000001e-1 * gps(1 + $I_L1151_46)
 1151.             $I_L1151_46 = 1 + $I_L1151_46
 1151.             if ( $I_L1151_46 >= $F_A33 ) exit
 1151.          enddo
 1151.       endif
 1151.       call rqvirt( ncols, kmax, sig(1), t$507(1), gtt(1, 1), gqq(1, 1), gtmp(1, 1), q(1, 1), relhum(1, 1) )
 1151.       _free( t$508 )
 1156.       inalb = 2
 1157.       if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) /= 'NON' ) then
  738.          goto 10
 1156.       else if (  _substr(ilwrad,1,_ltrim(  _substr(ilwrad,1,3) )) /= 'NON' ) then
 1156.    10    continue
 1159.          icld = 1
 1161.          $icld_S0 = cvmg( 1, 3,  _substr(iccon,1,_ltrim(  _substr(iccon,1,3) )) /= 'ARA' )
 1163.          $icld_S1 = cvmg( $icld_S0, int( crdcld ),  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) /= 'CRD' )
 1165.          if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) /= 'UKM' ) then
 1165.             icld = cvmg( $icld_S1, 4,  _substr(ilwrad,1,_ltrim(  _substr(ilwrad,1,3) )) /= 'UKM' )
 1165.          else
 1165.             icld = 4
 1165.          endif
 1167.          call spmrad( first, ifday, lcnvl, lthncl, nfin0, nfin1, nfcnv0, intcosz, mxrdcc, inalb, icld, yrl, idatec(1), idate(1), tod, delt, trint, swint, colrad(1), lonrad(1), zenith(1), cos2d(1), sig(1), sigml(1), delsig(1), latco, ncols, kmax, nls, nlcs, imask(1), gps(1), gtmp(1, 1), q(1, 1), tsurf(1), relhum(1, 1), omg(1, 1), tsea(1), convts(1), convcs(1), convbs(1), convc(1), convt(1), convb(1), albvisdiff(1), albnirdiff(1), albvisbeam(1), albnirbeam(1), rswtoadown(1), rvisdiff(1), rnirdiff(1), rvisbeam(1), rnirbeam(1), rvisdiffc(1), rnirdiffc(1), rvisbeamc(1), rnirbeamc(1), rswsfcnet(1), rswsfcnetc(1), rswtoanet(1), rswtoanetc(1), yswtoadown(1), yvisdiff(1), ynirdiff(1), yvisbeam(1), ynirbeam(1), yvisdiffc(1), ynirdiffc(1), yvisbeamc(1), ynirbeamc(1), yswheatrate(1, 1), yswheatratec(1, 1), yswsfcnet(1), yswsfcnetc(1), yswtoanet(1), yswtoanetc(1), ssib_visdiff(1), ssib_nirdiff(1), ssib_visbeam(1), ssib_nirbeam(1), lwcoolrate(1, 1), lwsfcdown(1), lwsfcnet(1), lwtoaup(1), lwcoolratec(1, 1), lwsfcdownc(1), lwsfcnetc(1), lwtoaupc(1), cldsav(1), cldcovtot(1, 1), cldcovinv(1, 1), cldcovsat(1, 1), cldcovcon(1, 1), cldcovsha(1, 1), cldliqwatpath(1, 1), emisd(1, 1), taud(1, 1), co2val, o3mix(1, 1) )
 1210.          $intstp_S7 = int( 1.0e-2 + ( 1.0/delt * swint * 3600.0 ) )
 1211.          $modstp_S2 = mod( -1 + jdt, int( 1.0e-2 + ( 1.0/delt * swint * 3600.0 ) ) )
 1212.          $fstp_S3 = ( real( $modstp_S2, 8 ) * 1.0/( real( int( 1.0e-2 + ( 1.0/delt * swint * 3600.0 ) ), 8 ) ) )
 1214.          if ( jdt <= 2 ) then
 1214.             $fstp_S3 = cvmg( $fstp_S3, 0.0, kt /= 0 )
 1214.          endif
 1216.          $fstp1_S5 = 1.0 + -$fstp_S3
 1218.          if ( ncols > 0 ) then
 1218.             $I_L1218_36 = 0
 1218. !dir$ ivdep
 1218.             do
 1219.                xvisdiff(1 + $I_L1218_36) = $fstp1_S5 * rvisdiff(1 + $I_L1218_36) + $fstp_S3 * yvisdiff(1 + $I_L1218_36)
 1220.                xvisbeam(1 + $I_L1218_36) = $fstp1_S5 * rvisbeam(1 + $I_L1218_36) + $fstp_S3 * yvisbeam(1 + $I_L1218_36)
 1221.                xnirdiff(1 + $I_L1218_36) = $fstp1_S5 * rnirdiff(1 + $I_L1218_36) + $fstp_S3 * ynirdiff(1 + $I_L1218_36)
 1222.                xnirbeam(1 + $I_L1218_36) = $fstp1_S5 * rnirbeam(1 + $I_L1218_36) + $fstp_S3 * ynirbeam(1 + $I_L1218_36)
 1223.                xvisdiffc(1 + $I_L1218_36) = $fstp1_S5 * rvisdiffc(1 + $I_L1218_36) + $fstp_S3 * yvisdiffc(1 + $I_L1218_36)
 1224.                xvisbeamc(1 + $I_L1218_36) = $fstp1_S5 * rvisbeamc(1 + $I_L1218_36) + $fstp_S3 * yvisbeamc(1 + $I_L1218_36)
 1225.                xnirdiffc(1 + $I_L1218_36) = $fstp1_S5 * rnirdiffc(1 + $I_L1218_36) + $fstp_S3 * ynirdiffc(1 + $I_L1218_36)
 1226.                xnirbeamc(1 + $I_L1218_36) = $fstp1_S5 * rnirbeamc(1 + $I_L1218_36) + $fstp_S3 * ynirbeamc(1 + $I_L1218_36)
 1227.                xswtoadown(1 + $I_L1218_36) = $fstp1_S5 * rswtoadown(1 + $I_L1218_36) + $fstp_S3 * yswtoadown(1 + $I_L1218_36)
 1228.                xswsfcnet(1 + $I_L1218_36) = $fstp1_S5 * rswsfcnet(1 + $I_L1218_36) + $fstp_S3 * yswsfcnet(1 + $I_L1218_36)
 1229.                xswsfcnetc(1 + $I_L1218_36) = $fstp1_S5 * rswsfcnetc(1 + $I_L1218_36) + $fstp_S3 * yswsfcnetc(1 + $I_L1218_36)
 1230.                $I_L1218_36 = 1 + $I_L1218_36
 1218.                if ( $I_L1218_36 >= ncols ) exit
 1218.             enddo
 1249.             $I_L1249_40 = 0
 1249. !dir$ ivdep
 1249.             do
 1250.                $slrad_WR0_R0 = lwsfcdown(1 + $I_L1249_40) + ( 1.0 + -albvisdiff(1 + $I_L1249_40) ) * xvisdiff(1 + $I_L1249_40) + ( 1.0 + -albvisbeam(1 + $I_L1249_40) ) * xvisbeam(1 + $I_L1249_40) + ( 1.0 + -albnirdiff(1 + $I_L1249_40) ) * xnirdiff(1 + $I_L1249_40) + ( 1.0 + -albnirbeam(1 + $I_L1249_40) ) * xnirbeam(1 + $I_L1249_40)
 1256.                $slrad_WR0_R0 = -1.4335299999999999e-3 * $slrad_WR0_R0
 1256.                slrad(1 + $I_L1249_40) = $slrad_WR0_R0
 1257.                $I_L1249_40 = 1 + $I_L1249_40
 1249.                if ( $I_L1249_40 >= ncols ) exit
 1249.             enddo
 1249.          endif
 1232.          if ( $intstp_S7 + -$modstp_S2 == 1 ) then
 1233.             if ( ncols > 0 ) then
 1233.                $I_L1233_38 = 0
 1233. !dir$ ivdep
 1233.                do
 1234.                   rvisdiff(1 + $I_L1233_38) = yvisdiff(1 + $I_L1233_38)
 1235.                   rvisbeam(1 + $I_L1233_38) = yvisbeam(1 + $I_L1233_38)
 1236.                   rnirdiff(1 + $I_L1233_38) = ynirdiff(1 + $I_L1233_38)
 1237.                   rnirbeam(1 + $I_L1233_38) = ynirbeam(1 + $I_L1233_38)
 1238.                   rvisdiffc(1 + $I_L1233_38) = yvisdiffc(1 + $I_L1233_38)
 1239.                   rvisbeamc(1 + $I_L1233_38) = yvisbeamc(1 + $I_L1233_38)
 1240.                   rnirdiffc(1 + $I_L1233_38) = ynirdiffc(1 + $I_L1233_38)
 1241.                   rnirbeamc(1 + $I_L1233_38) = ynirbeamc(1 + $I_L1233_38)
 1242.                   rswtoadown(1 + $I_L1233_38) = yswtoadown(1 + $I_L1233_38)
 1243.                   rswsfcnet(1 + $I_L1233_38) = yswsfcnet(1 + $I_L1233_38)
 1244.                   rswsfcnetc(1 + $I_L1233_38) = yswsfcnetc(1 + $I_L1233_38)
 1245.                   $I_L1233_38 = 1 + $I_L1233_38
 1233.                   if ( $I_L1233_38 >= ncols ) exit
 1233.                enddo
 1233.             endif
 1233.          endif
 1260.          $F_A34 = ncols
 1260.          if ( ncols > 0 ) then
 1260.             $I_L1260_48 = 0
 1260. !dir$ ivdep
 1260.             do
 1260.                yswatmabs(1 + $I_L1260_48) = 0.0
 1260.                $I_L1260_48 = 1 + $I_L1260_48
 1260.                if ( $I_L1260_48 >= $F_A34 ) exit
 1260.             enddo
 1260.          endif
 1261.          $F_A35 = ncols
 1261.          if ( ncols > 0 ) then
 1261.             $I_L1261_50 = 0
 1261. !dir$ ivdep
 1261.             do
 1261.                yswatmabsc(1 + $I_L1261_50) = 0.0
 1261.                $I_L1261_50 = 1 + $I_L1261_50
 1261.                if ( $I_L1261_50 >= $F_A35 ) exit
 1261.             enddo
 1261.          endif
 1262.          if ( kmax > 0 ) then
 1264.             if ( ncols > 0 ) then
 1262.                $I_L1262_52 = 0
 1262.                do
 1263.                   $rfac_S11 = 10251.020408163264 * delsig(1 + $I_L1262_52)
 1264.                   $I_L1264_42 = 0
 1264. !dir$ ivdep
 1264.                   do
 1265.                      yswatmabs(1 + $I_L1264_42) = yswatmabs(1 + $I_L1264_42) + $rfac_S11 * gps(1 + $I_L1264_42) * yswheatrate(1 + $I_L1264_42, 1 + $I_L1262_52)
 1266.                      yswatmabsc(1 + $I_L1264_42) = yswatmabsc(1 + $I_L1264_42) + $rfac_S11 * gps(1 + $I_L1264_42) * yswheatratec(1 + $I_L1264_42, 1 + $I_L1262_52)
 1267.                      $I_L1264_42 = 1 + $I_L1264_42
 1264.                      if ( $I_L1264_42 >= ncols ) exit
 1264.                   enddo
 1268.                   $I_L1262_52 = 1 + $I_L1262_52
 1267.                   if ( $I_L1262_52 >= kmax ) exit
 1267.                enddo
 1267.             endif
 1267.          endif
 1276.          if ( ncols > 0 ) then
 1276.             $I_L1276_44 = 0
 1276. !dir$ ivdep
 1276.             do
 1277.                swtoaup(1 + $I_L1276_44) = xswtoadown(1 + $I_L1276_44) + -( ( 1.0 + -albvisdiff(1 + $I_L1276_44) ) * xvisdiff(1 + $I_L1276_44) ) + -( ( 1.0 + -albvisbeam(1 + $I_L1276_44) ) * xvisbeam(1 + $I_L1276_44) ) + -( ( 1.0 + -albnirdiff(1 + $I_L1276_44) ) * xnirdiff(1 + $I_L1276_44) ) + -( ( 1.0 + -albnirbeam(1 + $I_L1276_44) ) * xnirbeam(1 + $I_L1276_44) ) + -yswatmabs(1 + $I_L1276_44)
 1284.                swtoaupc(1 + $I_L1276_44) = xswtoadown(1 + $I_L1276_44) + -( ( 1.0 + -albvisdiff(1 + $I_L1276_44) ) * xvisdiffc(1 + $I_L1276_44) ) + -( ( 1.0 + -albvisbeam(1 + $I_L1276_44) ) * xvisbeamc(1 + $I_L1276_44) ) + -( ( 1.0 + -albnirdiff(1 + $I_L1276_44) ) * xnirdiffc(1 + $I_L1276_44) ) + -( ( 1.0 + -albnirbeam(1 + $I_L1276_44) ) * xnirbeamc(1 + $I_L1276_44) ) + -yswatmabsc(1 + $I_L1276_44)
 1291.                $I_L1276_44 = 1 + $I_L1276_44
 1276.                if ( $I_L1276_44 >= ncols ) exit
 1276.             enddo
 1276.          endif
 1295.          if ( startstordiag ) then
 1296.             call raddiagstor( ncols, kmax, latco, cldcovtot(1, 1), cldcovinv(1, 1), cldcovsat(1, 1), cldcovcon(1, 1), cldcovsha(1, 1), cldliqwatpath(1, 1), taud(1, 1), emisd(1, 1), lwcoolrate(1, 1), yswheatrate(1, 1), yswheatratec(1, 1), lwcoolratec(1, 1), cldsav(1), o3mix(1, 1), xswtoadown(1), swtoaup(1), swtoaupc(1), lwsfcdown(1), lwtoaup(1), lwsfcdownc(1), lwtoaupc(1), lwsfcnet(1), lwsfcnetc(1), xvisdiff(1), xvisbeam(1), xnirdiff(1), xnirbeam(1), xvisdiffc(1), xvisbeamc(1), xnirdiffc(1), xnirbeamc(1), albvisdiff(1), albvisbeam(1), albnirdiff(1), albnirbeam(1), delsig(1), gps(1), xswsfcnet(1), xswsfcnetc(1) )
 1296.          endif
 1311.          if ( $ghl_local_S13 ) then
 1312.             call radgridhiststorage( ncols, kmax, latco, cldcovtot(1, 1), lwcoolrate(1, 1), yswheatrate(1, 1), lwtoaup(1), lwsfcdown(1), zenith(1), xswtoadown(1), xvisbeam(1), xvisdiff(1), xnirbeam(1), xnirdiff(1), albvisbeam(1), albvisdiff(1), albnirbeam(1), albnirdiff(1), cldsav(1), swtoaup(1) )
 1312.          endif
 1312.       endif
  738.       _free( t$52 )
 1318.       return
 1318.       end
 1318.       
 1365.       
 1365.       subroutine radgridhiststorage( ncols, kmax, latco, cldcovtot, lwcoolrate, yswheatrate, lwtoaup, lwsfcdown, zenith, xswtoadown, xvisbeam, xvisdiff, xnirbeam, xnirdiff, albvisbeam, albvisdiff, albnirbeam, albnirdiff, cldsav, swtoaup )
 1322.       t$14 = ncols
 1322.       t$15 = kmax
 1329.       t$106 = _zla( 0, ncols )
 1322.       t$107 = _zla( 0, ncols )
 1329.       t$108 = _zla( 0, kmax )
 1322.       t$109 = _zla( 0, ncols ) * _zla( 0, kmax )
 1347.       if ( (dogrh%base_addr)(75, latco, 0) ) then
 1347. !dir$ suppress cldcovtot(1, 1)
 1347.          t$527%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( cldcovtot(1, 1) ) )
 1347.          t$527%header%el_len = 64
 1347.          t$527%header%assoc = 1
 1347.          t$527%header%ptr_alloc = 0
 1347.          t$527%header%p_or_a = 0
 1347.          t$527%header%a_contig = 1
 1347.          t$527%header%dv_versn = 2
 1347.          t$527%header%dv_smunit = 64
 1347.          t$527%header%d_type = 0
 1347.          t$527%header%n_params = 0
 1347.          t$527%header%pad_codim = 0
 1347.          t$527%header%n_codim = 0
 1347.          t$527%header%pad_dim = 0
 1347.          t$527%header%n_dim = 2
 1347.          t$527%header%d_type_idx = 13
 1347.          t$527%header%typ_code = 134481411
 1347.          t$527%header%orig_base = 0
 1347.          t$527%header%orig_size = 0
 1347.          t$527%dim_1%LB = 1
 1347.          t$527%dim_1%EX = _zla( 0, ncols )
 1347.          t$527%dim_1%SM = 1
 1347.          t$527%dim_2%LB = 1
 1347.          t$527%dim_2%EX = _zla( 0, kmax )
 1347.          t$527%dim_2%SM = _zla( 0, ncols )
 1347.          ipa$503 = 75
 1347.          call store2d( t$527, ipa$503, latco, 0 )
 1347.       endif
 1348.       if ( (dogrh%base_addr)(63, latco, 0) ) then
 1348. !dir$ suppress lwcoolrate(1, 1)
 1348.          t$528%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( lwcoolrate(1, 1) ) )
 1348.          t$528%header%el_len = 64
 1348.          t$528%header%assoc = 1
 1348.          t$528%header%ptr_alloc = 0
 1348.          t$528%header%p_or_a = 0
 1348.          t$528%header%a_contig = 1
 1348.          t$528%header%dv_versn = 2
 1348.          t$528%header%dv_smunit = 64
 1348.          t$528%header%d_type = 0
 1348.          t$528%header%n_params = 0
 1348.          t$528%header%pad_codim = 0
 1348.          t$528%header%n_codim = 0
 1348.          t$528%header%pad_dim = 0
 1348.          t$528%header%n_dim = 2
 1348.          t$528%header%d_type_idx = 13
 1348.          t$528%header%typ_code = 134481411
 1348.          t$528%header%orig_base = 0
 1348.          t$528%header%orig_size = 0
 1348.          t$528%dim_1%LB = 1
 1348.          t$528%dim_1%EX = _zla( 0, ncols )
 1348.          t$528%dim_1%SM = 1
 1348.          t$528%dim_2%LB = 1
 1348.          t$528%dim_2%EX = _zla( 0, kmax )
 1348.          t$528%dim_2%SM = _zla( 0, ncols )
 1348.          ipa$504 = 63
 1348.          call store2d( t$528, ipa$504, latco, 0 )
 1348.       endif
 1349.       if ( (dogrh%base_addr)(62, latco, 0) ) then
 1349. !dir$ suppress yswheatrate(1, 1)
 1349.          t$529%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( yswheatrate(1, 1) ) )
 1349.          t$529%header%el_len = 64
 1349.          t$529%header%assoc = 1
 1349.          t$529%header%ptr_alloc = 0
 1349.          t$529%header%p_or_a = 0
 1349.          t$529%header%a_contig = 1
 1349.          t$529%header%dv_versn = 2
 1349.          t$529%header%dv_smunit = 64
 1349.          t$529%header%d_type = 0
 1349.          t$529%header%n_params = 0
 1349.          t$529%header%pad_codim = 0
 1349.          t$529%header%n_codim = 0
 1349.          t$529%header%pad_dim = 0
 1349.          t$529%header%n_dim = 2
 1349.          t$529%header%d_type_idx = 13
 1349.          t$529%header%typ_code = 134481411
 1349.          t$529%header%orig_base = 0
 1349.          t$529%header%orig_size = 0
 1349.          t$529%dim_1%LB = 1
 1349.          t$529%dim_1%EX = _zla( 0, ncols )
 1349.          t$529%dim_1%SM = 1
 1349.          t$529%dim_2%LB = 1
 1349.          t$529%dim_2%EX = _zla( 0, kmax )
 1349.          t$529%dim_2%SM = _zla( 0, ncols )
 1349.          ipa$505 = 62
 1349.          call store2d( t$529, ipa$505, latco, 0 )
 1349.       endif
 1350.       if ( (dogrh%base_addr)(20, latco, 0) ) then
 1350. !dir$ suppress lwtoaup(1)
 1350.          t$530%base_addr = pointer to array[1] of real (kind=8)( loc( lwtoaup(1) ) )
 1350.          t$530%header%el_len = 64
 1350.          t$530%header%assoc = 1
 1350.          t$530%header%ptr_alloc = 0
 1350.          t$530%header%p_or_a = 0
 1350.          t$530%header%a_contig = 1
 1350.          t$530%header%dv_versn = 2
 1350.          t$530%header%dv_smunit = 64
 1350.          t$530%header%d_type = 0
 1350.          t$530%header%n_params = 0
 1350.          t$530%header%pad_codim = 0
 1350.          t$530%header%n_codim = 0
 1350.          t$530%header%pad_dim = 0
 1350.          t$530%header%n_dim = 1
 1350.          t$530%header%d_type_idx = 13
 1350.          t$530%header%typ_code = 134481411
 1350.          t$530%header%orig_base = 0
 1350.          t$530%header%orig_size = 0
 1350.          t$530%dim_1%LB = 1
 1350.          t$530%dim_1%EX = _zla( 0, ncols )
 1350.          t$530%dim_1%SM = 1
 1350.          ipa$506 = 20
 1350.          call store1d( t$530, ipa$506, latco, 0 )
 1350.       endif
 1351.       if ( (dogrh%base_addr)(21, latco, 0) ) then
 1351. !dir$ suppress lwsfcdown(1)
 1351.          t$531%base_addr = pointer to array[1] of real (kind=8)( loc( lwsfcdown(1) ) )
 1351.          t$531%header%el_len = 64
 1351.          t$531%header%assoc = 1
 1351.          t$531%header%ptr_alloc = 0
 1351.          t$531%header%p_or_a = 0
 1351.          t$531%header%a_contig = 1
 1351.          t$531%header%dv_versn = 2
 1351.          t$531%header%dv_smunit = 64
 1351.          t$531%header%d_type = 0
 1351.          t$531%header%n_params = 0
 1351.          t$531%header%pad_codim = 0
 1351.          t$531%header%n_codim = 0
 1351.          t$531%header%pad_dim = 0
 1351.          t$531%header%n_dim = 1
 1351.          t$531%header%d_type_idx = 13
 1351.          t$531%header%typ_code = 134481411
 1351.          t$531%header%orig_base = 0
 1351.          t$531%header%orig_size = 0
 1351.          t$531%dim_1%LB = 1
 1351.          t$531%dim_1%EX = _zla( 0, ncols )
 1351.          t$531%dim_1%SM = 1
 1351.          ipa$508 = 21
 1351.          call store1d( t$531, ipa$508, latco, 0 )
 1351.       endif
 1352.       if ( (dogrh%base_addr)(35, latco, 0) ) then
 1352. !dir$ suppress zenith(1)
 1352.          t$532%base_addr = pointer to array[1] of real (kind=8)( loc( zenith(1) ) )
 1352.          t$532%header%el_len = 64
 1352.          t$532%header%assoc = 1
 1352.          t$532%header%ptr_alloc = 0
 1352.          t$532%header%p_or_a = 0
 1352.          t$532%header%a_contig = 1
 1352.          t$532%header%dv_versn = 2
 1352.          t$532%header%dv_smunit = 64
 1352.          t$532%header%d_type = 0
 1352.          t$532%header%n_params = 0
 1352.          t$532%header%pad_codim = 0
 1352.          t$532%header%n_codim = 0
 1352.          t$532%header%pad_dim = 0
 1352.          t$532%header%n_dim = 1
 1352.          t$532%header%d_type_idx = 13
 1352.          t$532%header%typ_code = 134481411
 1352.          t$532%header%orig_base = 0
 1352.          t$532%header%orig_size = 0
 1352.          t$532%dim_1%LB = 1
 1352.          t$532%dim_1%EX = _zla( 0, ncols )
 1352.          t$532%dim_1%SM = 1
 1352.          ipa$510 = 35
 1352.          call store1d( t$532, ipa$510, latco, 0 )
 1352.       endif
 1353.       if ( (dogrh%base_addr)(19, latco, 0) ) then
 1353. !dir$ suppress xswtoadown(1)
 1353.          t$533%base_addr = pointer to array[1] of real (kind=8)( loc( xswtoadown(1) ) )
 1353.          t$533%header%el_len = 64
 1353.          t$533%header%assoc = 1
 1353.          t$533%header%ptr_alloc = 0
 1353.          t$533%header%p_or_a = 0
 1353.          t$533%header%a_contig = 1
 1353.          t$533%header%dv_versn = 2
 1353.          t$533%header%dv_smunit = 64
 1353.          t$533%header%d_type = 0
 1353.          t$533%header%n_params = 0
 1353.          t$533%header%pad_codim = 0
 1353.          t$533%header%n_codim = 0
 1353.          t$533%header%pad_dim = 0
 1353.          t$533%header%n_dim = 1
 1353.          t$533%header%d_type_idx = 13
 1353.          t$533%header%typ_code = 134481411
 1353.          t$533%header%orig_base = 0
 1353.          t$533%header%orig_size = 0
 1353.          t$533%dim_1%LB = 1
 1353.          t$533%dim_1%EX = _zla( 0, ncols )
 1353.          t$533%dim_1%SM = 1
 1353.          ipa$512 = 19
 1353.          call store1d( t$533, ipa$512, latco, 0 )
 1353.       endif
 1354.       if ( (dogrh%base_addr)(24, latco, 0) ) then
 1354. !dir$ suppress xvisbeam(1)
 1354.          t$534%base_addr = pointer to array[1] of real (kind=8)( loc( xvisbeam(1) ) )
 1354.          t$534%header%el_len = 64
 1354.          t$534%header%assoc = 1
 1354.          t$534%header%ptr_alloc = 0
 1354.          t$534%header%p_or_a = 0
 1354.          t$534%header%a_contig = 1
 1354.          t$534%header%dv_versn = 2
 1354.          t$534%header%dv_smunit = 64
 1354.          t$534%header%d_type = 0
 1354.          t$534%header%n_params = 0
 1354.          t$534%header%pad_codim = 0
 1354.          t$534%header%n_codim = 0
 1354.          t$534%header%pad_dim = 0
 1354.          t$534%header%n_dim = 1
 1354.          t$534%header%d_type_idx = 13
 1354.          t$534%header%typ_code = 134481411
 1354.          t$534%header%orig_base = 0
 1354.          t$534%header%orig_size = 0
 1354.          t$534%dim_1%LB = 1
 1354.          t$534%dim_1%EX = _zla( 0, ncols )
 1354.          t$534%dim_1%SM = 1
 1354.          ipa$514 = 24
 1354.          call store1d( t$534, ipa$514, latco, 0 )
 1354.       endif
 1355.       if ( (dogrh%base_addr)(25, latco, 0) ) then
 1355. !dir$ suppress xvisdiff(1)
 1355.          t$535%base_addr = pointer to array[1] of real (kind=8)( loc( xvisdiff(1) ) )
 1355.          t$535%header%el_len = 64
 1355.          t$535%header%assoc = 1
 1355.          t$535%header%ptr_alloc = 0
 1355.          t$535%header%p_or_a = 0
 1355.          t$535%header%a_contig = 1
 1355.          t$535%header%dv_versn = 2
 1355.          t$535%header%dv_smunit = 64
 1355.          t$535%header%d_type = 0
 1355.          t$535%header%n_params = 0
 1355.          t$535%header%pad_codim = 0
 1355.          t$535%header%n_codim = 0
 1355.          t$535%header%pad_dim = 0
 1355.          t$535%header%n_dim = 1
 1355.          t$535%header%d_type_idx = 13
 1355.          t$535%header%typ_code = 134481411
 1355.          t$535%header%orig_base = 0
 1355.          t$535%header%orig_size = 0
 1355.          t$535%dim_1%LB = 1
 1355.          t$535%dim_1%EX = _zla( 0, ncols )
 1355.          t$535%dim_1%SM = 1
 1355.          ipa$516 = 25
 1355.          call store1d( t$535, ipa$516, latco, 0 )
 1355.       endif
 1356.       if ( (dogrh%base_addr)(26, latco, 0) ) then
 1356. !dir$ suppress xnirbeam(1)
 1356.          t$536%base_addr = pointer to array[1] of real (kind=8)( loc( xnirbeam(1) ) )
 1356.          t$536%header%el_len = 64
 1356.          t$536%header%assoc = 1
 1356.          t$536%header%ptr_alloc = 0
 1356.          t$536%header%p_or_a = 0
 1356.          t$536%header%a_contig = 1
 1356.          t$536%header%dv_versn = 2
 1356.          t$536%header%dv_smunit = 64
 1356.          t$536%header%d_type = 0
 1356.          t$536%header%n_params = 0
 1356.          t$536%header%pad_codim = 0
 1356.          t$536%header%n_codim = 0
 1356.          t$536%header%pad_dim = 0
 1356.          t$536%header%n_dim = 1
 1356.          t$536%header%d_type_idx = 13
 1356.          t$536%header%typ_code = 134481411
 1356.          t$536%header%orig_base = 0
 1356.          t$536%header%orig_size = 0
 1356.          t$536%dim_1%LB = 1
 1356.          t$536%dim_1%EX = _zla( 0, ncols )
 1356.          t$536%dim_1%SM = 1
 1356.          ipa$518 = 26
 1356.          call store1d( t$536, ipa$518, latco, 0 )
 1356.       endif
 1357.       if ( (dogrh%base_addr)(27, latco, 0) ) then
 1357. !dir$ suppress xnirdiff(1)
 1357.          t$537%base_addr = pointer to array[1] of real (kind=8)( loc( xnirdiff(1) ) )
 1357.          t$537%header%el_len = 64
 1357.          t$537%header%assoc = 1
 1357.          t$537%header%ptr_alloc = 0
 1357.          t$537%header%p_or_a = 0
 1357.          t$537%header%a_contig = 1
 1357.          t$537%header%dv_versn = 2
 1357.          t$537%header%dv_smunit = 64
 1357.          t$537%header%d_type = 0
 1357.          t$537%header%n_params = 0
 1357.          t$537%header%pad_codim = 0
 1357.          t$537%header%n_codim = 0
 1357.          t$537%header%pad_dim = 0
 1357.          t$537%header%n_dim = 1
 1357.          t$537%header%d_type_idx = 13
 1357.          t$537%header%typ_code = 134481411
 1357.          t$537%header%orig_base = 0
 1357.          t$537%header%orig_size = 0
 1357.          t$537%dim_1%LB = 1
 1357.          t$537%dim_1%EX = _zla( 0, ncols )
 1357.          t$537%dim_1%SM = 1
 1357.          ipa$520 = 27
 1357.          call store1d( t$537, ipa$520, latco, 0 )
 1357.       endif
 1358.       if ( (dogrh%base_addr)(28, latco, 0) ) then
 1358. !dir$ suppress albvisbeam(1)
 1358.          t$538%base_addr = pointer to array[1] of real (kind=8)( loc( albvisbeam(1) ) )
 1358.          t$538%header%el_len = 64
 1358.          t$538%header%assoc = 1
 1358.          t$538%header%ptr_alloc = 0
 1358.          t$538%header%p_or_a = 0
 1358.          t$538%header%a_contig = 1
 1358.          t$538%header%dv_versn = 2
 1358.          t$538%header%dv_smunit = 64
 1358.          t$538%header%d_type = 0
 1358.          t$538%header%n_params = 0
 1358.          t$538%header%pad_codim = 0
 1358.          t$538%header%n_codim = 0
 1358.          t$538%header%pad_dim = 0
 1358.          t$538%header%n_dim = 1
 1358.          t$538%header%d_type_idx = 13
 1358.          t$538%header%typ_code = 134481411
 1358.          t$538%header%orig_base = 0
 1358.          t$538%header%orig_size = 0
 1358.          t$538%dim_1%LB = 1
 1358.          t$538%dim_1%EX = _zla( 0, ncols )
 1358.          t$538%dim_1%SM = 1
 1358.          ipa$522 = 28
 1358.          call store1d( t$538, ipa$522, latco, 0 )
 1358.       endif
 1359.       if ( (dogrh%base_addr)(29, latco, 0) ) then
 1359. !dir$ suppress albvisdiff(1)
 1359.          t$539%base_addr = pointer to array[1] of real (kind=8)( loc( albvisdiff(1) ) )
 1359.          t$539%header%el_len = 64
 1359.          t$539%header%assoc = 1
 1359.          t$539%header%ptr_alloc = 0
 1359.          t$539%header%p_or_a = 0
 1359.          t$539%header%a_contig = 1
 1359.          t$539%header%dv_versn = 2
 1359.          t$539%header%dv_smunit = 64
 1359.          t$539%header%d_type = 0
 1359.          t$539%header%n_params = 0
 1359.          t$539%header%pad_codim = 0
 1359.          t$539%header%n_codim = 0
 1359.          t$539%header%pad_dim = 0
 1359.          t$539%header%n_dim = 1
 1359.          t$539%header%d_type_idx = 13
 1359.          t$539%header%typ_code = 134481411
 1359.          t$539%header%orig_base = 0
 1359.          t$539%header%orig_size = 0
 1359.          t$539%dim_1%LB = 1
 1359.          t$539%dim_1%EX = _zla( 0, ncols )
 1359.          t$539%dim_1%SM = 1
 1359.          ipa$524 = 29
 1359.          call store1d( t$539, ipa$524, latco, 0 )
 1359.       endif
 1360.       if ( (dogrh%base_addr)(30, latco, 0) ) then
 1360. !dir$ suppress albnirbeam(1)
 1360.          t$540%base_addr = pointer to array[1] of real (kind=8)( loc( albnirbeam(1) ) )
 1360.          t$540%header%el_len = 64
 1360.          t$540%header%assoc = 1
 1360.          t$540%header%ptr_alloc = 0
 1360.          t$540%header%p_or_a = 0
 1360.          t$540%header%a_contig = 1
 1360.          t$540%header%dv_versn = 2
 1360.          t$540%header%dv_smunit = 64
 1360.          t$540%header%d_type = 0
 1360.          t$540%header%n_params = 0
 1360.          t$540%header%pad_codim = 0
 1360.          t$540%header%n_codim = 0
 1360.          t$540%header%pad_dim = 0
 1360.          t$540%header%n_dim = 1
 1360.          t$540%header%d_type_idx = 13
 1360.          t$540%header%typ_code = 134481411
 1360.          t$540%header%orig_base = 0
 1360.          t$540%header%orig_size = 0
 1360.          t$540%dim_1%LB = 1
 1360.          t$540%dim_1%EX = _zla( 0, ncols )
 1360.          t$540%dim_1%SM = 1
 1360.          ipa$526 = 30
 1360.          call store1d( t$540, ipa$526, latco, 0 )
 1360.       endif
 1361.       if ( (dogrh%base_addr)(31, latco, 0) ) then
 1361. !dir$ suppress albnirdiff(1)
 1361.          t$541%base_addr = pointer to array[1] of real (kind=8)( loc( albnirdiff(1) ) )
 1361.          t$541%header%el_len = 64
 1361.          t$541%header%assoc = 1
 1361.          t$541%header%ptr_alloc = 0
 1361.          t$541%header%p_or_a = 0
 1361.          t$541%header%a_contig = 1
 1361.          t$541%header%dv_versn = 2
 1361.          t$541%header%dv_smunit = 64
 1361.          t$541%header%d_type = 0
 1361.          t$541%header%n_params = 0
 1361.          t$541%header%pad_codim = 0
 1361.          t$541%header%n_codim = 0
 1361.          t$541%header%pad_dim = 0
 1361.          t$541%header%n_dim = 1
 1361.          t$541%header%d_type_idx = 13
 1361.          t$541%header%typ_code = 134481411
 1361.          t$541%header%orig_base = 0
 1361.          t$541%header%orig_size = 0
 1361.          t$541%dim_1%LB = 1
 1361.          t$541%dim_1%EX = _zla( 0, ncols )
 1361.          t$541%dim_1%SM = 1
 1361.          ipa$528 = 31
 1361.          call store1d( t$541, ipa$528, latco, 0 )
 1361.       endif
 1362.       if ( (dogrh%base_addr)(74, latco, 0) ) then
 1362. !dir$ suppress cldsav(1)
 1362.          t$542%base_addr = pointer to array[1] of real (kind=8)( loc( cldsav(1) ) )
 1362.          t$542%header%el_len = 64
 1362.          t$542%header%assoc = 1
 1362.          t$542%header%ptr_alloc = 0
 1362.          t$542%header%p_or_a = 0
 1362.          t$542%header%a_contig = 1
 1362.          t$542%header%dv_versn = 2
 1362.          t$542%header%dv_smunit = 64
 1362.          t$542%header%d_type = 0
 1362.          t$542%header%n_params = 0
 1362.          t$542%header%pad_codim = 0
 1362.          t$542%header%n_codim = 0
 1362.          t$542%header%pad_dim = 0
 1362.          t$542%header%n_dim = 1
 1362.          t$542%header%d_type_idx = 13
 1362.          t$542%header%typ_code = 134481411
 1362.          t$542%header%orig_base = 0
 1362.          t$542%header%orig_size = 0
 1362.          t$542%dim_1%LB = 1
 1362.          t$542%dim_1%EX = _zla( 0, ncols )
 1362.          t$542%dim_1%SM = 1
 1362.          ipa$530 = 74
 1362.          call store1d( t$542, ipa$530, latco, 0 )
 1362.       endif
 1363.       if ( (dogrh%base_addr)(23, latco, 0) ) then
 1363. !dir$ suppress swtoaup(1)
 1363.          t$543%base_addr = pointer to array[1] of real (kind=8)( loc( swtoaup(1) ) )
 1363.          t$543%header%el_len = 64
 1363.          t$543%header%assoc = 1
 1363.          t$543%header%ptr_alloc = 0
 1363.          t$543%header%p_or_a = 0
 1363.          t$543%header%a_contig = 1
 1363.          t$543%header%dv_versn = 2
 1363.          t$543%header%dv_smunit = 64
 1363.          t$543%header%d_type = 0
 1363.          t$543%header%n_params = 0
 1363.          t$543%header%pad_codim = 0
 1363.          t$543%header%n_codim = 0
 1363.          t$543%header%pad_dim = 0
 1363.          t$543%header%n_dim = 1
 1363.          t$543%header%d_type_idx = 13
 1363.          t$543%header%typ_code = 134481411
 1363.          t$543%header%orig_base = 0
 1363.          t$543%header%orig_size = 0
 1363.          t$543%dim_1%LB = 1
 1363.          t$543%dim_1%EX = _zla( 0, ncols )
 1363.          t$543%dim_1%SM = 1
 1363.          ipa$532 = 23
 1363.          call store1d( t$543, ipa$532, latco, 0 )
 1363.       endif
 1365.       return
 1365.       end
 1365.       
 1586.       
 1586.       subroutine raddiagstor( ncols, kmax, latco, cldcovtot, cldcovinv, cldcovsat, cldcovcon, cldcovsha, cldliqwatpath, taud, emisd, lwcoolrate, yswheatrate, yswheatratec, lwcoolratec, cldsav, o3mix, xswtoadown, swtoaup, swtoaupc, lwsfcdown, lwtoaup, lwsfcdownc, lwtoaupc, lwsfcnet, lwsfcnetc, xvisdiff, xvisbeam, xnirdiff, xnirbeam, xvisdiffc, xvisbeamc, xnirdiffc, xnirbeamc, albvisdiff, albvisbeam, albnirdiff, albnirbeam, delsig, gps, swsfcnet, swsfcnetc )
 1369.       t$16 = ncols
 1369.       t$17 = kmax
 1384.       t$110 = _zla( 0, ncols )
 1369.       t$111 = _zla( 0, ncols )
 1384.       t$112 = _zla( 0, kmax )
 1369.       t$113 = _zla( 0, ncols ) * _zla( 0, kmax )
 1438.       t$116 = 8 * _zla( 0, ncols )
 1369.       t$114 = int( _alloc( 8 * _zla( 0, ncols ) ), 8 )
 1438.       t$115 = t$114
 1443.       if ( (dodia%base_addr)(71, 0) ) then
 1443. !dir$ suppress o3mix(1, 1)
 1443.          t$544%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( o3mix(1, 1) ) )
 1443.          t$544%header%el_len = 64
 1443.          t$544%header%assoc = 1
 1443.          t$544%header%ptr_alloc = 0
 1443.          t$544%header%p_or_a = 0
 1443.          t$544%header%a_contig = 1
 1443.          t$544%header%dv_versn = 2
 1443.          t$544%header%dv_smunit = 64
 1443.          t$544%header%d_type = 0
 1443.          t$544%header%n_params = 0
 1443.          t$544%header%pad_codim = 0
 1443.          t$544%header%n_codim = 0
 1443.          t$544%header%pad_dim = 0
 1443.          t$544%header%n_dim = 2
 1443.          t$544%header%d_type_idx = 13
 1443.          t$544%header%typ_code = 134481411
 1443.          t$544%header%orig_base = 0
 1443.          t$544%header%orig_size = 0
 1443.          t$544%dim_1%LB = 1
 1443.          t$544%dim_1%EX = _zla( 0, ncols )
 1443.          t$544%dim_1%SM = 1
 1443.          t$544%dim_2%LB = 1
 1443.          t$544%dim_2%EX = _zla( 0, kmax )
 1443.          t$544%dim_2%SM = _zla( 0, ncols )
 1443.          ipa$534 = 71
 1443.          call updia2d( t$544, ipa$534, latco )
 1443.       endif
 1446.       if ( (dodia%base_addr)(103, 0) ) then
 1447.          $F_A33 = ncols
 1447.          if ( ncols > 0 ) then
 1447.             $I_A1 = 0
 1447. !dir$ ivdep
 1447.             do
 1447.                bfr1(1 + $I_A1) = 0.0
 1447.                $I_A1 = 1 + $I_A1
 1447.                if ( $I_A1 >= $F_A33 ) exit
 1447.             enddo
 1447.          endif
 1448.          if ( kmax > 0 ) then
 1450.             if ( ncols > 0 ) then
 1448.                $I_L1448_58 = 0
 1448.                do
 1449.                   $rfac2_S2 = 476697.64693877549 * delsig(1 + $I_L1448_58)
 1450.                   $I_L1450_40 = 0
 1450. !dir$ ivdep
 1450.                   do
 1451.                      bfr1(1 + $I_L1450_40) = bfr1(1 + $I_L1450_40) + $rfac2_S2 * gps(1 + $I_L1450_40) * o3mix(1 + $I_L1450_40, 1 + $I_L1448_58)
 1452.                      $I_L1450_40 = 1 + $I_L1450_40
 1450.                      if ( $I_L1450_40 >= ncols ) exit
 1450.                   enddo
 1453.                   $I_L1448_58 = 1 + $I_L1448_58
 1452.                   if ( $I_L1448_58 >= kmax ) exit
 1452.                enddo
 1452.             endif
 1452.          endif
 1454. !dir$ suppress bfr1(1)
 1454.          t$551%base_addr = pointer to array[1] of real (kind=8)( loc( bfr1(1) ) )
 1454.          t$551%header%el_len = 64
 1454.          t$551%header%assoc = 1
 1454.          t$551%header%ptr_alloc = 0
 1454.          t$551%header%p_or_a = 0
 1454.          t$551%header%a_contig = 1
 1454.          t$551%header%dv_versn = 2
 1454.          t$551%header%dv_smunit = 64
 1454.          t$551%header%d_type = 0
 1454.          t$551%header%n_params = 0
 1454.          t$551%header%pad_codim = 0
 1454.          t$551%header%n_codim = 0
 1454.          t$551%header%pad_dim = 0
 1454.          t$551%header%n_dim = 1
 1454.          t$551%header%d_type_idx = 13
 1454.          t$551%header%typ_code = 134481411
 1454.          t$551%header%orig_base = 0
 1454.          t$551%header%orig_size = 0
 1454.          t$551%dim_1%LB = 1
 1454.          t$551%dim_1%EX = _zla( 0, ncols )
 1454.          t$551%dim_1%SM = 1
 1454.          ipa$535 = 103
 1454.          call updia1d( t$551, ipa$535, latco )
 1454.       endif
 1459.       if ( (dodia%base_addr)(72, 0) ) then
 1459. !dir$ suppress cldcovtot(1, 1)
 1459.          t$552%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( cldcovtot(1, 1) ) )
 1459.          t$552%header%el_len = 64
 1459.          t$552%header%assoc = 1
 1459.          t$552%header%ptr_alloc = 0
 1459.          t$552%header%p_or_a = 0
 1459.          t$552%header%a_contig = 1
 1459.          t$552%header%dv_versn = 2
 1459.          t$552%header%dv_smunit = 64
 1459.          t$552%header%d_type = 0
 1459.          t$552%header%n_params = 0
 1459.          t$552%header%pad_codim = 0
 1459.          t$552%header%n_codim = 0
 1459.          t$552%header%pad_dim = 0
 1459.          t$552%header%n_dim = 2
 1459.          t$552%header%d_type_idx = 13
 1459.          t$552%header%typ_code = 134481411
 1459.          t$552%header%orig_base = 0
 1459.          t$552%header%orig_size = 0
 1459.          t$552%dim_1%LB = 1
 1459.          t$552%dim_1%EX = _zla( 0, ncols )
 1459.          t$552%dim_1%SM = 1
 1459.          t$552%dim_2%LB = 1
 1459.          t$552%dim_2%EX = _zla( 0, kmax )
 1459.          t$552%dim_2%SM = _zla( 0, ncols )
 1459.          ipa$537 = 72
 1459.          call updia2d( t$552, ipa$537, latco )
 1459.       endif
 1461.       if ( (dodia%base_addr)(73, 0) ) then
 1461. !dir$ suppress cldcovinv(1, 1)
 1461.          t$553%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( cldcovinv(1, 1) ) )
 1461.          t$553%header%el_len = 64
 1461.          t$553%header%assoc = 1
 1461.          t$553%header%ptr_alloc = 0
 1461.          t$553%header%p_or_a = 0
 1461.          t$553%header%a_contig = 1
 1461.          t$553%header%dv_versn = 2
 1461.          t$553%header%dv_smunit = 64
 1461.          t$553%header%d_type = 0
 1461.          t$553%header%n_params = 0
 1461.          t$553%header%pad_codim = 0
 1461.          t$553%header%n_codim = 0
 1461.          t$553%header%pad_dim = 0
 1461.          t$553%header%n_dim = 2
 1461.          t$553%header%d_type_idx = 13
 1461.          t$553%header%typ_code = 134481411
 1461.          t$553%header%orig_base = 0
 1461.          t$553%header%orig_size = 0
 1461.          t$553%dim_1%LB = 1
 1461.          t$553%dim_1%EX = _zla( 0, ncols )
 1461.          t$553%dim_1%SM = 1
 1461.          t$553%dim_2%LB = 1
 1461.          t$553%dim_2%EX = _zla( 0, kmax )
 1461.          t$553%dim_2%SM = _zla( 0, ncols )
 1461.          ipa$538 = 73
 1461.          call updia2d( t$553, ipa$538, latco )
 1461.       endif
 1463.       if ( (dodia%base_addr)(74, 0) ) then
 1463. !dir$ suppress cldcovsat(1, 1)
 1463.          t$554%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( cldcovsat(1, 1) ) )
 1463.          t$554%header%el_len = 64
 1463.          t$554%header%assoc = 1
 1463.          t$554%header%ptr_alloc = 0
 1463.          t$554%header%p_or_a = 0
 1463.          t$554%header%a_contig = 1
 1463.          t$554%header%dv_versn = 2
 1463.          t$554%header%dv_smunit = 64
 1463.          t$554%header%d_type = 0
 1463.          t$554%header%n_params = 0
 1463.          t$554%header%pad_codim = 0
 1463.          t$554%header%n_codim = 0
 1463.          t$554%header%pad_dim = 0
 1463.          t$554%header%n_dim = 2
 1463.          t$554%header%d_type_idx = 13
 1463.          t$554%header%typ_code = 134481411
 1463.          t$554%header%orig_base = 0
 1463.          t$554%header%orig_size = 0
 1463.          t$554%dim_1%LB = 1
 1463.          t$554%dim_1%EX = _zla( 0, ncols )
 1463.          t$554%dim_1%SM = 1
 1463.          t$554%dim_2%LB = 1
 1463.          t$554%dim_2%EX = _zla( 0, kmax )
 1463.          t$554%dim_2%SM = _zla( 0, ncols )
 1463.          ipa$539 = 74
 1463.          call updia2d( t$554, ipa$539, latco )
 1463.       endif
 1465.       if ( (dodia%base_addr)(75, 0) ) then
 1465. !dir$ suppress cldcovcon(1, 1)
 1465.          t$555%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( cldcovcon(1, 1) ) )
 1465.          t$555%header%el_len = 64
 1465.          t$555%header%assoc = 1
 1465.          t$555%header%ptr_alloc = 0
 1465.          t$555%header%p_or_a = 0
 1465.          t$555%header%a_contig = 1
 1465.          t$555%header%dv_versn = 2
 1465.          t$555%header%dv_smunit = 64
 1465.          t$555%header%d_type = 0
 1465.          t$555%header%n_params = 0
 1465.          t$555%header%pad_codim = 0
 1465.          t$555%header%n_codim = 0
 1465.          t$555%header%pad_dim = 0
 1465.          t$555%header%n_dim = 2
 1465.          t$555%header%d_type_idx = 13
 1465.          t$555%header%typ_code = 134481411
 1465.          t$555%header%orig_base = 0
 1465.          t$555%header%orig_size = 0
 1465.          t$555%dim_1%LB = 1
 1465.          t$555%dim_1%EX = _zla( 0, ncols )
 1465.          t$555%dim_1%SM = 1
 1465.          t$555%dim_2%LB = 1
 1465.          t$555%dim_2%EX = _zla( 0, kmax )
 1465.          t$555%dim_2%SM = _zla( 0, ncols )
 1465.          ipa$540 = 75
 1465.          call updia2d( t$555, ipa$540, latco )
 1465.       endif
 1467.       if ( (dodia%base_addr)(76, 0) ) then
 1467. !dir$ suppress cldcovsha(1, 1)
 1467.          t$556%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( cldcovsha(1, 1) ) )
 1467.          t$556%header%el_len = 64
 1467.          t$556%header%assoc = 1
 1467.          t$556%header%ptr_alloc = 0
 1467.          t$556%header%p_or_a = 0
 1467.          t$556%header%a_contig = 1
 1467.          t$556%header%dv_versn = 2
 1467.          t$556%header%dv_smunit = 64
 1467.          t$556%header%d_type = 0
 1467.          t$556%header%n_params = 0
 1467.          t$556%header%pad_codim = 0
 1467.          t$556%header%n_codim = 0
 1467.          t$556%header%pad_dim = 0
 1467.          t$556%header%n_dim = 2
 1467.          t$556%header%d_type_idx = 13
 1467.          t$556%header%typ_code = 134481411
 1467.          t$556%header%orig_base = 0
 1467.          t$556%header%orig_size = 0
 1467.          t$556%dim_1%LB = 1
 1467.          t$556%dim_1%EX = _zla( 0, ncols )
 1467.          t$556%dim_1%SM = 1
 1467.          t$556%dim_2%LB = 1
 1467.          t$556%dim_2%EX = _zla( 0, kmax )
 1467.          t$556%dim_2%SM = _zla( 0, ncols )
 1467.          ipa$541 = 76
 1467.          call updia2d( t$556, ipa$541, latco )
 1467.       endif
 1469.       if ( (dodia%base_addr)(77, 0) ) then
 1469. !dir$ suppress cldliqwatpath(1, 1)
 1469.          t$557%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( cldliqwatpath(1, 1) ) )
 1469.          t$557%header%el_len = 64
 1469.          t$557%header%assoc = 1
 1469.          t$557%header%ptr_alloc = 0
 1469.          t$557%header%p_or_a = 0
 1469.          t$557%header%a_contig = 1
 1469.          t$557%header%dv_versn = 2
 1469.          t$557%header%dv_smunit = 64
 1469.          t$557%header%d_type = 0
 1469.          t$557%header%n_params = 0
 1469.          t$557%header%pad_codim = 0
 1469.          t$557%header%n_codim = 0
 1469.          t$557%header%pad_dim = 0
 1469.          t$557%header%n_dim = 2
 1469.          t$557%header%d_type_idx = 13
 1469.          t$557%header%typ_code = 134481411
 1469.          t$557%header%orig_base = 0
 1469.          t$557%header%orig_size = 0
 1469.          t$557%dim_1%LB = 1
 1469.          t$557%dim_1%EX = _zla( 0, ncols )
 1469.          t$557%dim_1%SM = 1
 1469.          t$557%dim_2%LB = 1
 1469.          t$557%dim_2%EX = _zla( 0, kmax )
 1469.          t$557%dim_2%SM = _zla( 0, ncols )
 1469.          ipa$542 = 77
 1469.          call updia2d( t$557, ipa$542, latco )
 1469.       endif
 1471.       if ( (dodia%base_addr)(79, 0) ) then
 1471. !dir$ suppress taud(1, 1)
 1471.          t$558%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( taud(1, 1) ) )
 1471.          t$558%header%el_len = 64
 1471.          t$558%header%assoc = 1
 1471.          t$558%header%ptr_alloc = 0
 1471.          t$558%header%p_or_a = 0
 1471.          t$558%header%a_contig = 1
 1471.          t$558%header%dv_versn = 2
 1471.          t$558%header%dv_smunit = 64
 1471.          t$558%header%d_type = 0
 1471.          t$558%header%n_params = 0
 1471.          t$558%header%pad_codim = 0
 1471.          t$558%header%n_codim = 0
 1471.          t$558%header%pad_dim = 0
 1471.          t$558%header%n_dim = 2
 1471.          t$558%header%d_type_idx = 13
 1471.          t$558%header%typ_code = 134481411
 1471.          t$558%header%orig_base = 0
 1471.          t$558%header%orig_size = 0
 1471.          t$558%dim_1%LB = 1
 1471.          t$558%dim_1%EX = _zla( 0, ncols )
 1471.          t$558%dim_1%SM = 1
 1471.          t$558%dim_2%LB = 1
 1471.          t$558%dim_2%EX = _zla( 0, kmax )
 1471.          t$558%dim_2%SM = _zla( 0, ncols )
 1471.          ipa$543 = 79
 1471.          call updia2d( t$558, ipa$543, latco )
 1471.       endif
 1473.       if ( (dodia%base_addr)(78, 0) ) then
 1473. !dir$ suppress emisd(1, 1)
 1473.          t$559%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( emisd(1, 1) ) )
 1473.          t$559%header%el_len = 64
 1473.          t$559%header%assoc = 1
 1473.          t$559%header%ptr_alloc = 0
 1473.          t$559%header%p_or_a = 0
 1473.          t$559%header%a_contig = 1
 1473.          t$559%header%dv_versn = 2
 1473.          t$559%header%dv_smunit = 64
 1473.          t$559%header%d_type = 0
 1473.          t$559%header%n_params = 0
 1473.          t$559%header%pad_codim = 0
 1473.          t$559%header%n_codim = 0
 1473.          t$559%header%pad_dim = 0
 1473.          t$559%header%n_dim = 2
 1473.          t$559%header%d_type_idx = 13
 1473.          t$559%header%typ_code = 134481411
 1473.          t$559%header%orig_base = 0
 1473.          t$559%header%orig_size = 0
 1473.          t$559%dim_1%LB = 1
 1473.          t$559%dim_1%EX = _zla( 0, ncols )
 1473.          t$559%dim_1%SM = 1
 1473.          t$559%dim_2%LB = 1
 1473.          t$559%dim_2%EX = _zla( 0, kmax )
 1473.          t$559%dim_2%SM = _zla( 0, ncols )
 1473.          ipa$544 = 78
 1473.          call updia2d( t$559, ipa$544, latco )
 1473.       endif
 1475.       if ( (dodia%base_addr)(20, 0) ) then
 1475. !dir$ suppress cldsav(1)
 1475.          t$560%base_addr = pointer to array[1] of real (kind=8)( loc( cldsav(1) ) )
 1475.          t$560%header%el_len = 64
 1475.          t$560%header%assoc = 1
 1475.          t$560%header%ptr_alloc = 0
 1475.          t$560%header%p_or_a = 0
 1475.          t$560%header%a_contig = 1
 1475.          t$560%header%dv_versn = 2
 1475.          t$560%header%dv_smunit = 64
 1475.          t$560%header%d_type = 0
 1475.          t$560%header%n_params = 0
 1475.          t$560%header%pad_codim = 0
 1475.          t$560%header%n_codim = 0
 1475.          t$560%header%pad_dim = 0
 1475.          t$560%header%n_dim = 1
 1475.          t$560%header%d_type_idx = 13
 1475.          t$560%header%typ_code = 134481411
 1475.          t$560%header%orig_base = 0
 1475.          t$560%header%orig_size = 0
 1475.          t$560%dim_1%LB = 1
 1475.          t$560%dim_1%EX = _zla( 0, ncols )
 1475.          t$560%dim_1%SM = 1
 1475.          ipa$545 = 20
 1475.          call updia1d( t$560, ipa$545, latco )
 1475.       endif
 1479.       if ( (dodia%base_addr)(31, 0) ) then
 1479. !dir$ suppress lwcoolrate(1, 1)
 1479.          t$561%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( lwcoolrate(1, 1) ) )
 1479.          t$561%header%el_len = 64
 1479.          t$561%header%assoc = 1
 1479.          t$561%header%ptr_alloc = 0
 1479.          t$561%header%p_or_a = 0
 1479.          t$561%header%a_contig = 1
 1479.          t$561%header%dv_versn = 2
 1479.          t$561%header%dv_smunit = 64
 1479.          t$561%header%d_type = 0
 1479.          t$561%header%n_params = 0
 1479.          t$561%header%pad_codim = 0
 1479.          t$561%header%n_codim = 0
 1479.          t$561%header%pad_dim = 0
 1479.          t$561%header%n_dim = 2
 1479.          t$561%header%d_type_idx = 13
 1479.          t$561%header%typ_code = 134481411
 1479.          t$561%header%orig_base = 0
 1479.          t$561%header%orig_size = 0
 1479.          t$561%dim_1%LB = 1
 1479.          t$561%dim_1%EX = _zla( 0, ncols )
 1479.          t$561%dim_1%SM = 1
 1479.          t$561%dim_2%LB = 1
 1479.          t$561%dim_2%EX = _zla( 0, kmax )
 1479.          t$561%dim_2%SM = _zla( 0, ncols )
 1479.          ipa$547 = 31
 1479.          call updia2d( t$561, ipa$547, latco )
 1479.       endif
 1481.       if ( (dodia%base_addr)(95, 0) ) then
 1481. !dir$ suppress lwcoolratec(1, 1)
 1481.          t$562%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( lwcoolratec(1, 1) ) )
 1481.          t$562%header%el_len = 64
 1481.          t$562%header%assoc = 1
 1481.          t$562%header%ptr_alloc = 0
 1481.          t$562%header%p_or_a = 0
 1481.          t$562%header%a_contig = 1
 1481.          t$562%header%dv_versn = 2
 1481.          t$562%header%dv_smunit = 64
 1481.          t$562%header%d_type = 0
 1481.          t$562%header%n_params = 0
 1481.          t$562%header%pad_codim = 0
 1481.          t$562%header%n_codim = 0
 1481.          t$562%header%pad_dim = 0
 1481.          t$562%header%n_dim = 2
 1481.          t$562%header%d_type_idx = 13
 1481.          t$562%header%typ_code = 134481411
 1481.          t$562%header%orig_base = 0
 1481.          t$562%header%orig_size = 0
 1481.          t$562%dim_1%LB = 1
 1481.          t$562%dim_1%EX = _zla( 0, ncols )
 1481.          t$562%dim_1%SM = 1
 1481.          t$562%dim_2%LB = 1
 1481.          t$562%dim_2%EX = _zla( 0, kmax )
 1481.          t$562%dim_2%SM = _zla( 0, ncols )
 1481.          ipa$548 = 95
 1481.          call updia2d( t$562, ipa$548, latco )
 1481.       endif
 1485.       if ( (dodia%base_addr)(30, 0) ) then
 1485. !dir$ suppress lwsfcnet(1)
 1485.          t$563%base_addr = pointer to array[1] of real (kind=8)( loc( lwsfcnet(1) ) )
 1485.          t$563%header%el_len = 64
 1485.          t$563%header%assoc = 1
 1485.          t$563%header%ptr_alloc = 0
 1485.          t$563%header%p_or_a = 0
 1485.          t$563%header%a_contig = 1
 1485.          t$563%header%dv_versn = 2
 1485.          t$563%header%dv_smunit = 64
 1485.          t$563%header%d_type = 0
 1485.          t$563%header%n_params = 0
 1485.          t$563%header%pad_codim = 0
 1485.          t$563%header%n_codim = 0
 1485.          t$563%header%pad_dim = 0
 1485.          t$563%header%n_dim = 1
 1485.          t$563%header%d_type_idx = 13
 1485.          t$563%header%typ_code = 134481411
 1485.          t$563%header%orig_base = 0
 1485.          t$563%header%orig_size = 0
 1485.          t$563%dim_1%LB = 1
 1485.          t$563%dim_1%EX = _zla( 0, ncols )
 1485.          t$563%dim_1%SM = 1
 1485.          ipa$549 = 30
 1485.          call updia1d( t$563, ipa$549, latco )
 1485.       endif
 1487.       if ( (dodia%base_addr)(63, 0) ) then
 1487. !dir$ suppress lwsfcnetc(1)
 1487.          t$564%base_addr = pointer to array[1] of real (kind=8)( loc( lwsfcnetc(1) ) )
 1487.          t$564%header%el_len = 64
 1487.          t$564%header%assoc = 1
 1487.          t$564%header%ptr_alloc = 0
 1487.          t$564%header%p_or_a = 0
 1487.          t$564%header%a_contig = 1
 1487.          t$564%header%dv_versn = 2
 1487.          t$564%header%dv_smunit = 64
 1487.          t$564%header%d_type = 0
 1487.          t$564%header%n_params = 0
 1487.          t$564%header%pad_codim = 0
 1487.          t$564%header%n_codim = 0
 1487.          t$564%header%pad_dim = 0
 1487.          t$564%header%n_dim = 1
 1487.          t$564%header%d_type_idx = 13
 1487.          t$564%header%typ_code = 134481411
 1487.          t$564%header%orig_base = 0
 1487.          t$564%header%orig_size = 0
 1487.          t$564%dim_1%LB = 1
 1487.          t$564%dim_1%EX = _zla( 0, ncols )
 1487.          t$564%dim_1%SM = 1
 1487.          ipa$551 = 63
 1487.          call updia1d( t$564, ipa$551, latco )
 1487.       endif
 1491.       if ( (dodia%base_addr)(21, 0) ) then
 1491. !dir$ suppress lwsfcdown(1)
 1491.          t$565%base_addr = pointer to array[1] of real (kind=8)( loc( lwsfcdown(1) ) )
 1491.          t$565%header%el_len = 64
 1491.          t$565%header%assoc = 1
 1491.          t$565%header%ptr_alloc = 0
 1491.          t$565%header%p_or_a = 0
 1491.          t$565%header%a_contig = 1
 1491.          t$565%header%dv_versn = 2
 1491.          t$565%header%dv_smunit = 64
 1491.          t$565%header%d_type = 0
 1491.          t$565%header%n_params = 0
 1491.          t$565%header%pad_codim = 0
 1491.          t$565%header%n_codim = 0
 1491.          t$565%header%pad_dim = 0
 1491.          t$565%header%n_dim = 1
 1491.          t$565%header%d_type_idx = 13
 1491.          t$565%header%typ_code = 134481411
 1491.          t$565%header%orig_base = 0
 1491.          t$565%header%orig_size = 0
 1491.          t$565%dim_1%LB = 1
 1491.          t$565%dim_1%EX = _zla( 0, ncols )
 1491.          t$565%dim_1%SM = 1
 1491.          ipa$553 = 21
 1491.          call updia1d( t$565, ipa$553, latco )
 1491.       endif
 1493.       if ( (dodia%base_addr)(56, 0) ) then
 1493. !dir$ suppress lwsfcdownc(1)
 1493.          t$566%base_addr = pointer to array[1] of real (kind=8)( loc( lwsfcdownc(1) ) )
 1493.          t$566%header%el_len = 64
 1493.          t$566%header%assoc = 1
 1493.          t$566%header%ptr_alloc = 0
 1493.          t$566%header%p_or_a = 0
 1493.          t$566%header%a_contig = 1
 1493.          t$566%header%dv_versn = 2
 1493.          t$566%header%dv_smunit = 64
 1493.          t$566%header%d_type = 0
 1493.          t$566%header%n_params = 0
 1493.          t$566%header%pad_codim = 0
 1493.          t$566%header%n_codim = 0
 1493.          t$566%header%pad_dim = 0
 1493.          t$566%header%n_dim = 1
 1493.          t$566%header%d_type_idx = 13
 1493.          t$566%header%typ_code = 134481411
 1493.          t$566%header%orig_base = 0
 1493.          t$566%header%orig_size = 0
 1493.          t$566%dim_1%LB = 1
 1493.          t$566%dim_1%EX = _zla( 0, ncols )
 1493.          t$566%dim_1%SM = 1
 1493.          ipa$555 = 56
 1493.          call updia1d( t$566, ipa$555, latco )
 1493.       endif
 1495.       if ( (dodia%base_addr)(23, 0) ) then
 1495. !dir$ suppress lwtoaup(1)
 1495.          t$567%base_addr = pointer to array[1] of real (kind=8)( loc( lwtoaup(1) ) )
 1495.          t$567%header%el_len = 64
 1495.          t$567%header%assoc = 1
 1495.          t$567%header%ptr_alloc = 0
 1495.          t$567%header%p_or_a = 0
 1495.          t$567%header%a_contig = 1
 1495.          t$567%header%dv_versn = 2
 1495.          t$567%header%dv_smunit = 64
 1495.          t$567%header%d_type = 0
 1495.          t$567%header%n_params = 0
 1495.          t$567%header%pad_codim = 0
 1495.          t$567%header%n_codim = 0
 1495.          t$567%header%pad_dim = 0
 1495.          t$567%header%n_dim = 1
 1495.          t$567%header%d_type_idx = 13
 1495.          t$567%header%typ_code = 134481411
 1495.          t$567%header%orig_base = 0
 1495.          t$567%header%orig_size = 0
 1495.          t$567%dim_1%LB = 1
 1495.          t$567%dim_1%EX = _zla( 0, ncols )
 1495.          t$567%dim_1%SM = 1
 1495.          ipa$557 = 23
 1495.          call updia1d( t$567, ipa$557, latco )
 1495.       endif
 1497.       if ( (dodia%base_addr)(57, 0) ) then
 1497. !dir$ suppress lwtoaupc(1)
 1497.          t$568%base_addr = pointer to array[1] of real (kind=8)( loc( lwtoaupc(1) ) )
 1497.          t$568%header%el_len = 64
 1497.          t$568%header%assoc = 1
 1497.          t$568%header%ptr_alloc = 0
 1497.          t$568%header%p_or_a = 0
 1497.          t$568%header%a_contig = 1
 1497.          t$568%header%dv_versn = 2
 1497.          t$568%header%dv_smunit = 64
 1497.          t$568%header%d_type = 0
 1497.          t$568%header%n_params = 0
 1497.          t$568%header%pad_codim = 0
 1497.          t$568%header%n_codim = 0
 1497.          t$568%header%pad_dim = 0
 1497.          t$568%header%n_dim = 1
 1497.          t$568%header%d_type_idx = 13
 1497.          t$568%header%typ_code = 134481411
 1497.          t$568%header%orig_base = 0
 1497.          t$568%header%orig_size = 0
 1497.          t$568%dim_1%LB = 1
 1497.          t$568%dim_1%EX = _zla( 0, ncols )
 1497.          t$568%dim_1%SM = 1
 1497.          ipa$559 = 57
 1497.          call updia1d( t$568, ipa$559, latco )
 1497.       endif
 1501.       if ( (dodia%base_addr)(32, 0) ) then
 1501. !dir$ suppress yswheatrate(1, 1)
 1501.          t$569%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( yswheatrate(1, 1) ) )
 1501.          t$569%header%el_len = 64
 1501.          t$569%header%assoc = 1
 1501.          t$569%header%ptr_alloc = 0
 1501.          t$569%header%p_or_a = 0
 1501.          t$569%header%a_contig = 1
 1501.          t$569%header%dv_versn = 2
 1501.          t$569%header%dv_smunit = 64
 1501.          t$569%header%d_type = 0
 1501.          t$569%header%n_params = 0
 1501.          t$569%header%pad_codim = 0
 1501.          t$569%header%n_codim = 0
 1501.          t$569%header%pad_dim = 0
 1501.          t$569%header%n_dim = 2
 1501.          t$569%header%d_type_idx = 13
 1501.          t$569%header%typ_code = 134481411
 1501.          t$569%header%orig_base = 0
 1501.          t$569%header%orig_size = 0
 1501.          t$569%dim_1%LB = 1
 1501.          t$569%dim_1%EX = _zla( 0, ncols )
 1501.          t$569%dim_1%SM = 1
 1501.          t$569%dim_2%LB = 1
 1501.          t$569%dim_2%EX = _zla( 0, kmax )
 1501.          t$569%dim_2%SM = _zla( 0, ncols )
 1501.          ipa$561 = 32
 1501.          call updia2d( t$569, ipa$561, latco )
 1501.       endif
 1503.       if ( (dodia%base_addr)(96, 0) ) then
 1503. !dir$ suppress yswheatratec(1, 1)
 1503.          t$570%base_addr = pointer to array[1] of array[1] of real (kind=8)( loc( yswheatratec(1, 1) ) )
 1503.          t$570%header%el_len = 64
 1503.          t$570%header%assoc = 1
 1503.          t$570%header%ptr_alloc = 0
 1503.          t$570%header%p_or_a = 0
 1503.          t$570%header%a_contig = 1
 1503.          t$570%header%dv_versn = 2
 1503.          t$570%header%dv_smunit = 64
 1503.          t$570%header%d_type = 0
 1503.          t$570%header%n_params = 0
 1503.          t$570%header%pad_codim = 0
 1503.          t$570%header%n_codim = 0
 1503.          t$570%header%pad_dim = 0
 1503.          t$570%header%n_dim = 2
 1503.          t$570%header%d_type_idx = 13
 1503.          t$570%header%typ_code = 134481411
 1503.          t$570%header%orig_base = 0
 1503.          t$570%header%orig_size = 0
 1503.          t$570%dim_1%LB = 1
 1503.          t$570%dim_1%EX = _zla( 0, ncols )
 1503.          t$570%dim_1%SM = 1
 1503.          t$570%dim_2%LB = 1
 1503.          t$570%dim_2%EX = _zla( 0, kmax )
 1503.          t$570%dim_2%SM = _zla( 0, ncols )
 1503.          ipa$562 = 96
 1503.          call updia2d( t$570, ipa$562, latco )
 1503.       endif
 1508.       if ( (dodia%base_addr)(25, 0) ) then
 1509.          if ( ncols > 0 ) then
 1509.             $I_L1509_42 = 0
 1509. !dir$ ivdep
 1509.             do
 1510.                bfr1(1 + $I_L1509_42) = xvisdiff(1 + $I_L1509_42) + xvisbeam(1 + $I_L1509_42) + xnirdiff(1 + $I_L1509_42) + xnirbeam(1 + $I_L1509_42)
 1511.                $I_L1509_42 = 1 + $I_L1509_42
 1509.                if ( $I_L1509_42 >= ncols ) exit
 1509.             enddo
 1509.          endif
 1512. !dir$ suppress bfr1(1)
 1512.          t$574%base_addr = pointer to array[1] of real (kind=8)( loc( bfr1(1) ) )
 1512.          t$574%header%el_len = 64
 1512.          t$574%header%assoc = 1
 1512.          t$574%header%ptr_alloc = 0
 1512.          t$574%header%p_or_a = 0
 1512.          t$574%header%a_contig = 1
 1512.          t$574%header%dv_versn = 2
 1512.          t$574%header%dv_smunit = 64
 1512.          t$574%header%d_type = 0
 1512.          t$574%header%n_params = 0
 1512.          t$574%header%pad_codim = 0
 1512.          t$574%header%n_codim = 0
 1512.          t$574%header%pad_dim = 0
 1512.          t$574%header%n_dim = 1
 1512.          t$574%header%d_type_idx = 13
 1512.          t$574%header%typ_code = 134481411
 1512.          t$574%header%orig_base = 0
 1512.          t$574%header%orig_size = 0
 1512.          t$574%dim_1%LB = 1
 1512.          t$574%dim_1%EX = _zla( 0, ncols )
 1512.          t$574%dim_1%SM = 1
 1512.          ipa$563 = 25
 1512.          call updia1d( t$574, ipa$563, latco )
 1512.       endif
 1516.       if ( (dodia%base_addr)(58, 0) ) then
 1517.          if ( ncols > 0 ) then
 1517.             $I_L1517_44 = 0
 1517. !dir$ ivdep
 1517.             do
 1518.                bfr1(1 + $I_L1517_44) = xvisdiffc(1 + $I_L1517_44) + xvisbeamc(1 + $I_L1517_44) + xnirdiffc(1 + $I_L1517_44) + xnirbeamc(1 + $I_L1517_44)
 1519.                $I_L1517_44 = 1 + $I_L1517_44
 1517.                if ( $I_L1517_44 >= ncols ) exit
 1517.             enddo
 1517.          endif
 1520. !dir$ suppress bfr1(1)
 1520.          t$578%base_addr = pointer to array[1] of real (kind=8)( loc( bfr1(1) ) )
 1520.          t$578%header%el_len = 64
 1520.          t$578%header%assoc = 1
 1520.          t$578%header%ptr_alloc = 0
 1520.          t$578%header%p_or_a = 0
 1520.          t$578%header%a_contig = 1
 1520.          t$578%header%dv_versn = 2
 1520.          t$578%header%dv_smunit = 64
 1520.          t$578%header%d_type = 0
 1520.          t$578%header%n_params = 0
 1520.          t$578%header%pad_codim = 0
 1520.          t$578%header%n_codim = 0
 1520.          t$578%header%pad_dim = 0
 1520.          t$578%header%n_dim = 1
 1520.          t$578%header%d_type_idx = 13
 1520.          t$578%header%typ_code = 134481411
 1520.          t$578%header%orig_base = 0
 1520.          t$578%header%orig_size = 0
 1520.          t$578%dim_1%LB = 1
 1520.          t$578%dim_1%EX = _zla( 0, ncols )
 1520.          t$578%dim_1%SM = 1
 1520.          ipa$565 = 58
 1520.          call updia1d( t$578, ipa$565, latco )
 1520.       endif
 1524.       if ( (dodia%base_addr)(26, 0) ) then
 1525.          if ( ncols > 0 ) then
 1525.             $I_L1525_46 = 0
 1525. !dir$ ivdep
 1525.             do
 1526.                bfr1(1 + $I_L1525_46) = albvisdiff(1 + $I_L1525_46) * xvisdiff(1 + $I_L1525_46) + albvisbeam(1 + $I_L1525_46) * xvisbeam(1 + $I_L1525_46) + albnirdiff(1 + $I_L1525_46) * xnirdiff(1 + $I_L1525_46) + albnirbeam(1 + $I_L1525_46) * xnirbeam(1 + $I_L1525_46)
 1528.                $I_L1525_46 = 1 + $I_L1525_46
 1525.                if ( $I_L1525_46 >= ncols ) exit
 1525.             enddo
 1525.          endif
 1529. !dir$ suppress bfr1(1)
 1529.          t$582%base_addr = pointer to array[1] of real (kind=8)( loc( bfr1(1) ) )
 1529.          t$582%header%el_len = 64
 1529.          t$582%header%assoc = 1
 1529.          t$582%header%ptr_alloc = 0
 1529.          t$582%header%p_or_a = 0
 1529.          t$582%header%a_contig = 1
 1529.          t$582%header%dv_versn = 2
 1529.          t$582%header%dv_smunit = 64
 1529.          t$582%header%d_type = 0
 1529.          t$582%header%n_params = 0
 1529.          t$582%header%pad_codim = 0
 1529.          t$582%header%n_codim = 0
 1529.          t$582%header%pad_dim = 0
 1529.          t$582%header%n_dim = 1
 1529.          t$582%header%d_type_idx = 13
 1529.          t$582%header%typ_code = 134481411
 1529.          t$582%header%orig_base = 0
 1529.          t$582%header%orig_size = 0
 1529.          t$582%dim_1%LB = 1
 1529.          t$582%dim_1%EX = _zla( 0, ncols )
 1529.          t$582%dim_1%SM = 1
 1529.          ipa$567 = 26
 1529.          call updia1d( t$582, ipa$567, latco )
 1529.       endif
 1533.       if ( (dodia%base_addr)(59, 0) ) then
 1534.          if ( ncols > 0 ) then
 1534.             $I_L1534_48 = 0
 1534. !dir$ ivdep
 1534.             do
 1535.                bfr1(1 + $I_L1534_48) = albvisdiff(1 + $I_L1534_48) * xvisdiffc(1 + $I_L1534_48) + albvisbeam(1 + $I_L1534_48) * xvisbeamc(1 + $I_L1534_48) + albnirdiff(1 + $I_L1534_48) * xnirdiffc(1 + $I_L1534_48) + albnirbeam(1 + $I_L1534_48) * xnirbeamc(1 + $I_L1534_48)
 1537.                $I_L1534_48 = 1 + $I_L1534_48
 1534.                if ( $I_L1534_48 >= ncols ) exit
 1534.             enddo
 1534.          endif
 1538. !dir$ suppress bfr1(1)
 1538.          t$586%base_addr = pointer to array[1] of real (kind=8)( loc( bfr1(1) ) )
 1538.          t$586%header%el_len = 64
 1538.          t$586%header%assoc = 1
 1538.          t$586%header%ptr_alloc = 0
 1538.          t$586%header%p_or_a = 0
 1538.          t$586%header%a_contig = 1
 1538.          t$586%header%dv_versn = 2
 1538.          t$586%header%dv_smunit = 64
 1538.          t$586%header%d_type = 0
 1538.          t$586%header%n_params = 0
 1538.          t$586%header%pad_codim = 0
 1538.          t$586%header%n_codim = 0
 1538.          t$586%header%pad_dim = 0
 1538.          t$586%header%n_dim = 1
 1538.          t$586%header%d_type_idx = 13
 1538.          t$586%header%typ_code = 134481411
 1538.          t$586%header%orig_base = 0
 1538.          t$586%header%orig_size = 0
 1538.          t$586%dim_1%LB = 1
 1538.          t$586%dim_1%EX = _zla( 0, ncols )
 1538.          t$586%dim_1%SM = 1
 1538.          ipa$569 = 59
 1538.          call updia1d( t$586, ipa$569, latco )
 1538.       endif
 1541.       if ( (dodia%base_addr)(27, 0) ) then
 1541. !dir$ suppress swtoaup(1)
 1541.          t$587%base_addr = pointer to array[1] of real (kind=8)( loc( swtoaup(1) ) )
 1541.          t$587%header%el_len = 64
 1541.          t$587%header%assoc = 1
 1541.          t$587%header%ptr_alloc = 0
 1541.          t$587%header%p_or_a = 0
 1541.          t$587%header%a_contig = 1
 1541.          t$587%header%dv_versn = 2
 1541.          t$587%header%dv_smunit = 64
 1541.          t$587%header%d_type = 0
 1541.          t$587%header%n_params = 0
 1541.          t$587%header%pad_codim = 0
 1541.          t$587%header%n_codim = 0
 1541.          t$587%header%pad_dim = 0
 1541.          t$587%header%n_dim = 1
 1541.          t$587%header%d_type_idx = 13
 1541.          t$587%header%typ_code = 134481411
 1541.          t$587%header%orig_base = 0
 1541.          t$587%header%orig_size = 0
 1541.          t$587%dim_1%LB = 1
 1541.          t$587%dim_1%EX = _zla( 0, ncols )
 1541.          t$587%dim_1%SM = 1
 1541.          ipa$571 = 27
 1541.          call updia1d( t$587, ipa$571, latco )
 1541.       endif
 1543.       if ( (dodia%base_addr)(60, 0) ) then
 1543. !dir$ suppress swtoaupc(1)
 1543.          t$588%base_addr = pointer to array[1] of real (kind=8)( loc( swtoaupc(1) ) )
 1543.          t$588%header%el_len = 64
 1543.          t$588%header%assoc = 1
 1543.          t$588%header%ptr_alloc = 0
 1543.          t$588%header%p_or_a = 0
 1543.          t$588%header%a_contig = 1
 1543.          t$588%header%dv_versn = 2
 1543.          t$588%header%dv_smunit = 64
 1543.          t$588%header%d_type = 0
 1543.          t$588%header%n_params = 0
 1543.          t$588%header%pad_codim = 0
 1543.          t$588%header%n_codim = 0
 1543.          t$588%header%pad_dim = 0
 1543.          t$588%header%n_dim = 1
 1543.          t$588%header%d_type_idx = 13
 1543.          t$588%header%typ_code = 134481411
 1543.          t$588%header%orig_base = 0
 1543.          t$588%header%orig_size = 0
 1543.          t$588%dim_1%LB = 1
 1543.          t$588%dim_1%EX = _zla( 0, ncols )
 1543.          t$588%dim_1%SM = 1
 1543.          ipa$573 = 60
 1543.          call updia1d( t$588, ipa$573, latco )
 1543.       endif
 1545.       if ( (dodia%base_addr)(24, 0) ) then
 1545. !dir$ suppress xswtoadown(1)
 1545.          t$589%base_addr = pointer to array[1] of real (kind=8)( loc( xswtoadown(1) ) )
 1545.          t$589%header%el_len = 64
 1545.          t$589%header%assoc = 1
 1545.          t$589%header%ptr_alloc = 0
 1545.          t$589%header%p_or_a = 0
 1545.          t$589%header%a_contig = 1
 1545.          t$589%header%dv_versn = 2
 1545.          t$589%header%dv_smunit = 64
 1545.          t$589%header%d_type = 0
 1545.          t$589%header%n_params = 0
 1545.          t$589%header%pad_codim = 0
 1545.          t$589%header%n_codim = 0
 1545.          t$589%header%pad_dim = 0
 1545.          t$589%header%n_dim = 1
 1545.          t$589%header%d_type_idx = 13
 1545.          t$589%header%typ_code = 134481411
 1545.          t$589%header%orig_base = 0
 1545.          t$589%header%orig_size = 0
 1545.          t$589%dim_1%LB = 1
 1545.          t$589%dim_1%EX = _zla( 0, ncols )
 1545.          t$589%dim_1%SM = 1
 1545.          ipa$575 = 24
 1545.          call updia1d( t$589, ipa$575, latco )
 1545.       endif
 1550.       if ( (dodia%base_addr)(28, 0) ) then
 1551.          if ( ncols > 0 ) then
 1551.             $I_L1551_50 = 0
 1551. !dir$ ivdep
 1551.             do
 1552.                bfr1(1 + $I_L1551_50) = xswtoadown(1 + $I_L1551_50) + -swtoaup(1 + $I_L1551_50)
 1553.                $I_L1551_50 = 1 + $I_L1551_50
 1551.                if ( $I_L1551_50 >= ncols ) exit
 1551.             enddo
 1551.          endif
 1554. !dir$ suppress bfr1(1)
 1554.          t$593%base_addr = pointer to array[1] of real (kind=8)( loc( bfr1(1) ) )
 1554.          t$593%header%el_len = 64
 1554.          t$593%header%assoc = 1
 1554.          t$593%header%ptr_alloc = 0
 1554.          t$593%header%p_or_a = 0
 1554.          t$593%header%a_contig = 1
 1554.          t$593%header%dv_versn = 2
 1554.          t$593%header%dv_smunit = 64
 1554.          t$593%header%d_type = 0
 1554.          t$593%header%n_params = 0
 1554.          t$593%header%pad_codim = 0
 1554.          t$593%header%n_codim = 0
 1554.          t$593%header%pad_dim = 0
 1554.          t$593%header%n_dim = 1
 1554.          t$593%header%d_type_idx = 13
 1554.          t$593%header%typ_code = 134481411
 1554.          t$593%header%orig_base = 0
 1554.          t$593%header%orig_size = 0
 1554.          t$593%dim_1%LB = 1
 1554.          t$593%dim_1%EX = _zla( 0, ncols )
 1554.          t$593%dim_1%SM = 1
 1554.          ipa$577 = 28
 1554.          call updia1d( t$593, ipa$577, latco )
 1554.       endif
 1558.       if ( (dodia%base_addr)(61, 0) ) then
 1559.          if ( ncols > 0 ) then
 1559.             $I_L1559_52 = 0
 1559. !dir$ ivdep
 1559.             do
 1560.                bfr1(1 + $I_L1559_52) = xswtoadown(1 + $I_L1559_52) + -swtoaupc(1 + $I_L1559_52)
 1561.                $I_L1559_52 = 1 + $I_L1559_52
 1559.                if ( $I_L1559_52 >= ncols ) exit
 1559.             enddo
 1559.          endif
 1562. !dir$ suppress bfr1(1)
 1562.          t$597%base_addr = pointer to array[1] of real (kind=8)( loc( bfr1(1) ) )
 1562.          t$597%header%el_len = 64
 1562.          t$597%header%assoc = 1
 1562.          t$597%header%ptr_alloc = 0
 1562.          t$597%header%p_or_a = 0
 1562.          t$597%header%a_contig = 1
 1562.          t$597%header%dv_versn = 2
 1562.          t$597%header%dv_smunit = 64
 1562.          t$597%header%d_type = 0
 1562.          t$597%header%n_params = 0
 1562.          t$597%header%pad_codim = 0
 1562.          t$597%header%n_codim = 0
 1562.          t$597%header%pad_dim = 0
 1562.          t$597%header%n_dim = 1
 1562.          t$597%header%d_type_idx = 13
 1562.          t$597%header%typ_code = 134481411
 1562.          t$597%header%orig_base = 0
 1562.          t$597%header%orig_size = 0
 1562.          t$597%dim_1%LB = 1
 1562.          t$597%dim_1%EX = _zla( 0, ncols )
 1562.          t$597%dim_1%SM = 1
 1562.          ipa$579 = 61
 1562.          call updia1d( t$597, ipa$579, latco )
 1562.       endif
 1565.       if ( (dodia%base_addr)(29, 0) ) then
 1566.          if ( ncols > 0 ) then
 1566.             $I_L1566_54 = 0
 1566. !dir$ ivdep
 1566.             do
 1567.                bfr1(1 + $I_L1566_54) = ( 1.0 + -albvisdiff(1 + $I_L1566_54) ) * xvisdiff(1 + $I_L1566_54) + ( 1.0 + -albvisbeam(1 + $I_L1566_54) ) * xvisbeam(1 + $I_L1566_54) + ( 1.0 + -albnirdiff(1 + $I_L1566_54) ) * xnirdiff(1 + $I_L1566_54) + ( 1.0 + -albnirbeam(1 + $I_L1566_54) ) * xnirbeam(1 + $I_L1566_54)
 1571.                $I_L1566_54 = 1 + $I_L1566_54
 1566.                if ( $I_L1566_54 >= ncols ) exit
 1566.             enddo
 1566.          endif
 1572. !dir$ suppress bfr1(1)
 1572.          t$601%base_addr = pointer to array[1] of real (kind=8)( loc( bfr1(1) ) )
 1572.          t$601%header%el_len = 64
 1572.          t$601%header%assoc = 1
 1572.          t$601%header%ptr_alloc = 0
 1572.          t$601%header%p_or_a = 0
 1572.          t$601%header%a_contig = 1
 1572.          t$601%header%dv_versn = 2
 1572.          t$601%header%dv_smunit = 64
 1572.          t$601%header%d_type = 0
 1572.          t$601%header%n_params = 0
 1572.          t$601%header%pad_codim = 0
 1572.          t$601%header%n_codim = 0
 1572.          t$601%header%pad_dim = 0
 1572.          t$601%header%n_dim = 1
 1572.          t$601%header%d_type_idx = 13
 1572.          t$601%header%typ_code = 134481411
 1572.          t$601%header%orig_base = 0
 1572.          t$601%header%orig_size = 0
 1572.          t$601%dim_1%LB = 1
 1572.          t$601%dim_1%EX = _zla( 0, ncols )
 1572.          t$601%dim_1%SM = 1
 1572.          ipa$581 = 29
 1572.          call updia1d( t$601, ipa$581, latco )
 1572.       endif
 1576.       if ( (dodia%base_addr)(62, 0) ) then
 1577.          if ( ncols > 0 ) then
 1577.             $I_L1577_56 = 0
 1577. !dir$ ivdep
 1577.             do
 1578.                bfr1(1 + $I_L1577_56) = ( 1.0 + -albvisdiff(1 + $I_L1577_56) ) * xvisdiffc(1 + $I_L1577_56) + ( 1.0 + -albvisbeam(1 + $I_L1577_56) ) * xvisbeamc(1 + $I_L1577_56) + ( 1.0 + -albnirdiff(1 + $I_L1577_56) ) * xnirdiffc(1 + $I_L1577_56) + ( 1.0 + -albnirbeam(1 + $I_L1577_56) ) * xnirbeamc(1 + $I_L1577_56)
 1582.                $I_L1577_56 = 1 + $I_L1577_56
 1577.                if ( $I_L1577_56 >= ncols ) exit
 1577.             enddo
 1577.          endif
 1583. !dir$ suppress bfr1(1)
 1583.          t$605%base_addr = pointer to array[1] of real (kind=8)( loc( bfr1(1) ) )
 1583.          t$605%header%el_len = 64
 1583.          t$605%header%assoc = 1
 1583.          t$605%header%ptr_alloc = 0
 1583.          t$605%header%p_or_a = 0
 1583.          t$605%header%a_contig = 1
 1583.          t$605%header%dv_versn = 2
 1583.          t$605%header%dv_smunit = 64
 1583.          t$605%header%d_type = 0
 1583.          t$605%header%n_params = 0
 1583.          t$605%header%pad_codim = 0
 1583.          t$605%header%n_codim = 0
 1583.          t$605%header%pad_dim = 0
 1583.          t$605%header%n_dim = 1
 1583.          t$605%header%d_type_idx = 13
 1583.          t$605%header%typ_code = 134481411
 1583.          t$605%header%orig_base = 0
 1583.          t$605%header%orig_size = 0
 1583.          t$605%dim_1%LB = 1
 1583.          t$605%dim_1%EX = _zla( 0, ncols )
 1583.          t$605%dim_1%SM = 1
 1583.          ipa$583 = 62
 1583.          call updia1d( t$605, ipa$583, latco )
 1583.       endif
 1369.       _free( t$114 )
 1586.       return
 1586.       end
 1586.       
 1588.       
 1588.       subroutine destroyradiationdriver
 1592.       return
 1592.       end
 1592.       
 1597.       
 1597.       subroutine rqvirt( ncols, kmax, sig, gps, tin, qin, tout, qout, relhum )
 1597.       t$18 = kmax
 1646.       t$117 = _zla( 0, kmax )
 1597.       t$19 = ncols
 1648.       t$118 = _zla( 0, ncols )
 1597.       t$119 = _zla( 0, ncols )
 1597.       t$120 = _zla( 0, kmax ) * _zla( 0, ncols )
 1659.       t$123 = _zla( 0, kmax ) * _zla( 0, ncols ) * 8
 1658.       t$124 = _zla( 0, kmax ) * _zla( 0, ncols ) * 8
 1658.       t$126 = _zla( 0, kmax ) * _zla( 0, ncols ) * 16
 1597.       t$121 = int( _alloc( _zla( 0, kmax ) * _zla( 0, ncols ) * 16 ), 8 )
 1659.       t$122 = t$121
 1658.       t$125 = t$121 + _zla( 0, kmax ) * _zla( 0, ncols ) * 8
 1671.       $k1_S1 = 1
 1671.       if ( mod( kmax, 4 ) > 0 ) then
 1671.          $I_L1671_72 = 0
 1671.          do
 1672.             $F_A33 = ncols
 1672.             if ( ncols > 0 ) then
 1672.                $SCA_sig_I0 = sig(1 + $I_L1671_72)
 1672.                $I_L1672_54 = 0
 1672. !dir$ ivdep
 1672.                do
 1672.                   prs(1 + $I_L1672_54, 1 + $I_L1671_72) = gps(1 + $I_L1672_54) * $SCA_sig_I0
 1672.                   $I_L1672_54 = 1 + $I_L1672_54
 1672.                   if ( $I_L1672_54 >= $F_A33 ) exit
 1672.                enddo
 1672.             endif
 1673.             $I_L1671_72 = 1 + $I_L1671_72
 1671.             if ( $I_L1671_72 >= mod( kmax, 4 ) ) exit
 1671.          enddo
 1673.          $k1_S1 = ( 1 + mod( kmax, 4 ) )
 1673.       endif
 1674.       if ( kmax + -$k1_S1 >= 0 ) then
 1674.          $I_L1674_74 = 0
 1674.          do
 1675.             $F_A34 = ncols
 1675.             if ( ncols > 0 ) then
 1675.                $SCA_sig_I1 = sig($k1_S1 + 4 * $I_L1674_74)
 1675.                $I_L1675_56 = 0
 1675. !dir$ ivdep
 1675.                do
 1675.                   prs(1 + $I_L1675_56, $k1_S1 + 4 * $I_L1674_74) = gps(1 + $I_L1675_56) * $SCA_sig_I1
 1675.                   $I_L1675_56 = 1 + $I_L1675_56
 1675.                   if ( $I_L1675_56 >= $F_A34 ) exit
 1675.                enddo
 1675.             endif
 1676.             $F_A35 = ncols
 1676.             if ( ncols > 0 ) then
 1676.                $SCA_sig_I2 = sig($k1_S1 + 4 * $I_L1674_74 + 1)
 1676.                $I_L1676_58 = 0
 1676. !dir$ ivdep
 1676.                do
 1676.                   prs(1 + $I_L1676_58, $k1_S1 + 4 * $I_L1674_74 + 1) = gps(1 + $I_L1676_58) * $SCA_sig_I2
 1676.                   $I_L1676_58 = 1 + $I_L1676_58
 1676.                   if ( $I_L1676_58 >= $F_A35 ) exit
 1676.                enddo
 1676.             endif
 1677.             $F_A36 = ncols
 1677.             if ( ncols > 0 ) then
 1677.                $SCA_sig_I3 = sig($k1_S1 + 4 * $I_L1674_74 + 2)
 1677.                $I_L1677_60 = 0
 1677. !dir$ ivdep
 1677.                do
 1677.                   prs(1 + $I_L1677_60, $k1_S1 + 4 * $I_L1674_74 + 2) = gps(1 + $I_L1677_60) * $SCA_sig_I3
 1677.                   $I_L1677_60 = 1 + $I_L1677_60
 1677.                   if ( $I_L1677_60 >= $F_A36 ) exit
 1677.                enddo
 1677.             endif
 1678.             $F_A37 = ncols
 1678.             if ( ncols > 0 ) then
 1678.                $SCA_sig_I4 = sig($k1_S1 + 4 * $I_L1674_74 + 3)
 1678.                $I_L1678_62 = 0
 1678. !dir$ ivdep
 1678.                do
 1678.                   prs(1 + $I_L1678_62, $k1_S1 + 4 * $I_L1674_74 + 3) = gps(1 + $I_L1678_62) * $SCA_sig_I4
 1678.                   $I_L1678_62 = 1 + $I_L1678_62
 1678.                   if ( $I_L1678_62 >= $F_A37 ) exit
 1678.                enddo
 1678.             endif
 1679.             $I_L1674_74 = 1 + $I_L1674_74
 1674.             if ( $I_L1674_74 >= ( kmax + -$k1_S1 + 4 ) / 4 ) exit
 1674.          enddo
 1674.       endif
 1684.       $F_A38 = kmax
 1684.       $F_A39 = ncols
 1684.       if ( and( -$F_A39, -$F_A38 ) < 0 ) then
 1684.          $I_L1684_78 = 0
 1684.          do
 1684.             $I_L1684_64 = 0
 1684. !dir$ ivdep
 1684.             do
 1684.                qout(1 + $I_L1684_64, 1 + $I_L1684_78) = qin(1 + $I_L1684_64, 1 + $I_L1684_78)
 1684.                $I_L1684_64 = 1 + $I_L1684_64
 1684.                if ( $I_L1684_64 >= $F_A39 ) exit
 1684.             enddo
 1684.             $I_L1684_78 = 1 + $I_L1684_78
 1684.             if ( $I_L1684_78 >= $F_A38 ) exit
 1684.          enddo
 1684.       endif
 1685.       t$616 = int( _alloc( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 ), 8 )
 1685.       $F_A40 = kmax
 1685.       $F_A41 = ncols
 1685.       if ( and( -$F_A41, -$F_A40 ) < 0 ) then
 1685.          $I_L1685_80 = 0
 1685.          do
 1685.             $I_L1685_66 = 0
 1685. !dir$ ivdep
 1685.             do
 1685.                t$615(1 + $I_L1685_66, 1 + $I_L1685_80) = qout(1 + $I_L1685_66, 1 + $I_L1685_80) < 9.9999999999999998e-13
 1685.                $I_L1685_66 = 1 + $I_L1685_66
 1685.                if ( $I_L1685_66 >= $F_A41 ) exit
 1685.             enddo
 1685.             $I_L1685_80 = 1 + $I_L1685_80
 1685.             if ( $I_L1685_80 >= $F_A40 ) exit
 1685.          enddo
 1685.       endif
 1686.       $F_A42 = kmax
 1686.       $F_A43 = ncols
 1686.       if ( and( -$F_A43, -$F_A42 ) < 0 ) then
 1686.          $I_L1686_82 = 0
 1686.          do
 1686.             $I_L1686_68 = 0
 1686. !dir$ ivdep
 1686.             do
 1686.                if ( t$615(1 + $I_L1686_68, 1 + $I_L1686_82) ) then
 1686.                   qout(1 + $I_L1686_68, 1 + $I_L1686_82) = 9.9999999999999998e-13
 1686.                endif
 1686.                $I_L1686_68 = 1 + $I_L1686_68
 1686.                if ( $I_L1686_68 >= $F_A43 ) exit
 1686.             enddo
 1686.             $I_L1686_82 = 1 + $I_L1686_82
 1686.             if ( $I_L1686_82 >= $F_A42 ) exit
 1686.          enddo
 1686.       endif
 1685.       _free( t$616 )
 1692.       $F_A44 = kmax
 1692.       $F_A45 = ncols
 1692.       if ( and( -$F_A45, -$F_A44 ) < 0 ) then
 1692.          $I_L1692_84 = 0
 1692.          do
 1692.             $I_L1692_70 = 0
 1692. !dir$ ivdep
 1692.             do
 1692.                tout(1 + $I_L1692_70, 1 + $I_L1692_84) = ( tin(1 + $I_L1692_70, 1 + $I_L1692_84) * 1.0/( 1.0 + 6.0799999999999998e-1 * qout(1 + $I_L1692_70, 1 + $I_L1692_84) ) )
 1692.                $I_L1692_70 = 1 + $I_L1692_70
 1692.                if ( $I_L1692_70 >= $F_A45 ) exit
 1692.             enddo
 1692.             $I_L1692_84 = 1 + $I_L1692_84
 1692.             if ( $I_L1692_84 >= $F_A44 ) exit
 1692.          enddo
 1692.       endif
 1698.       $const_S5 = 6.1100000000000003 * _expn( -( -5452.7691736782708 * 1.0/tbase ) )
 1699.       if ( kmax > 0 ) then
 1700.          if ( ncols > 0 ) then
 1699.             $I_L1699_76 = 0
 1699.             do
 1700.                $I_L1700_50 = 0
 1700. !dir$ ivdep
 1700.                do
 1701.                   $fac_S6 = $const_S5 * _expn( ( -5452.7691736782708 * 1.0/tout(1 + $I_L1700_50, 1 + $I_L1699_76) ) )
 1703.                   qsat(1 + $I_L1700_50, 1 + $I_L1699_76) = ( 1.0/( 10.0 * prs(1 + $I_L1700_50, 1 + $I_L1699_76) + -3.78e-1 * $fac_S6 ) * $fac_S6 * 6.22e-1 )
 1704.                   $I_L1700_50 = 1 + $I_L1700_50
 1700.                   if ( $I_L1700_50 >= ncols ) exit
 1700.                enddo
 1711.                $I_L1711_52 = 0
 1711. !dir$ ivdep
 1711.                do
 1712.                   $relhum_WR0_R0 = ( qout(1 + $I_L1711_52, 1 + $I_L1699_76) * 1.0/qsat(1 + $I_L1711_52, 1 + $I_L1699_76) )
 1712.                   relhum(1 + $I_L1711_52, 1 + $I_L1699_76) = $relhum_WR0_R0
 1717.                   if ( $relhum_WR0_R0 > 1.0 ) then
 1718.                      qout(1 + $I_L1711_52, 1 + $I_L1699_76) = qsat(1 + $I_L1711_52, 1 + $I_L1699_76)
 1719.                      relhum(1 + $I_L1711_52, 1 + $I_L1699_76) = 1.0
 1719.                   endif
 1721.                   $I_L1711_52 = 1 + $I_L1711_52
 1720.                   if ( $I_L1711_52 >= ncols ) exit
 1720.                enddo
 1705.                $I_L1699_76 = 1 + $I_L1699_76
 1704.                if ( $I_L1699_76 >= kmax ) exit
 1704.             enddo
 1704.          endif
 1704.       endif
 1597.       _free( t$121 )
 1723.       return
 1723.       end
 1723.       
 1725.       
 1725.       subroutine coszmed( idatec, tod, yrl, colrad, lonrad, cos2, ncols )
 1725.       t$20 = ncols
 1732.       t$127 = _zla( 0, ncols )
 1744.       t$130 = 8 * _zla( 0, ncols )
 1725.       t$128 = int( _alloc( 8 * _zla( 0, ncols ) ), 8 )
 1744.       t$129 = t$128
 1753.       call radtim( idatec(1), sdelt, ratio, etime, tod, xday, yrl )
 1755.       $Coss_P0 = coss( sdelt )
 1759.       cosmax = 0.0
 1762.       $Coss_P1 = coss( colrad )
 1762.       $zenith1_S7 = cimag( $Coss_P0 ) * real( $Coss_P1, 8 )
 1763.       $zenith2_S6 = real( $Coss_P0, 8 ) * cimag( $Coss_P1 )
 1764.       $frh_S3 = ( 2.7777777777777778e-4 * ( -3.125e-2 + mod( 3.125e-2 + tod, 3600.0 ) ) )
 1765.       $ncount_S8 = 0
 1766.       if ( ncols > 0 ) then
 1768.          $SC_idatec_I0 = idatec(1)
 1766.          $I_L1766_6 = 0
 1766. !dir$ ivdep
 1766.          do
 1767.             $btime_S4 = 6.6666666666666666e-2 * lonrad(1 + $I_L1766_6)
 1769.             $zenith_WR0_R0 = $zenith1_S7 + $zenith2_S6 * cos( ( etime + 2.6179938779914919e-1 * ( -$frh_S3 + -$SC_idatec_I0 + -$btime_S4 + 12.0 ) ) )
 1770.             if ( $zenith1_S7 + $zenith2_S6 * cos( ( etime + 2.6179938779914919e-1 * ( -$frh_S3 + -$SC_idatec_I0 + -$btime_S4 + 12.0 ) ) ) > 0.0 ) then
 1771.                $ncount_S8 = 1 + $ncount_S8
 1772.                cosmax = cosmax + $zenith_WR0_R0
 1772.             endif
 1774.             $I_L1766_6 = 1 + $I_L1766_6
 1773.             if ( $I_L1766_6 >= ncols ) exit
 1773.          enddo
 1773.       endif
 1776.       cos2 = ( cosmax * 1.0/cvmg( $ncount_S8, 1, $ncount_S8 /= 0 ) )
 1725.       _free( t$128 )
 1777.       return
 1777.       end
 1777.       
 1782.       
 1782.       subroutine radtim( id, delta, ratio, etime, tod, xday, yrl )
 1815.       $xday_S0 = 3600.0 * id(1)
 1817.       $xday_S1 = ( monday(id(2)) + id(3) ) + 1.1574074074074073e-5 * ( $xday_S0 + mod( tod, 3600.0 ) )
 1819.       if ( yrl == 365.25 ) then
 1820.          $xday_S1 = $xday_S1 + -2.5e-1 * mod( 3 + id(4), 4 )
 1821.          if ( mod( id(4), 4 ) == 0 ) then
 1821.             if ( id(2) > 2 ) then
 1821.                $xday_S1 = 1.0 + $xday_S1
 1821.             endif
 1821.          endif
 1821.       endif
 1824.       xday = mod( -1.0 + $xday_S1, yrl )
 1826.       if ( mod( -1.0 + $xday_S1, yrl ) > -1.0 ) then
 1828.          $Coss_P2 = coss( 18.849555921538741 * ( 1.0/yrl * xday ) )
 1828.          $Coss_P3 = coss( 12.56637061435916 * ( 1.0/yrl * xday ) )
 1828.          $Coss_P4 = coss( ( 1.0/yrl * xday * 6.28318530717958 ) )
 1828.          delta = 7.0257e-2 * cimag( $Coss_P4 ) + -3.9991199999999999e-1 * real( $Coss_P4, 8 ) + -6.7580000000000001e-3 * real( $Coss_P3, 8 ) + 9.0700000000000004e-4 * cimag( $Coss_P3 ) + -2.6970000000000002e-3 * real( $Coss_P2, 8 ) + 1.48e-3 * cimag( $Coss_P2 ) + 6.9179999999999997e-3
 1831.          ratio = 1.2800000000000001e-3 * cimag( $Coss_P4 ) + 3.4221000000000001e-2 * real( $Coss_P4, 8 ) + 7.1900000000000002e-4 * real( $Coss_P3, 8 ) + 7.7000000000000001e-5 * cimag( $Coss_P3 ) + 1.0001100000000001
 1833.          etime = -3.2077000000000001e-2 * cimag( $Coss_P4 ) + 1.8680000000000001e-3 * real( $Coss_P4, 8 ) + -1.4615e-2 * real( $Coss_P3, 8 ) + -4.0849000000000003e-2 * cimag( $Coss_P3 ) + 7.4999999999999993e-5
 1833.       else
 1836.          $Unit_temp_O0 = nfprt
 1836.          $_IOitem_P0(0) = tod
 1836.          $_IOitem_P0(1) = xday
 1836.          _fwrite( _clist( 0, 0, 3, $Unit_temp_O0, Null_Arg, Null_Arg, t$22,  _substr(t$21,1,74), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( id(+:( 1, 4, 1 )), 0x2000200000000L ), _iotype( $_IOitem_P0(:( 0, 1, 1 )), 0x804060300000000L ) ) )
 1837.          $Unit_temp_O1 = nferr
 1837.          $_IOitem_P1(0) = tod
 1837.          $_IOitem_P1(1) = xday
 1837.          _fwrite( _clist( 0, 0, 3, $Unit_temp_O1, Null_Arg, Null_Arg, t$22,  _substr(t$21,1,74), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( id(+:( 1, 4, 1 )), 0x2000200000000L ), _iotype( $_IOitem_P1(:( 0, 1, 1 )), 0x804060300000000L ) ) )
 1838.           _substr(t$632,1,4) = '2020'
 1838.          call _stop(  _substr(t$632,1,4) )
 1838.       endif
 1843.       return
 1843.       end
 1843.       
 2700.       
 2700.       subroutine spmrad( first, ifday, lcnvl, lthncl, nfin0, nfin1, nfcnv0, intcosz, mxrdcc, inalb, icld, yrl, idatec, idate, tod, delt, trint, swint, colrad, lonrad, cosz, cos2d, sigmid, sigbot, delsig, latco, ncols, kmax, nls, nlcs, imask, gps, gtmp, gwv, gtg, grh, omg, tsea, convts, convcs, convbs, convc, convt, convb, albvisdiff, albnirdiff, albvisbeam, albnirbeam, rswtoadown, rvisdiff, rnirdiff, rvisbeam, rnirbeam, rvisdiffc, rnirdiffc, rvisbeamc, rnirbeamc, rswsfcnet, rswsfcnetc, rswtoanet, rswtoanetc, yswtoadown, yvisdiff, ynirdiff, yvisbeam, ynirbeam, yvisdiffc, ynirdiffc, yvisbeamc, ynirbeamc, yswheatrate, yswheatratec, yswsfcnet, yswsfcnetc, yswtoanet, yswtoanetc, ssib_visdiff, ssib_nirdiff, ssib_visbeam, ssib_nirbeam, lwcoolrate, lwsfcdown, lwsfcnet, lwtoaup, lwcoolratec, lwsfcdownc, lwsfcnetc, lwtoaupc, cloudcover, cldcovtot, cldcovinv, cldcovsat, cldcovcon, cldcovsha, cldliqwatpath, emisd, taud, co2val, o3mix )
 1872.       t$23 = ncols
 2123.       t$131 = _zla( 0, ncols )
 1872.       t$24 = kmax
 2127.       t$132 = _zla( 0, kmax )
 1872.       t$25 = ( 1 + kmax )
 2128.       t$133 = _zla( 0, ( 1 + kmax ) )
 1872.       t$134 = _zla( 0, ncols )
 1872.       t$135 = _zla( 0, ncols ) * _zla( 0, kmax )
 2247.       t$138 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8
 2248.       t$139 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8
 2248.       t$141 = _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 2245.       t$142 = _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 2245.       t$144 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24
 2246.       t$145 = _zla( 0, ncols ) * _zla( 0, kmax ) * 24
 2246.       t$147 = _zla( 0, ncols ) * _zla( 0, kmax ) * 32
 2250.       t$148 = _zla( 0, ncols ) * _zla( 0, kmax ) * 32
 2250.       t$150 = _zla( 0, ncols ) * _zla( 0, kmax ) * 40
 2232.       t$151 = _zla( 0, ncols ) * _zla( 0, kmax ) * 40
 2232.       t$153 = 8 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 40
 2231.       t$154 = 8 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 40
 2231.       t$156 = _zla( 0, ncols ) * _zla( 0, kmax ) * 40 + 16 * _zla( 0, ncols )
 2253.       t$157 = _zla( 0, ncols ) * _zla( 0, kmax ) * 40 + 16 * _zla( 0, ncols )
 2253.       t$159 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 48
 2256.       t$160 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 48
 2256.       t$162 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 56
 2239.       t$163 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 56
 2239.       t$165 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 64
 2259.       t$166 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 64
 2259.       t$168 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 72
 2260.       t$169 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 72
 2260.       t$171 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 80
 2240.       t$172 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 80
 2240.       t$174 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 88
 2238.       t$175 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 88
 2238.       t$177 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 96
 2237.       t$178 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 96
 2237.       t$180 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 104
 2236.       t$181 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 104
 2236.       t$183 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 112
 2257.       t$184 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 112
 2257.       t$186 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 120
 2258.       t$187 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 120
 2258.       t$189 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 128
 2261.       t$190 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 128
 2261.       t$192 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 136
 2235.       t$193 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 136
 2235.       t$195 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 144
 2254.       t$196 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 144
 2254.       t$198 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 152
 2251.       t$199 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 152
 2251.       t$201 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 160
 2252.       t$202 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 160
 2252.       t$204 = 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 168
 1872.       t$136 = int( _alloc( 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 168 ), 8 )
 2247.       t$137 = t$136
 2248.       t$140 = t$136 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8
 2245.       t$143 = t$136 + _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 2246.       t$146 = t$136 + _zla( 0, ncols ) * _zla( 0, kmax ) * 24
 2250.       t$149 = t$136 + _zla( 0, ncols ) * _zla( 0, kmax ) * 32
 2232.       t$152 = t$136 + _zla( 0, ncols ) * _zla( 0, kmax ) * 40
 2231.       t$155 = t$136 + 8 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 40
 2253.       t$158 = t$136 + _zla( 0, ncols ) * _zla( 0, kmax ) * 40 + 16 * _zla( 0, ncols )
 2256.       t$161 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 48
 2239.       t$164 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 56
 2259.       t$167 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 64
 2260.       t$170 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 72
 2240.       t$173 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 80
 2238.       t$176 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 88
 2237.       t$179 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 96
 2236.       t$182 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 104
 2257.       t$185 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 112
 2258.       t$188 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 120
 2261.       t$191 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 128
 2235.       t$194 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 136
 2254.       t$197 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 144
 2251.       t$200 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 152
 2252.       t$203 = t$136 + 16 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 160
 2283.       if ( abs( mod( 3.125e-2 + 2.7777777777777778e-4 * ( tod + -delt ), swint ) ) <= 6.25e-2 ) then
 2247.          goto 10
 2283.       else if ( first == 0 ) then
 1872.          _free( t$136 )
 1872.       else
 1872.    10    continue
 2291.          call astropar( ncols, colrad(1), lonrad(1), idatec(1), tod, yrl, date, s0, cosz(1) )
 2294.          ifdayx = ifday
 2295.          todx = tod + 3600.0 * swint
 2297.          if ( ( tod + 3600.0 * swint ) >= 86400.0 ) then
 2298.             todx = mod( todx, 86400.0 )
 2299.             ifdayx = 1 + ifday
 2299.          endif
 2302.          call tmstmp2( idate(1), ifdayx, todx, jhr, jday, jmon, jyr )
 2304.          idatex(1) = jhr
 2305.          idatex(2) = jmon
 2306.          idatex(3) = jday
 2307.          idatex(4) = jyr
 2310.          call astropar( ncols, colrad(1), lonrad(1), idatex(1), todx, yrl, datex, s0x, cos1(1) )
 2313.          if ( intcosz ) then
 2314.             $F_A33 = ncols
 2314.             if ( ncols > 0 ) then
 2314.                $I_L2314_111 = 0
 2314. !dir$ ivdep
 2314.                do
 2314.                   cos2(1 + $I_L2314_111) = cos2d(1 + $I_L2314_111)
 2314.                   $I_L2314_111 = 1 + $I_L2314_111
 2314.                   if ( $I_L2314_111 >= $F_A33 ) exit
 2314.                enddo
 2314.             endif
 2314.          else
 2316.             $F_A34 = ncols
 2316.             if ( ncols > 0 ) then
 2316.                $I_L2316_113 = 0
 2316. !dir$ ivdep
 2316.                do
 2316.                   cos2(1 + $I_L2316_113) = cosz(1 + $I_L2316_113)
 2316.                   $I_L2316_113 = 1 + $I_L2316_113
 2316.                   if ( $I_L2316_113 >= $F_A34 ) exit
 2316.                enddo
 2316.             endif
 2316.          endif
 2323.          if ( ifozone == 0 ) then
 2324.             call getoz( ncols, kmax, sigmid(1), colrad(1), date, flipo3(1, 1) )
 2325.             if ( kmax > 0 ) then
 2327.                if ( ncols > 0 ) then
 2325.                   $I_L2325_125 = 0
 2325.                   do
 2327.                      $I_L2327_96 = 0
 2327. !dir$ ivdep
 2327.                      do
 2328.                         o3mix(1 + $I_L2327_96, 1 + $I_L2325_125) = flipo3(1 + $I_L2327_96, kmax + -$I_L2325_125)
 2329.                         $I_L2327_96 = 1 + $I_L2327_96
 2327.                         if ( $I_L2327_96 >= ncols ) exit
 2327.                      enddo
 2330.                      $I_L2325_125 = 1 + $I_L2325_125
 2329.                      if ( $I_L2325_125 >= kmax ) exit
 2329.                   enddo
 2329.                endif
 2329.             endif
 2331.          else if ( kmax > 0 ) then
 2336.             if ( ncols > 0 ) then
 2334.                $I_L2334_123 = 0
 2334.                do
 2336.                   $I_L2336_94 = 0
 2336. !dir$ ivdep
 2336.                   do
 2337.                      flipo3(1 + $I_L2336_94, kmax + -$I_L2334_123) = o3mix(1 + $I_L2336_94, 1 + $I_L2334_123)
 2338.                      $I_L2336_94 = 1 + $I_L2336_94
 2336.                      if ( $I_L2336_94 >= ncols ) exit
 2336.                   enddo
 2339.                   $I_L2334_123 = 1 + $I_L2334_123
 2338.                   if ( $I_L2334_123 >= kmax ) exit
 2338.                enddo
 2338.             endif
 2338.          endif
 2346.          if ( kmax > 0 ) then
 2348.             if ( ncols > 0 ) then
 2346.                $I_L2346_127 = 0
 2346.                if ( kmax >= 4 ) then
 2346.                   $I_L2346_153 = 0
 2346. !dir$ blocking_size( 0, 0 )
 2346.                   do
 2348.                      $SCA_sigmid#1_U0 = sigmid(kmax + -4 * $I_L2346_153)
 2348.                      $SCA_sigbot#1_U4 = sigbot(kmax + -4 * $I_L2346_153)
 2348.                      $SCA_sigmid#2_U1 = sigmid(kmax + -4 * $I_L2346_153 + -1)
 2348.                      $SCA_sigbot#2_U5 = sigbot(kmax + -4 * $I_L2346_153 + -1)
 2348.                      $SCA_sigmid#3_U2 = sigmid(kmax + -4 * $I_L2346_153 + -2)
 2348.                      $SCA_sigbot#3_U6 = sigbot(kmax + -4 * $I_L2346_153 + -2)
 2348.                      $SCA_sigmid#4_U3 = sigmid(kmax + -4 * $I_L2346_153 + -3)
 2348.                      $SCA_sigbot#4_U7 = sigbot(kmax + -4 * $I_L2346_153 + -3)
 2348.                      $I_L2348_98 = 0
 2348. !dir$ ivdep
 2348. !dir$ blocking_size( 0, 0 )
 2348.                      do
 2349.                         flipte(1 + $I_L2348_98, 1 + 4 * $I_L2346_153) = gtmp(1 + $I_L2348_98, kmax + -4 * $I_L2346_153)
 2350.                         flipqe(1 + $I_L2348_98, 1 + 4 * $I_L2346_153) = gwv(1 + $I_L2348_98, kmax + -4 * $I_L2346_153)
 2351.                         flippbot(1 + $I_L2348_98, 1 + 4 * $I_L2346_153) = gps(1 + $I_L2348_98) * $SCA_sigbot#1_U4
 2352.                         flippmid(1 + $I_L2348_98, 1 + 4 * $I_L2346_153) = gps(1 + $I_L2348_98) * $SCA_sigmid#1_U0
 2349.                         flipte(1 + $I_L2348_98, 2 + 4 * $I_L2346_153) = gtmp(1 + $I_L2348_98, kmax + -4 * $I_L2346_153 + -1)
 2350.                         flipqe(1 + $I_L2348_98, 2 + 4 * $I_L2346_153) = gwv(1 + $I_L2348_98, kmax + -4 * $I_L2346_153 + -1)
 2351.                         flippbot(1 + $I_L2348_98, 2 + 4 * $I_L2346_153) = gps(1 + $I_L2348_98) * $SCA_sigbot#2_U5
 2352.                         flippmid(1 + $I_L2348_98, 2 + 4 * $I_L2346_153) = gps(1 + $I_L2348_98) * $SCA_sigmid#2_U1
 2349.                         flipte(1 + $I_L2348_98, 3 + 4 * $I_L2346_153) = gtmp(1 + $I_L2348_98, kmax + -4 * $I_L2346_153 + -2)
 2350.                         flipqe(1 + $I_L2348_98, 3 + 4 * $I_L2346_153) = gwv(1 + $I_L2348_98, kmax + -4 * $I_L2346_153 + -2)
 2351.                         flippbot(1 + $I_L2348_98, 3 + 4 * $I_L2346_153) = gps(1 + $I_L2348_98) * $SCA_sigbot#3_U6
 2352.                         flippmid(1 + $I_L2348_98, 3 + 4 * $I_L2346_153) = gps(1 + $I_L2348_98) * $SCA_sigmid#3_U2
 2349.                         flipte(1 + $I_L2348_98, 4 + 4 * $I_L2346_153) = gtmp(1 + $I_L2348_98, kmax + -4 * $I_L2346_153 + -3)
 2350.                         flipqe(1 + $I_L2348_98, 4 + 4 * $I_L2346_153) = gwv(1 + $I_L2348_98, kmax + -4 * $I_L2346_153 + -3)
 2351.                         flippbot(1 + $I_L2348_98, 4 + 4 * $I_L2346_153) = gps(1 + $I_L2348_98) * $SCA_sigbot#4_U7
 2352.                         flippmid(1 + $I_L2348_98, 4 + 4 * $I_L2346_153) = gps(1 + $I_L2348_98) * $SCA_sigmid#4_U3
 2353.                         $I_L2348_98 = 1 + $I_L2348_98
 2348.                         if ( $I_L2348_98 >= ncols ) exit
 2348.                      enddo
 2354.                      $I_L2346_153 = 1 + $I_L2346_153
 2353.                      if ( $I_L2346_153 >= _rsh( kmax, 2 ) ) exit
 2353.                   enddo
 2354.                   $I_L2346_127 = and( 0xfffffffffffffffcUL, kmax )
 2354.                endif
 2346.                if ( $I_L2346_127 < kmax ) then
 2346.                   $I_L2346_147 = 0
 2346. !dir$ blocking_size( 0, 0 )
 2346.                   do
 2348.                      $SCA_sigmid_I0 = sigmid(kmax + -$I_L2346_127 + -$I_L2346_147)
 2348.                      $SCA_sigbot_I1 = sigbot(kmax + -$I_L2346_127 + -$I_L2346_147)
 2348.                      $I_L2348_98 = 0
 2348. !dir$ ivdep
 2348. !dir$ blocking_size( 0, 0 )
 2348.                      do
 2349.                         flipte(1 + $I_L2348_98, $I_L2346_127 + $I_L2346_147 + 1) = gtmp(1 + $I_L2348_98, kmax + -$I_L2346_127 + -$I_L2346_147)
 2350.                         flipqe(1 + $I_L2348_98, $I_L2346_127 + $I_L2346_147 + 1) = gwv(1 + $I_L2348_98, kmax + -$I_L2346_127 + -$I_L2346_147)
 2351.                         flippbot(1 + $I_L2348_98, $I_L2346_127 + $I_L2346_147 + 1) = gps(1 + $I_L2348_98) * $SCA_sigbot_I1
 2352.                         flippmid(1 + $I_L2348_98, $I_L2346_127 + $I_L2346_147 + 1) = gps(1 + $I_L2348_98) * $SCA_sigmid_I0
 2353.                         $I_L2348_98 = 1 + $I_L2348_98
 2348.                         if ( $I_L2348_98 >= ncols ) exit
 2348.                      enddo
 2354.                      $I_L2346_147 = 1 + $I_L2346_147
 2353.                      if ( $I_L2346_147 >= kmax + -$I_L2346_127 ) exit
 2353.                   enddo
 2353.                endif
 2353.             endif
 2353.          endif
 2356.          if ( ncols > 0 ) then
 2356.             $I_L2356_100 = 0
 2356. !dir$ ivdep
 2356.             do
 2357.                flipdp(1 + $I_L2356_100, 1) = -5.0e-1 + flippbot(1 + $I_L2356_100, 1)
 2358.                $I_L2356_100 = 1 + $I_L2356_100
 2356.                if ( $I_L2356_100 >= ncols ) exit
 2356.             enddo
 2356.          endif
 2359.          if ( -2 + kmax >= 0 ) then
 2360.             if ( ncols > 0 ) then
 2360.                $I_L2360_145 = 0
 2360.                do
 2359.                   $I_L2359_143 = 0
 2359.                   if ( -5 + kmax >= 0 ) then
 2359.                      $I_L2359_155 = 0
 2359. !dir$ blocking_size( 0, 0 )
 2359.                      do
 2360.                         $I_L2360_102 = 0
 2360. !dir$ ivdep
 2360. !dir$ blocking_size( 1024, 1024 )
 2360.                         do
 2361.                            flipdp($I_L2360_102 + 1024 * $I_L2360_145 + 1, 2 + 4 * $I_L2359_155) = flippbot($I_L2360_102 + 1024 * $I_L2360_145 + 1, 2 + 4 * $I_L2359_155) + -flippbot($I_L2360_102 + 1024 * $I_L2360_145 + 1, 1 + 4 * $I_L2359_155)
 2361.                            flipdp($I_L2360_102 + 1024 * $I_L2360_145 + 1, 3 + 4 * $I_L2359_155) = flippbot($I_L2360_102 + 1024 * $I_L2360_145 + 1, 3 + 4 * $I_L2359_155) + -flippbot($I_L2360_102 + 1024 * $I_L2360_145 + 1, 2 + 4 * $I_L2359_155)
 2361.                            flipdp($I_L2360_102 + 1024 * $I_L2360_145 + 1, 4 + 4 * $I_L2359_155) = flippbot($I_L2360_102 + 1024 * $I_L2360_145 + 1, 4 + 4 * $I_L2359_155) + -flippbot($I_L2360_102 + 1024 * $I_L2360_145 + 1, 3 + 4 * $I_L2359_155)
 2361.                            flipdp($I_L2360_102 + 1024 * $I_L2360_145 + 1, 5 + 4 * $I_L2359_155) = flippbot($I_L2360_102 + 1024 * $I_L2360_145 + 1, 5 + 4 * $I_L2359_155) + -flippbot($I_L2360_102 + 1024 * $I_L2360_145 + 1, 4 + 4 * $I_L2359_155)
 2360.                            $I_L2360_102 = 1 + $I_L2360_102
 2360.                            if ( $I_L2360_102 >= min( ncols, 1024 + 1024 * $I_L2360_145 ) + -1024 * $I_L2360_145 ) exit
 2360.                         enddo
 2363.                         $I_L2359_155 = 1 + $I_L2359_155
 2363.                         if ( $I_L2359_155 >= _rsh( -1 + kmax, 2 ) ) exit
 2363.                      enddo
 2363.                      $I_L2359_143 = and( 0xfffffffffffffffcUL, -1 + kmax )
 2363.                   endif
 2359.                   if ( $I_L2359_143 < -1 + kmax ) then
 2359.                      $I_L2359_150 = 0
 2359. !dir$ blocking_size( 0, 0 )
 2359.                      do
 2360.                         $I_L2360_102 = 0
 2360. !dir$ ivdep
 2360. !dir$ blocking_size( 1024, 1024 )
 2360.                         do
 2361.                            flipdp($I_L2360_102 + 1024 * $I_L2360_145 + 1, $I_L2359_143 + $I_L2359_150 + 2) = flippbot($I_L2360_102 + 1024 * $I_L2360_145 + 1, $I_L2359_143 + $I_L2359_150 + 2) + -flippbot($I_L2360_102 + 1024 * $I_L2360_145 + 1, $I_L2359_143 + $I_L2359_150 + 1)
 2360.                            $I_L2360_102 = 1 + $I_L2360_102
 2360.                            if ( $I_L2360_102 >= min( ncols, 1024 + 1024 * $I_L2360_145 ) + -1024 * $I_L2360_145 ) exit
 2360.                         enddo
 2363.                         $I_L2359_150 = 1 + $I_L2359_150
 2363.                         if ( $I_L2359_150 >= kmax + -$I_L2359_143 + -1 ) exit
 2363.                      enddo
 2363.                   endif
 2360.                   $I_L2360_145 = 1 + $I_L2360_145
 2362.                   if ( $I_L2360_145 >= 1 + max( 0, -1 + _rsh( 1023 + ncols, 10 ) ) ) exit
 2362.                enddo
 2362.             endif
 2362.          endif
 2371.           _substr(t$660,1,4) = 'RAND'
 2369.          call cloud_field( ncols, kmax, nls, icld,  _substr(t$660,1,4), mxrdcc, lcnvl, lthncl, sigmid(1), gps(1), grh(1, 1), omg(1, 1), gtmp(1, 1), convc(1), convt(1), convb(1), convts(1), convcs(1), convbs(1), cld(1, 1), clu(1, 1), cloudcover(1), cldcovtot(1, 1), cldcovinv(1, 1), cldcovsat(1, 1), cldcovcon(1, 1), cldcovsha(1, 1) )
 2382.          if ( icld == 3 ) then
 2382.             goto 20
 2382.          else if ( icld == 4 ) then
 2382.    20       continue
 2383.             call cloud_micro_ccm3( ncols, kmax, sigmid(1), sigbot(1), delsig(1), imask(1), gps(1), gtmp(1, 1), gwv(1, 1), tsea(1), flippbot(1, 1), clwp(1, 1), lmixr(1, 1), fice(1, 1), rei(1, 1), rel(1, 1), taud(1, 1) )
 2391.             $F_A35 = kmax
 2391.             $F_A36 = ncols
 2391.             if ( and( -$F_A36, -$F_A35 ) < 0 ) then
 2391.                $I_L2391_135 = 0
 2391.                do
 2391.                   $I_L2391_115 = 0
 2391. !dir$ ivdep
 2391.                   do
 2391.                      cldliqwatpath(1 + $I_L2391_115, 1 + $I_L2391_135) = clwp(1 + $I_L2391_115, 1 + $I_L2391_135)
 2391.                      $I_L2391_115 = 1 + $I_L2391_115
 2391.                      if ( $I_L2391_115 >= $F_A36 ) exit
 2391.                   enddo
 2391.                   $I_L2391_135 = 1 + $I_L2391_135
 2391.                   if ( $I_L2391_135 >= $F_A35 ) exit
 2391.                enddo
 2391.             endif
 2391.          endif
 2398.          if ( kmax > 0 ) then
 2400.             if ( ncols > 0 ) then
 2398.                $I_L2398_129 = 0
 2398.                do
 2400.                   $I_L2400_105 = 0
 2400. !dir$ ivdep
 2400.                   do
 2401.                      flipclwp(1 + $I_L2400_105, 1 + $I_L2398_129) = clwp(1 + $I_L2400_105, kmax + -$I_L2398_129)
 2402.                      fliprei(1 + $I_L2400_105, 1 + $I_L2398_129) = rei(1 + $I_L2400_105, kmax + -$I_L2398_129)
 2403.                      fliprel(1 + $I_L2400_105, 1 + $I_L2398_129) = rel(1 + $I_L2400_105, kmax + -$I_L2398_129)
 2404.                      flipfice(1 + $I_L2400_105, 1 + $I_L2398_129) = fice(1 + $I_L2400_105, kmax + -$I_L2398_129)
 2405.                      fliptaud(1 + $I_L2400_105, 1 + $I_L2398_129) = taud(1 + $I_L2400_105, kmax + -$I_L2398_129)
 2406.                      fliplmixr(1 + $I_L2400_105, 1 + $I_L2398_129) = lmixr(1 + $I_L2400_105, kmax + -$I_L2398_129)
 2407.                      $I_L2400_105 = 1 + $I_L2400_105
 2400.                      if ( $I_L2400_105 >= ncols ) exit
 2400.                   enddo
 2408.                   $I_L2398_129 = 1 + $I_L2398_129
 2407.                   if ( $I_L2398_129 >= kmax ) exit
 2407.                enddo
 2407.             endif
 2407.          endif
 2414.          if ( first == 0 .orelse. ifday /= 0 .orelse. tod /= 0.0 ) then
 2414.             goto 30
 2414.          else
 2415.             if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'LCH' ) then
 2417.                ipa$796 = .false.
 2417.                call swrad( ncols, kmax, nls, ipa$796, icld, inalb, s0, cos2(1), flippbot(1, 1), flipdp(1, 1), flipte(1, 1), flipqe(1, 1), flipo3(1, 1), albvisdiff(1), albnirdiff(1), albvisbeam(1), albnirbeam(1), rswtoadown(1), ssib_visbeam(1), ssib_visdiff(1), ssib_nirbeam(1), ssib_nirdiff(1), rvisbeamc(1), rvisdiffc(1), rnirbeamc(1), rnirdiffc(1), rswtoanetc(1), rswtoanet(1), rswsfcnetc(1), rswsfcnet(1), asclr(1, 1), asl(1, 1), cld(1, 1), clu(1, 1), fliptaud(1, 1) )
 2417.                goto 30
 2434.             else if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'CRD' ) then
 2436.                ipa$835 = .false.
 2436.                call cliradsw( ncols, kmax, nls, ipa$835, icld, inalb, s0, cos2(1), flippbot(1, 1), flipdp(1, 1), flipte(1, 1), flipqe(1, 1), flipo3(1, 1), gps(1), imask(1), albvisdiff(1), albnirdiff(1), albvisbeam(1), albnirbeam(1), rswtoadown(1), ssib_visbeam(1), ssib_visdiff(1), ssib_nirbeam(1), ssib_nirdiff(1), rvisbeamc(1), rvisdiffc(1), rnirbeamc(1), rnirdiffc(1), rswtoanetc(1), rswtoanet(1), rswsfcnetc(1), rswsfcnet(1), asclr(1, 1), asl(1, 1), cld(1, 1), clu(1, 1), flipfice(1, 1), fliprei(1, 1), fliprel(1, 1), fliptaud(1, 1) )
 2436.                goto 30
 2436.             else if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'UKM' ) then
 2456.                call ukmo_swintf( ncols, kmax, cos2(1), s0, flippbot(1, 1), flippmid(1, 1), flipdp(1, 1), flipte(1, 1), flipqe(1, 1), flipo3(1, 1), co2val, gtg(1), imask(1), albvisdiff(1), albnirdiff(1), albvisbeam(1), albnirbeam(1), rswtoadown(1), ssib_visbeam(1), ssib_visdiff(1), ssib_nirbeam(1), ssib_nirdiff(1), rvisbeamc(1), rvisdiffc(1), rnirbeamc(1), rnirdiffc(1), rswtoanetc(1), rswtoanet(1), rswsfcnetc(1), rswsfcnet(1), asclr(1, 1), asl(1, 1), cld(1, 1), clu(1, 1), flipfice(1, 1), fliprei(1, 1), fliprel(1, 1), fliplmixr(1, 1) )
 2456.                goto 30
 2456.             else if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'NON' ) then
 2477.                $Unit_temp_O0 = nfprt
 2477.                _fwrite( _clist( 0, 0, 3, $Unit_temp_O0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'WARN:: Skipping shortwave computation at idate=', 0x800600000000L ), _iotype( idate(+:( 1, 4, 1 )), 0x2000200000000L ) ) )
 2477.    30          continue
 2489.                if ( first == 0 ) then
 2483.                   goto 40
 2489.                else if ( nfcnv0 == 0 ) then
 2489.                   goto 80
 2489.                else if ( nfin1 + -nfin0 == 0 ) then
 2489.    80             continue
 2490.                   if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'LCH' ) then
 2492.                      ipa$930 = .false.
 2492.                      call swrad( ncols, kmax, nls, ipa$930, icld, inalb, s0, cosz(1), flippbot(1, 1), flipdp(1, 1), flipte(1, 1), flipqe(1, 1), flipo3(1, 1), albvisdiff(1), albnirdiff(1), albvisbeam(1), albnirbeam(1), rswtoadown(1), rvisbeam(1), rvisdiff(1), rnirbeam(1), rnirdiff(1), rvisbeamc(1), rvisdiffc(1), rnirbeamc(1), rnirdiffc(1), rswtoanetc(1), rswtoanet(1), rswsfcnetc(1), rswsfcnet(1), asclr(1, 1), asl(1, 1), cld(1, 1), clu(1, 1), fliptaud(1, 1) )
 2492.                      goto 40
 2509.                   else if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'CRD' ) then
 2511.                      ipa$969 = .false.
 2511.                      call cliradsw( ncols, kmax, nls, ipa$969, icld, inalb, s0, cosz(1), flippbot(1, 1), flipdp(1, 1), flipte(1, 1), flipqe(1, 1), flipo3(1, 1), gps(1), imask(1), albvisdiff(1), albnirdiff(1), albvisbeam(1), albnirbeam(1), rswtoadown(1), rvisbeam(1), rvisdiff(1), rnirbeam(1), rnirdiff(1), rvisbeamc(1), rvisdiffc(1), rnirbeamc(1), rnirdiffc(1), rswtoanetc(1), rswtoanet(1), rswsfcnetc(1), rswsfcnet(1), asclr(1, 1), asl(1, 1), cld(1, 1), clu(1, 1), flipfice(1, 1), fliprei(1, 1), fliprel(1, 1), fliptaud(1, 1) )
 2511.                      goto 40
 2511.                   else if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'UKM' ) then
 2531.                      call ukmo_swintf( ncols, kmax, cosz(1), s0, flippbot(1, 1), flippmid(1, 1), flipdp(1, 1), flipte(1, 1), flipqe(1, 1), flipo3(1, 1), co2val, gtg(1), imask(1), albvisdiff(1), albnirdiff(1), albvisbeam(1), albnirbeam(1), rswtoadown(1), rvisbeam(1), rvisdiff(1), rnirbeam(1), rnirdiff(1), rvisbeamc(1), rvisdiffc(1), rnirbeamc(1), rnirdiffc(1), rswtoanetc(1), rswtoanet(1), rswsfcnetc(1), rswsfcnet(1), asclr(1, 1), asl(1, 1), cld(1, 1), clu(1, 1), flipfice(1, 1), fliprei(1, 1), fliprel(1, 1), fliplmixr(1, 1) )
 2531.                      goto 40
 2531.                   else if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'NON' ) then
 2552.                      $Unit_temp_O2 = nfprt
 2552.                      _fwrite( _clist( 0, 0, 3, $Unit_temp_O2, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'WARN:: Skipping shortwave computation at idate=', 0x800600000000L ), _iotype( idate(+:( 1, 4, 1 )), 0x2000200000000L ) ) )
 2552.                      goto 40
 2552.                   else
 2554.                      $Unit_temp_O3 = nfprt
 2554.                      _fwrite( _clist( 0, 0, 3, $Unit_temp_O3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'ERROR:: WRONG OPTION iswrad=', 0x800600000000L ), _iotype(  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )), 0x800600000000L ) ) )
 2555.                       _substr(t$668,1,4) = ' '
 2555.                      call _stop(  _substr(t$668,1,1) )
 2555.                   endif
 2555.                else
 2555.    40             continue
 2564.                   if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'LCH' ) then
 2566.                      ipa$1064 = .false.
 2566.                      call swrad( ncols, kmax, nls, ipa$1064, icld, inalb, s0x, cos1(1), flippbot(1, 1), flipdp(1, 1), flipte(1, 1), flipqe(1, 1), flipo3(1, 1), albvisdiff(1), albnirdiff(1), albvisbeam(1), albnirbeam(1), yswtoadown(1), yvisbeam(1), yvisdiff(1), ynirbeam(1), ynirdiff(1), yvisbeamc(1), yvisdiffc(1), ynirbeamc(1), ynirdiffc(1), yswtoanetc(1), yswtoanet(1), yswsfcnetc(1), yswsfcnet(1), asclr(1, 1), asl(1, 1), cld(1, 1), clu(1, 1), fliptaud(1, 1) )
 2566.                      goto 50
 2583.                   else if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'CRD' ) then
 2585.                      ipa$1103 = .false.
 2585.                      call cliradsw( ncols, kmax, nls, ipa$1103, icld, inalb, s0x, cos1(1), flippbot(1, 1), flipdp(1, 1), flipte(1, 1), flipqe(1, 1), flipo3(1, 1), gps(1), imask(1), albvisdiff(1), albnirdiff(1), albvisbeam(1), albnirbeam(1), yswtoadown(1), yvisbeam(1), yvisdiff(1), ynirbeam(1), ynirdiff(1), yvisbeamc(1), yvisdiffc(1), ynirbeamc(1), ynirdiffc(1), yswtoanetc(1), yswtoanet(1), yswsfcnetc(1), yswsfcnet(1), asclr(1, 1), asl(1, 1), cld(1, 1), clu(1, 1), flipfice(1, 1), fliprei(1, 1), fliprel(1, 1), fliptaud(1, 1) )
 2585.                      goto 50
 2585.                   else if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'UKM' ) then
 2605.                      call ukmo_swintf( ncols, kmax, cos1(1), s0x, flippbot(1, 1), flippmid(1, 1), flipdp(1, 1), flipte(1, 1), flipqe(1, 1), flipo3(1, 1), co2val, gtg(1), imask(1), albvisdiff(1), albnirdiff(1), albvisbeam(1), albnirbeam(1), yswtoadown(1), yvisbeam(1), yvisdiff(1), ynirbeam(1), ynirdiff(1), yvisbeamc(1), yvisdiffc(1), ynirbeamc(1), ynirdiffc(1), yswtoanetc(1), yswtoanet(1), yswsfcnetc(1), yswsfcnet(1), asclr(1, 1), asl(1, 1), cld(1, 1), clu(1, 1), flipfice(1, 1), fliprei(1, 1), fliprel(1, 1), fliplmixr(1, 1) )
 2605.                      goto 50
 2605.                   else if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'NON' ) then
 2626.                      $Unit_temp_O4 = nfprt
 2626.                      _fwrite( _clist( 0, 0, 3, $Unit_temp_O4, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'WARN:: Skipping shortwave computation at idate=', 0x800600000000L ), _iotype( idate(+:( 1, 4, 1 )), 0x2000200000000L ) ) )
 2626.    50                continue
 2632.                      if ( kmax > 0 ) then
 2633.                         if ( ncols > 0 ) then
 2632.                            $I_L2632_131 = 0
 2632.                            do
 2633.                               $I_L2633_107 = 0
 2633. !dir$ ivdep
 2633.                               do
 2634.                                  yswheatrate(1 + $I_L2633_107, 1 + $I_L2632_131) = asl(1 + $I_L2633_107, kmax + -$I_L2632_131)
 2635.                                  yswheatratec(1 + $I_L2633_107, 1 + $I_L2632_131) = asclr(1 + $I_L2633_107, kmax + -$I_L2632_131)
 2636.                                  $I_L2633_107 = 1 + $I_L2633_107
 2633.                                  if ( $I_L2633_107 >= ncols ) exit
 2633.                               enddo
 2637.                               $I_L2632_131 = 1 + $I_L2632_131
 2636.                               if ( $I_L2632_131 >= kmax ) exit
 2636.                            enddo
 2636.                         endif
 2636.                      endif
 2642.                      if ( abs( mod( 3.125e-2 + 2.7777777777777778e-4 * ( tod + -delt ), trint ) ) <= 6.25e-2 .orelse. first ) then
 2644.                         if (  _substr(ilwrad,1,_ltrim(  _substr(ilwrad,1,3) )) == 'HRS' ) then
 2650.                            if ( mxrdcc ) then
 2651.                               $F_A37 = kmax
 2651.                               $F_A38 = ncols
 2651.                               if ( and( -$F_A38, -$F_A37 ) < 0 ) then
 2651.                                  $I_L2651_137 = 0
 2651.                                  do
 2651.                                     $I_L2651_117 = 0
 2651. !dir$ ivdep
 2651.                                     do
 2651.                                        cld(1 + $I_L2651_117, 1 + $I_L2651_137) = max( cld(1 + $I_L2651_117, 1 + $I_L2651_137), clu(1 + $I_L2651_117, 1 + $I_L2651_137) )
 2651.                                        $I_L2651_117 = 1 + $I_L2651_117
 2651.                                        if ( $I_L2651_117 >= $F_A38 ) exit
 2651.                                     enddo
 2651.                                     $I_L2651_137 = 1 + $I_L2651_137
 2651.                                     if ( $I_L2651_137 >= $F_A37 ) exit
 2651.                                  enddo
 2651.                               endif
 2652.                               $F_A39 = kmax
 2652.                               $F_A40 = ncols
 2652.                               if ( and( -$F_A40, -$F_A39 ) < 0 ) then
 2652.                                  $I_L2652_139 = 0
 2652.                                  do
 2652.                                     $I_L2652_119 = 0
 2652. !dir$ ivdep
 2652.                                     do
 2652.                                        clu(1 + $I_L2652_119, 1 + $I_L2652_139) = 0.0
 2652.                                        $I_L2652_119 = 1 + $I_L2652_119
 2652.                                        if ( $I_L2652_119 >= $F_A40 ) exit
 2652.                                     enddo
 2652.                                     $I_L2652_139 = 1 + $I_L2652_139
 2652.                                     if ( $I_L2652_139 >= $F_A39 ) exit
 2652.                                  enddo
 2652.                               endif
 2652.                            else
 2654.                               $F_A41 = kmax
 2654.                               $F_A42 = ncols
 2654.                               if ( and( -$F_A42, -$F_A41 ) < 0 ) then
 2654.                                  $I_L2654_141 = 0
 2654.                                  do
 2654.                                     $I_L2654_121 = 0
 2654. !dir$ ivdep
 2654.                                     do
 2654.                                        clu(1 + $I_L2654_121, 1 + $I_L2654_141) = 0.0
 2654.                                        $I_L2654_121 = 1 + $I_L2654_121
 2654.                                        if ( $I_L2654_121 >= $F_A42 ) exit
 2654.                                     enddo
 2654.                                     $I_L2654_141 = 1 + $I_L2654_141
 2654.                                     if ( $I_L2654_141 >= $F_A41 ) exit
 2654.                                  enddo
 2654.                               endif
 2654.                            endif
 2657.                            ipa$1198 = .false.
 2657.                            call lwrad( ncols, kmax, nls, nlcs, ipa$1198, icld, flippbot(1, 1), flippmid(1, 1), flipte(1, 1), flipqe(1, 1), flipo3(1, 1), gtg(1), co2val, lwtoaupc(1), lwtoaup(1), asclr(1, 1), asl(1, 1), lwsfcnetc(1), lwsfcnet(1), lwsfcdownc(1), lwsfcdown(1), cld(1, 1), clu(1, 1), flipclwp(1, 1), flipfice(1, 1), fliprei(1, 1), emisd(1, 1) )
 2657.                            goto 60
 2657.                            goto 70
 2668.                         else if (  _substr(ilwrad,1,_ltrim(  _substr(ilwrad,1,3) )) == 'CRD' ) then
 2669.                            $Unit_temp_O5 = nfprt
 2669.                            _fwrite( _clist( 0, 0, 3, $Unit_temp_O5, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'ERROR:: CLIRAD_LW NOT YET IMPLEMENTED!', 0x800600000000L ) ) )
 2670.                             _substr(t$676,1,4) = ' '
 2670.                            call _stop(  _substr(t$676,1,1) )
 2670.                         else
 2671.                            if (  _substr(ilwrad,1,_ltrim(  _substr(ilwrad,1,3) )) == 'UKM' ) then
 2672.                               call ukmo_lwintf( ncols, kmax, flippbot(1, 1), flippmid(1, 1), flipdp(1, 1), flipte(1, 1), flipqe(1, 1), flipo3(1, 1), co2val, gtg(1), imask(1), lwtoaupc(1), lwtoaup(1), asclr(1, 1), asl(1, 1), lwsfcnetc(1), lwsfcnet(1), lwsfcdownc(1), lwsfcdown(1), cld(1, 1), clu(1, 1), flipfice(1, 1), fliprei(1, 1), fliprel(1, 1), fliplmixr(1, 1) )
 2672.                            endif
 2672.    60                      continue
 2689.                            if (  _substr(ilwrad,1,_ltrim(  _substr(ilwrad,1,3) )) /= 'NON' ) then
 2690.                               if ( kmax > 0 ) then
 2691.                                  if ( ncols > 0 ) then
 2690.                                     $I_L2690_133 = 0
 2690.                                     do
 2691.                                        $I_L2691_109 = 0
 2691. !dir$ ivdep
 2691.                                        do
 2692.                                           lwcoolrate(1 + $I_L2691_109, 1 + $I_L2690_133) = asl(1 + $I_L2691_109, kmax + -$I_L2690_133)
 2693.                                           lwcoolratec(1 + $I_L2691_109, 1 + $I_L2690_133) = asclr(1 + $I_L2691_109, kmax + -$I_L2690_133)
 2694.                                           $I_L2691_109 = 1 + $I_L2691_109
 2691.                                           if ( $I_L2691_109 >= ncols ) exit
 2691.                                        enddo
 2695.                                        $I_L2690_133 = 1 + $I_L2690_133
 2694.                                        if ( $I_L2690_133 >= kmax ) exit
 2694.                                     enddo
 2694.                                  endif
 2694.                               endif
 2694.                            endif
 2694.                            goto 70
 2694.                         endif
 2694.                      else
 2694.    70                   continue
 1872.                         _free( t$136 )
 1872.                      endif
 1872.                   else
 2628.                      $Unit_temp_O6 = nfprt
 2628.                      _fwrite( _clist( 0, 0, 3, $Unit_temp_O6, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'ERROR:: WRONG OPTION iswrad=', 0x800600000000L ), _iotype(  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )), 0x800600000000L ) ) )
 2629.                       _substr(t$669,1,4) = ' '
 2629.                      call _stop(  _substr(t$669,1,1) )
 2629.                   endif
 2629.                endif
 2629.             else
 2479.                $Unit_temp_O1 = nfprt
 2479.                _fwrite( _clist( 0, 0, 3, $Unit_temp_O1, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'ERROR:: WRONG OPTION iswrad=', 0x800600000000L ), _iotype(  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )), 0x800600000000L ) ) )
 2480.                 _substr(t$667,1,4) = ' '
 2480.                call _stop(  _substr(t$667,1,1) )
 2480.             endif
 2480.          endif
 2480.       endif
 2700.       return
 2700.       end
 2700.       
 2702.       
 2702.       subroutine cldgn2( covlp, gps, sigmid, grh, omg, gtmp, css, ccu, cdin, cstc, ccon, cson, mxrdcc, lcnvl, convc, convt, convb, convts, convcs, convbs, ncols, kmax, nls )
 2702.       t$26 = ncols
 2753.       t$205 = _zla( 0, ncols )
 2702.       t$27 = kmax
 2754.       t$206 = _zla( 0, kmax )
 2702.       t$207 = _zla( 0, ncols )
 2702.       t$208 = _zla( 0, ncols ) * _zla( 0, kmax )
 2780.       t$211 = 8 * _zla( 0, ncols )
 2787.       t$212 = 8 * _zla( 0, ncols )
 2787.       t$214 = 16 * _zla( 0, ncols )
 2778.       t$215 = 16 * _zla( 0, ncols )
 2778.       t$217 = 24 * _zla( 0, ncols )
 2779.       t$218 = 24 * _zla( 0, ncols )
 2779.       t$220 = 32 * _zla( 0, ncols )
 2777.       t$221 = 32 * _zla( 0, ncols )
 2777.       t$223 = 40 * _zla( 0, ncols )
 2793.       t$224 = 40 * _zla( 0, ncols )
 2793.       t$226 = 48 * _zla( 0, ncols )
 2792.       t$227 = 48 * _zla( 0, ncols )
 2792.       t$229 = 56 * _zla( 0, ncols )
 2789.       t$230 = 56 * _zla( 0, ncols )
 2789.       t$232 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 56 * _zla( 0, ncols )
 2788.       t$233 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 56 * _zla( 0, ncols )
 2788.       t$235 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 64 * _zla( 0, ncols )
 2795.       t$236 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 64 * _zla( 0, ncols )
 2795.       t$238 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 72 * _zla( 0, ncols )
 2794.       t$240 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 76 * _zla( 0, ncols )
 2782.       t$242 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 80 * _zla( 0, ncols )
 2791.       t$244 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 84 * _zla( 0, ncols )
 2785.       t$246 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 88 * _zla( 0, ncols )
 2783.       t$248 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 92 * _zla( 0, ncols )
 2784.       t$250 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 96 * _zla( 0, ncols )
 2781.       t$252 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 100 * _zla( 0, ncols )
 2790.       t$254 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 104 * _zla( 0, ncols )
 2776.       t$255 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 104 * _zla( 0, ncols )
 2776.       t$257 = 104 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 2786.       t$258 = 104 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 2786.       t$260 = _zla( 0, ncols ) * _zla( 0, kmax ) * 16 + 112 * _zla( 0, ncols )
 2702.       t$209 = int( _alloc( _zla( 0, ncols ) * _zla( 0, kmax ) * 16 + 112 * _zla( 0, ncols ) ), 8 )
 2780.       t$210 = t$209
 2787.       t$213 = t$209 + 8 * _zla( 0, ncols )
 2778.       t$216 = t$209 + 16 * _zla( 0, ncols )
 2779.       t$219 = t$209 + 24 * _zla( 0, ncols )
 2777.       t$222 = t$209 + 32 * _zla( 0, ncols )
 2793.       t$225 = t$209 + 40 * _zla( 0, ncols )
 2792.       t$228 = t$209 + 48 * _zla( 0, ncols )
 2789.       t$231 = t$209 + 56 * _zla( 0, ncols )
 2788.       t$234 = t$209 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 56 * _zla( 0, ncols )
 2795.       t$237 = t$209 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 64 * _zla( 0, ncols )
 2794.       t$239 = t$209 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 72 * _zla( 0, ncols )
 2782.       t$241 = t$209 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 76 * _zla( 0, ncols )
 2791.       t$243 = t$209 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 80 * _zla( 0, ncols )
 2785.       t$245 = t$209 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 84 * _zla( 0, ncols )
 2783.       t$247 = t$209 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 88 * _zla( 0, ncols )
 2784.       t$249 = t$209 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 92 * _zla( 0, ncols )
 2781.       t$251 = t$209 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 96 * _zla( 0, ncols )
 2790.       t$253 = t$209 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 100 * _zla( 0, ncols )
 2776.       t$256 = t$209 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 104 * _zla( 0, ncols )
 2786.       t$259 = t$209 + 104 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 2821.       if ( kmax > 0 ) then
 2822.          if ( ncols > 0 ) then
 2821.             $I_L2821_205 = 0
 2821.             if ( kmax >= 4 ) then
 2821.                $I_L2821_226 = 0
 2821. !dir$ blocking_size( 0, 0 )
 2821.                do
 2838.                   $SCA_sigmid#1_U0 = sigmid(1 + 4 * $I_L2821_226)
 2838.                   $SCA_sigmid#2_U1 = sigmid(2 + 4 * $I_L2821_226)
 2838.                   $SCA_sigmid#3_U2 = sigmid(3 + 4 * $I_L2821_226)
 2838.                   $SCA_sigmid#4_U3 = sigmid(4 + 4 * $I_L2821_226)
 2822.                   $I_L2822_180 = 0
 2822. !dir$ ivdep
 2822. !dir$ blocking_size( 0, 0 )
 2822.                   do
 2823.                      css(1 + $I_L2822_180, 1 + 4 * $I_L2821_226) = 0.0
 2824.                      ccu(1 + $I_L2822_180, 1 + 4 * $I_L2821_226) = 0.0
 2825.                      csat(1 + $I_L2822_180, 1 + 4 * $I_L2821_226) = 0.0
 2826.                      cdin(1 + $I_L2822_180, 1 + 4 * $I_L2821_226) = 0.0
 2827.                      cstc(1 + $I_L2822_180, 1 + 4 * $I_L2821_226) = 0.0
 2828.                      ccon(1 + $I_L2822_180, 1 + 4 * $I_L2821_226) = 0.0
 2829.                      cson(1 + $I_L2822_180, 1 + 4 * $I_L2821_226) = 0.0
 2839.                      pll(1 + $I_L2822_180, 1 + 4 * $I_L2821_226) = gps(1 + $I_L2822_180) * $SCA_sigmid#1_U0
 2823.                      css(1 + $I_L2822_180, 2 + 4 * $I_L2821_226) = 0.0
 2824.                      ccu(1 + $I_L2822_180, 2 + 4 * $I_L2821_226) = 0.0
 2825.                      csat(1 + $I_L2822_180, 2 + 4 * $I_L2821_226) = 0.0
 2826.                      cdin(1 + $I_L2822_180, 2 + 4 * $I_L2821_226) = 0.0
 2827.                      cstc(1 + $I_L2822_180, 2 + 4 * $I_L2821_226) = 0.0
 2828.                      ccon(1 + $I_L2822_180, 2 + 4 * $I_L2821_226) = 0.0
 2829.                      cson(1 + $I_L2822_180, 2 + 4 * $I_L2821_226) = 0.0
 2839.                      pll(1 + $I_L2822_180, 2 + 4 * $I_L2821_226) = gps(1 + $I_L2822_180) * $SCA_sigmid#2_U1
 2823.                      css(1 + $I_L2822_180, 3 + 4 * $I_L2821_226) = 0.0
 2824.                      ccu(1 + $I_L2822_180, 3 + 4 * $I_L2821_226) = 0.0
 2825.                      csat(1 + $I_L2822_180, 3 + 4 * $I_L2821_226) = 0.0
 2826.                      cdin(1 + $I_L2822_180, 3 + 4 * $I_L2821_226) = 0.0
 2827.                      cstc(1 + $I_L2822_180, 3 + 4 * $I_L2821_226) = 0.0
 2828.                      ccon(1 + $I_L2822_180, 3 + 4 * $I_L2821_226) = 0.0
 2829.                      cson(1 + $I_L2822_180, 3 + 4 * $I_L2821_226) = 0.0
 2839.                      pll(1 + $I_L2822_180, 3 + 4 * $I_L2821_226) = gps(1 + $I_L2822_180) * $SCA_sigmid#3_U2
 2823.                      css(1 + $I_L2822_180, 4 + 4 * $I_L2821_226) = 0.0
 2824.                      ccu(1 + $I_L2822_180, 4 + 4 * $I_L2821_226) = 0.0
 2825.                      csat(1 + $I_L2822_180, 4 + 4 * $I_L2821_226) = 0.0
 2826.                      cdin(1 + $I_L2822_180, 4 + 4 * $I_L2821_226) = 0.0
 2827.                      cstc(1 + $I_L2822_180, 4 + 4 * $I_L2821_226) = 0.0
 2828.                      ccon(1 + $I_L2822_180, 4 + 4 * $I_L2821_226) = 0.0
 2829.                      cson(1 + $I_L2822_180, 4 + 4 * $I_L2821_226) = 0.0
 2839.                      pll(1 + $I_L2822_180, 4 + 4 * $I_L2821_226) = gps(1 + $I_L2822_180) * $SCA_sigmid#4_U3
 2830.                      $I_L2822_180 = 1 + $I_L2822_180
 2822.                      if ( $I_L2822_180 >= ncols ) exit
 2822.                   enddo
 2831.                   $I_L2821_226 = 1 + $I_L2821_226
 2830.                   if ( $I_L2821_226 >= _rsh( kmax, 2 ) ) exit
 2830.                enddo
 2831.                $I_L2821_205 = and( 0xfffffffffffffffcUL, kmax )
 2831.             endif
 2821.             if ( $I_L2821_205 < kmax ) then
 2821.                $I_L2821_223 = 0
 2821. !dir$ blocking_size( 0, 0 )
 2821.                do
 2838.                   $SCA_sigmid_I0 = sigmid($I_L2821_205 + $I_L2821_223 + 1)
 2822.                   $I_L2822_180 = 0
 2822. !dir$ ivdep
 2822. !dir$ blocking_size( 0, 0 )
 2822.                   do
 2823.                      css(1 + $I_L2822_180, $I_L2821_205 + $I_L2821_223 + 1) = 0.0
 2824.                      ccu(1 + $I_L2822_180, $I_L2821_205 + $I_L2821_223 + 1) = 0.0
 2825.                      csat(1 + $I_L2822_180, $I_L2821_205 + $I_L2821_223 + 1) = 0.0
 2826.                      cdin(1 + $I_L2822_180, $I_L2821_205 + $I_L2821_223 + 1) = 0.0
 2827.                      cstc(1 + $I_L2822_180, $I_L2821_205 + $I_L2821_223 + 1) = 0.0
 2828.                      ccon(1 + $I_L2822_180, $I_L2821_205 + $I_L2821_223 + 1) = 0.0
 2829.                      cson(1 + $I_L2822_180, $I_L2821_205 + $I_L2821_223 + 1) = 0.0
 2839.                      pll(1 + $I_L2822_180, $I_L2821_205 + $I_L2821_223 + 1) = gps(1 + $I_L2822_180) * $SCA_sigmid_I0
 2830.                      $I_L2822_180 = 1 + $I_L2822_180
 2822.                      if ( $I_L2822_180 >= ncols ) exit
 2822.                   enddo
 2831.                   $I_L2821_223 = 1 + $I_L2821_223
 2830.                   if ( $I_L2821_223 >= kmax + -$I_L2821_205 ) exit
 2830.                enddo
 2830.             endif
 2830.          endif
 2830.       endif
 2845.       if ( ncols > 0 ) then
 2845.          $I_L2845_182 = 0
 2845. !dir$ ivdep
 2845.          do
 2846.             $conv_WR0_R0 = convc(1 + $I_L2845_182)
 2846.             conv(1 + $I_L2845_182) = $conv_WR0_R0
 2849.             cinv(1 + $I_L2845_182) = 0.0
 2851.             chigh(1 + $I_L2845_182) = 0.0
 2852.             $ktop_WR0_R3 = int( 5.0e-1 + convt(1 + $I_L2845_182) )
 2852.             ktop(1 + $I_L2845_182) = $ktop_WR0_R3
 2853.             if ( $ktop_WR0_R3 <= 0 ) then
 2845.                goto 10
 2853.             else if ( $ktop_WR0_R3 > kmax ) then
 2853.    10          continue
 2853.                $ktop_WR0_R3 = 1
 2853.                ktop(1 + $I_L2845_182) = 1
 2853.             endif
 2854.             $kbot_WR0_R4 = int( 5.0e-1 + convb(1 + $I_L2845_182) )
 2854.             kbot(1 + $I_L2845_182) = $kbot_WR0_R4
 2855.             if ( $kbot_WR0_R4 <= 0 ) then
 2853.                goto 20
 2855.             else if ( $kbot_WR0_R4 > kmax ) then
 2855.    20          continue
 2855.                $kbot_WR0_R4 = 1
 2855.                kbot(1 + $I_L2845_182) = 1
 2855.             endif
 2856.             klow(1 + $I_L2845_182) = 1
 2858.             khigh(1 + $I_L2845_182) = 1
 2859.             $convs_WR0_R5 = convcs(1 + $I_L2845_182)
 2859.             convs(1 + $I_L2845_182) = $convs_WR0_R5
 2860.             $ktops_WR0_R6 = int( 5.0e-1 + convts(1 + $I_L2845_182) )
 2860.             ktops(1 + $I_L2845_182) = $ktops_WR0_R6
 2861.             if ( $ktops_WR0_R6 <= 0 ) then
 2855.                goto 30
 2861.             else if ( $ktops_WR0_R6 > kmax ) then
 2861.    30          continue
 2861.                $ktops_WR0_R6 = 1
 2861.                ktops(1 + $I_L2845_182) = 1
 2861.             endif
 2862.             $kbots_WR0_R7 = int( 5.0e-1 + convbs(1 + $I_L2845_182) )
 2862.             kbots(1 + $I_L2845_182) = $kbots_WR0_R7
 2863.             if ( $kbots_WR0_R7 <= 0 ) then
 2861.                goto 40
 2863.             else if ( $kbots_WR0_R7 > kmax ) then
 2863.    40          continue
 2863.                $kbots_WR0_R7 = 1
 2863.                kbots(1 + $I_L2845_182) = 1
 2863.             endif
 2873.             if ( gps(1 + $I_L2845_182) * sigmid($ktop_WR0_R3) <= 400.0 ) then
 2873.                if ( $conv_WR0_R0 > 0.0 ) then
 2875.                   chigh(1 + $I_L2845_182) = ( min( 1.0, ( 2.0 * $conv_WR0_R0 ) ) )
 2876.                   khigh(1 + $I_L2845_182) = 1 + $ktop_WR0_R3
 2876.                endif
 2876.             endif
 2878.             if ( $ktop_WR0_R3 + -$kbot_WR0_R4 > 0 ) then
 2880.                $conv_WR0_R0 = 1.0 + -_exp3( log( abs( 1.0 + -$conv_WR0_R0 ) ), ( 1.0 + -$conv_WR0_R0 ), 1.0/( $ktop_WR0_R3 + -$kbot_WR0_R4 ) )
 2880.                conv(1 + $I_L2845_182) = $conv_WR0_R0
 2880.             endif
 2882.             if ( $ktops_WR0_R6 + -$kbots_WR0_R7 > 0 ) then
 2884.                $convs_WR0_R5 = 1.0 + -_exp3( log( abs( 1.0 + -$convs_WR0_R5 ) ), ( 1.0 + -$convs_WR0_R5 ), 1.0/( $ktops_WR0_R6 + -$kbots_WR0_R7 ) )
 2884.                convs(1 + $I_L2845_182) = $convs_WR0_R5
 2884.             endif
 2886.             $I_L2845_182 = 1 + $I_L2845_182
 2885.             if ( $I_L2845_182 >= ncols ) exit
 2885.          enddo
 2893.          $I_L2893_184 = 0
 2893. !dir$ ivdep
 2893.          do
 2894.             invb(1 + $I_L2893_184) = min( kmax, kmax + -nls )
 2895.             dthdpm(1 + $I_L2893_184) = 0.0
 2896.             $I_L2893_184 = 1 + $I_L2893_184
 2893.             if ( $I_L2893_184 >= ncols ) exit
 2893.          enddo
 2893.       endif
 2898.       if ( -2 + kmax >= 0 ) then
 2899.          if ( ncols > 0 ) then
 2899.             $I_L2899_221 = 0
 2899.             do
 2898.                $I_L2898_219 = 0
 2898. !dir$ blocking_size( 0, 0 )
 2898.                do
 2899.                   $I_L2899_186 = 0
 2899. !dir$ ivdep
 2899. !dir$ blocking_size( 256, 256 )
 2899.                   do
 2900.                      if ( pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 2 + $I_L2898_219) > 700.0 ) then
 2901.                         $dthdp_S10 = ( ( gtmp($I_L2899_186 + 256 * $I_L2899_221 + 1, 1 + $I_L2898_219) * _exp3( log( abs( 1000.0 * 1.0/pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 1 + $I_L2898_219) ) ), ( 1000.0 * 1.0/pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 1 + $I_L2898_219) ), 2.8573561616563808e-1 ) + -( gtmp($I_L2899_186 + 256 * $I_L2899_221 + 1, 2 + $I_L2898_219) * _exp3( log( abs( 1000.0 * 1.0/pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 2 + $I_L2898_219) ) ), ( 1000.0 * 1.0/pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 2 + $I_L2898_219) ), 2.8573561616563808e-1 ) ) ) * 1.0/( pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 1 + $I_L2898_219) + -pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 2 + $I_L2898_219) ) )
 2904.                         if ( ( ( gtmp($I_L2899_186 + 256 * $I_L2899_221 + 1, 1 + $I_L2898_219) * _exp3( log( abs( 1000.0 * 1.0/pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 1 + $I_L2898_219) ) ), ( 1000.0 * 1.0/pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 1 + $I_L2898_219) ), 2.8573561616563808e-1 ) + -( gtmp($I_L2899_186 + 256 * $I_L2899_221 + 1, 2 + $I_L2898_219) * _exp3( log( abs( 1000.0 * 1.0/pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 2 + $I_L2898_219) ) ), ( 1000.0 * 1.0/pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 2 + $I_L2898_219) ), 2.8573561616563808e-1 ) ) ) * 1.0/( pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 1 + $I_L2898_219) + -pll($I_L2899_186 + 256 * $I_L2899_221 + 1, 2 + $I_L2898_219) ) ) < 0.0 ) then
 2905.                            invb($I_L2899_186 + 256 * $I_L2899_221 + 1) = min( invb($I_L2899_186 + 256 * $I_L2899_221 + 1), ( 1 + $I_L2898_219 ) )
 2906.                            if ( $dthdp_S10 < -4.0000000000000001e-2 ) then
 2907.                               if ( $dthdp_S10 < dthdpm($I_L2899_186 + 256 * $I_L2899_221 + 1) ) then
 2908.                                  dthdpm($I_L2899_186 + 256 * $I_L2899_221 + 1) = $dthdp_S10
 2909.                                  klow($I_L2899_186 + 256 * $I_L2899_221 + 1) = ( 2 + $I_L2898_219 )
 2909.                               endif
 2909.                            endif
 2909.                         endif
 2909.                      endif
 2899.                      $I_L2899_186 = 1 + $I_L2899_186
 2913.                      if ( $I_L2899_186 >= min( ncols, 256 + 256 * $I_L2899_221 ) + -256 * $I_L2899_221 ) exit
 2913.                   enddo
 2915.                   $I_L2898_219 = 1 + $I_L2898_219
 2915.                   if ( $I_L2898_219 >= -1 + kmax ) exit
 2915.                enddo
 2899.                $I_L2899_221 = 1 + $I_L2899_221
 2914.                if ( $I_L2899_221 >= 1 + max( 0, -1 + _rsh( 255 + ncols, 8 ) ) ) exit
 2914.             enddo
 2914.          endif
 2914.       endif
 2919.       if ( ncols > 0 ) then
 2919.          $I_L2919_189 = 0
 2919. !dir$ ivdep
 2919.          do
 2920.             if ( dthdpm(1 + $I_L2919_189) < -4.0000000000000001e-2 ) then
 2920.                if ( grh(1 + $I_L2919_189, invb(1 + $I_L2919_189)) > 5.9999999999999998e-1 ) then
 2921.                   $cinv_WR0_R9 = -6.6699999999999999 * ( 4.0000000000000001e-2 + dthdpm(1 + $I_L2919_189) )
 2923.                   $cinv_WR0_R9 = min( 1.0, max( 0.0, $cinv_WR0_R9 ) )
 2923.                   cinv(1 + $I_L2919_189) = $cinv_WR0_R9
 2924.                   if ( grh(1 + $I_L2919_189, invb(1 + $I_L2919_189)) < 8.0000000000000004e-1 ) then
 2925.                      $cinv_WR0_R9 = $cinv_WR0_R9 * ( 1.0 + -5.0 * ( 8.0000000000000004e-1 + -grh(1 + $I_L2919_189, invb(1 + $I_L2919_189)) ) )
 2925.                      cinv(1 + $I_L2919_189) = $cinv_WR0_R9
 2925.                   endif
 2925.                endif
 2925.             endif
 2929.             if ( conv(1 + $I_L2919_189) <= 0.0 ) then
 2930.                cdin(1 + $I_L2919_189, klow(1 + $I_L2919_189)) = cinv(1 + $I_L2919_189)
 2930.             endif
 2932.             $I_L2919_189 = 1 + $I_L2919_189
 2931.             if ( $I_L2919_189 >= ncols ) exit
 2931.          enddo
 2931.       endif
 2938.       if ( min( kmax, kmax + -nls ) + -lcnvl > 0 ) then
 2939.          if ( ncols > 0 ) then
 2938.             $I_L2938_207 = 0
 2938.             do
 2939.                $I_L2939_191 = 0
 2939. !dir$ ivdep
 2939.                do
 2943.                   $csat_WR0_R10 = 9.9999998509883898 * ( -9.0000000000000002e-1 + grh(1 + $I_L2939_191, lcnvl + $I_L2938_207 + 1) )
 2944.                   $csat_WR0_R10 = ( max( 0.0, $csat_WR0_R10 ) ) * ( max( 0.0, $csat_WR0_R10 ) )
 2945.                   if ( pll(1 + $I_L2939_191, lcnvl + $I_L2938_207 + 1) < 700.0 ) then
 2946.                      if ( omg(1 + $I_L2939_191, lcnvl + $I_L2938_207 + 1) >= 5.0000000000000002e-5 ) then
 2947.                         $csat_WR0_R10 = 0.0
 2948.                      else if ( omg(1 + $I_L2939_191, lcnvl + $I_L2938_207 + 1) >= -5.0000000000000002e-5 ) then
 2949.                         $delomg_WR0_R11 = 10000.0 * ( 5.0000000000000002e-5 + omg(1 + $I_L2939_191, lcnvl + $I_L2938_207 + 1) )
 2950.                         $csat_WR0_R10 = $csat_WR0_R10 * ( 1.0 + -( $delomg_WR0_R11 * $delomg_WR0_R11 ) )
 2950.                      endif
 2950.                   endif
 2954.                   $csat_WR0_R10 = min( 1.0, $csat_WR0_R10 )
 2954.                   csat(1 + $I_L2939_191, lcnvl + $I_L2938_207 + 1) = $csat_WR0_R10
 2955.                   cstc(1 + $I_L2939_191, lcnvl + $I_L2938_207 + 1) = $csat_WR0_R10
 2956.                   $I_L2939_191 = 1 + $I_L2939_191
 2953.                   if ( $I_L2939_191 >= ncols ) exit
 2953.                enddo
 2957.                $I_L2938_207 = 1 + $I_L2938_207
 2956.                if ( $I_L2938_207 >= ( min( kmax, kmax + -nls ) + -lcnvl ) ) exit
 2956.             enddo
 2956.          endif
 2956.       endif
 2958.       if ( ncols > 0 ) then
 2959.          if ( kmax > 0 ) then
 2959.             $I_L2959_209 = 0
 2959.             do
 2958.                $I_L2958_193 = 0
 2958. !dir$ ivdep
 2958.                do
 2960.                   if ( cdin(1 + $I_L2958_193, 1 + $I_L2959_209) > 0.0 ) then
 2961.                      css(1 + $I_L2958_193, kmax + -$I_L2959_209) = cdin(1 + $I_L2958_193, 1 + $I_L2959_209)
 2961.                   else
 2963.                      css(1 + $I_L2958_193, kmax + -$I_L2959_209) = csat(1 + $I_L2958_193, 1 + $I_L2959_209)
 2963.                   endif
 2966.                   $I_L2958_193 = 1 + $I_L2958_193
 2964.                   if ( $I_L2958_193 >= ncols ) exit
 2964.                enddo
 2965.                $I_L2959_209 = 1 + $I_L2959_209
 2965.                if ( $I_L2959_209 >= kmax ) exit
 2965.             enddo
 2965.          endif
 2965.       endif
 2970.       if (  _substr(covlp,1,4) == 'MAXI' ) then
 2971.          if ( ncols > 0 ) then
 2971.             $I_L2971_211 = 0
 2971.             do
 2972.                $t_S17 = kbot(1 + $I_L2971_211)
 2972.                $t_S18 = ktop(1 + $I_L2971_211)
 2972.                if ( $t_S18 + -$t_S17 >= 0 ) then
 2972.                   $SCA_conv_I1 = conv(1 + $I_L2971_211)
 2972.                   $I_L2972_195 = 0
 2972. !dir$ ivdep
 2972.                   do
 2973.                      ccu(1 + $I_L2971_211, kmax + -$t_S17 + -$I_L2972_195 + 1) = $SCA_conv_I1
 2974.                      $I_L2972_195 = 1 + $I_L2972_195
 2972.                      if ( $I_L2972_195 >= $t_S18 + -$t_S17 + 1 ) exit
 2972.                   enddo
 2972.                endif
 2975.                $I_L2971_211 = 1 + $I_L2971_211
 2974.                if ( $I_L2971_211 >= ncols ) exit
 2974.             enddo
 2974.          endif
 2979.       else if (  _substr(covlp,1,4) == 'RAND' ) then
 2981.          if ( ncols > 0 ) then
 2981.             $I_L2981_213 = 0
 2981.             do
 2982.                $t_S21 = kbots(1 + $I_L2981_213)
 2982.                $t_S22 = ktops(1 + $I_L2981_213)
 2982.                if ( $t_S22 + -$t_S21 >= 0 ) then
 2983.                   if ( conv(1 + $I_L2981_213) <= 0.0 ) then
 2982.                      $I_L2982_197 = 0
 2982. !dir$ ivdep
 2982.                      do
 2983.                         if ( cdin(1 + $I_L2981_213, $t_S21 + $I_L2982_197) >= 0.0 ) then
 2984.                            ccon(1 + $I_L2981_213, $t_S21 + $I_L2982_197) = convs(1 + $I_L2981_213)
 2985.                            cson(1 + $I_L2981_213, $t_S21 + $I_L2982_197) = convs(1 + $I_L2981_213)
 2985.                         endif
 2987.                         $I_L2982_197 = 1 + $I_L2982_197
 2986.                         if ( $I_L2982_197 >= $t_S22 + -$t_S21 + 1 ) exit
 2986.                      enddo
 2986.                   endif
 2986.                endif
 2988.                $I_L2981_213 = 1 + $I_L2981_213
 2987.                if ( $I_L2981_213 >= ncols ) exit
 2987.             enddo
 2991.             if ( kmax > 0 ) then
 2991.                $I_L2991_215 = 0
 2991. !dir$ blocking_size( 0, 0 )
 2991.                do
 2990.                   $I_L2990_199 = 0
 2990. !dir$ ivdep
 2990. !dir$ blocking_size( 0, 0 )
 2990.                   do
 2992.                      if ( ( 1 + $I_L2991_215 ) >= kbot(1 + $I_L2990_199) ) then
 2992.                         if ( ( 1 + $I_L2991_215 ) <= ktop(1 + $I_L2990_199) ) then
 2993.                            ccon(1 + $I_L2990_199, 1 + $I_L2991_215) = ccon(1 + $I_L2990_199, 1 + $I_L2991_215) + conv(1 + $I_L2990_199)
 2993.                         endif
 2993.                      endif
 2997.                      ccon(1 + $I_L2990_199, 1 + $I_L2991_215) = min( 1.0, ccon(1 + $I_L2990_199, 1 + $I_L2991_215) )
 2998.                      css(1 + $I_L2990_199, kmax + -$I_L2991_215) = min( 1.0, css(1 + $I_L2990_199, kmax + -$I_L2991_215) )
 3000.                      $I_L2990_199 = 1 + $I_L2990_199
 2996.                      if ( $I_L2990_199 >= ncols ) exit
 2996.                   enddo
 2999.                   $I_L2991_215 = 1 + $I_L2991_215
 2999.                   if ( $I_L2991_215 >= kmax ) exit
 2999.                enddo
 2999.             endif
 3002.             $I_L3002_201 = 0
 3002. !dir$ ivdep
 3002.             do
 3003.                ccon(1 + $I_L3002_201, khigh(1 + $I_L3002_201)) = ccon(1 + $I_L3002_201, khigh(1 + $I_L3002_201)) + chigh(1 + $I_L3002_201)
 3004.                $I_L3002_201 = 1 + $I_L3002_201
 3002.                if ( $I_L3002_201 >= ncols ) exit
 3002.             enddo
 3002.          endif
 3006.          if ( kmax > 0 ) then
 3007.             if ( ncols > 0 ) then
 3008.                if ( mxrdcc ) then
 3006.                   $I_L3006_217 = 0
 3006.                   do
 3007.                      $I_L3007_203 = 0
 3007. !dir$ ivdep
 3007.                      do
 3012.                         css(1 + $I_L3007_203, kmax + -$I_L3006_217) = min( 1.0, ( 1.0 + -ccon(1 + $I_L3007_203, 1 + $I_L3006_217) ) * css(1 + $I_L3007_203, kmax + -$I_L3006_217) + ccon(1 + $I_L3007_203, 1 + $I_L3006_217) )
 3014.                         $I_L3007_203 = 1 + $I_L3007_203
 3013.                         if ( $I_L3007_203 >= ncols ) exit
 3013.                      enddo
 3015.                      $I_L3006_217 = 1 + $I_L3006_217
 3014.                      if ( $I_L3006_217 >= kmax ) exit
 3014.                   enddo
 3014.                endif
 3014.             endif
 3014.          endif
 3014.       endif
 2702.       _free( t$209 )
 3018.       return
 3018.       end
 3018.       
 3025.       
 3025.       subroutine cldgen( covlp, gps, sigmid, grh, omg, gtmp, css, ccu, cdin, cstc, ccon, cson, mxrdcc, lcnvl, lthncl, convc, convt, convb, ncols, kmax, nls )
 3025.       t$28 = ncols
 3079.       t$261 = _zla( 0, ncols )
 3025.       t$29 = kmax
 3080.       t$262 = _zla( 0, kmax )
 3025.       t$263 = _zla( 0, ncols )
 3025.       t$264 = _zla( 0, ncols ) * _zla( 0, kmax )
 3109.       t$267 = 8 * _zla( 0, ncols )
 3117.       t$268 = 8 * _zla( 0, ncols )
 3117.       t$270 = 16 * _zla( 0, ncols )
 3107.       t$271 = 16 * _zla( 0, ncols )
 3107.       t$273 = 24 * _zla( 0, ncols )
 3108.       t$274 = 24 * _zla( 0, ncols )
 3108.       t$276 = 32 * _zla( 0, ncols )
 3106.       t$277 = 32 * _zla( 0, ncols )
 3106.       t$279 = 40 * _zla( 0, ncols )
 3119.       t$280 = 40 * _zla( 0, ncols )
 3119.       t$282 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 40 * _zla( 0, ncols )
 3116.       t$283 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 40 * _zla( 0, ncols )
 3116.       t$285 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 48 * _zla( 0, ncols )
 3118.       t$286 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 48 * _zla( 0, ncols )
 3118.       t$288 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 56 * _zla( 0, ncols )
 3120.       t$289 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 56 * _zla( 0, ncols )
 3120.       t$291 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 64 * _zla( 0, ncols )
 3121.       t$293 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 68 * _zla( 0, ncols )
 3111.       t$295 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 72 * _zla( 0, ncols )
 3114.       t$297 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 76 * _zla( 0, ncols )
 3112.       t$299 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 80 * _zla( 0, ncols )
 3113.       t$301 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 84 * _zla( 0, ncols )
 3110.       t$303 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 88 * _zla( 0, ncols )
 3105.       t$304 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 88 * _zla( 0, ncols )
 3105.       t$306 = 88 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 3115.       t$307 = 88 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 3115.       t$309 = _zla( 0, ncols ) * _zla( 0, kmax ) * 16 + 96 * _zla( 0, ncols )
 3025.       t$265 = int( _alloc( _zla( 0, ncols ) * _zla( 0, kmax ) * 16 + 96 * _zla( 0, ncols ) ), 8 )
 3109.       t$266 = t$265
 3117.       t$269 = t$265 + 8 * _zla( 0, ncols )
 3107.       t$272 = t$265 + 16 * _zla( 0, ncols )
 3108.       t$275 = t$265 + 24 * _zla( 0, ncols )
 3106.       t$278 = t$265 + 32 * _zla( 0, ncols )
 3119.       t$281 = t$265 + 40 * _zla( 0, ncols )
 3116.       t$284 = t$265 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 40 * _zla( 0, ncols )
 3118.       t$287 = t$265 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 48 * _zla( 0, ncols )
 3120.       t$290 = t$265 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 56 * _zla( 0, ncols )
 3121.       t$292 = t$265 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 64 * _zla( 0, ncols )
 3111.       t$294 = t$265 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 68 * _zla( 0, ncols )
 3114.       t$296 = t$265 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 72 * _zla( 0, ncols )
 3112.       t$298 = t$265 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 76 * _zla( 0, ncols )
 3113.       t$300 = t$265 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 80 * _zla( 0, ncols )
 3110.       t$302 = t$265 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 84 * _zla( 0, ncols )
 3105.       t$305 = t$265 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 88 * _zla( 0, ncols )
 3115.       t$308 = t$265 + 88 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 3144.       if ( kmax > 0 ) then
 3145.          if ( ncols > 0 ) then
 3144.             $I_L3144_173 = 0
 3144.             if ( kmax >= 4 ) then
 3144.                $I_L3144_190 = 0
 3144. !dir$ blocking_size( 0, 0 )
 3144.                do
 3161.                   $SCA_sigmid#1_U0 = sigmid(1 + 4 * $I_L3144_190)
 3161.                   $SCA_sigmid#2_U1 = sigmid(2 + 4 * $I_L3144_190)
 3161.                   $SCA_sigmid#3_U2 = sigmid(3 + 4 * $I_L3144_190)
 3161.                   $SCA_sigmid#4_U3 = sigmid(4 + 4 * $I_L3144_190)
 3145.                   $I_L3145_152 = 0
 3145. !dir$ ivdep
 3145. !dir$ blocking_size( 0, 0 )
 3145.                   do
 3146.                      css(1 + $I_L3145_152, 1 + 4 * $I_L3144_190) = 0.0
 3147.                      ccu(1 + $I_L3145_152, 1 + 4 * $I_L3144_190) = 0.0
 3149.                      cdin(1 + $I_L3145_152, 1 + 4 * $I_L3144_190) = 0.0
 3150.                      cstc(1 + $I_L3145_152, 1 + 4 * $I_L3144_190) = 0.0
 3151.                      ccon(1 + $I_L3145_152, 1 + 4 * $I_L3144_190) = 0.0
 3152.                      cson(1 + $I_L3145_152, 1 + 4 * $I_L3144_190) = 0.0
 3162.                      pll(1 + $I_L3145_152, 1 + 4 * $I_L3144_190) = gps(1 + $I_L3145_152) * $SCA_sigmid#1_U0
 3146.                      css(1 + $I_L3145_152, 2 + 4 * $I_L3144_190) = 0.0
 3147.                      ccu(1 + $I_L3145_152, 2 + 4 * $I_L3144_190) = 0.0
 3149.                      cdin(1 + $I_L3145_152, 2 + 4 * $I_L3144_190) = 0.0
 3150.                      cstc(1 + $I_L3145_152, 2 + 4 * $I_L3144_190) = 0.0
 3151.                      ccon(1 + $I_L3145_152, 2 + 4 * $I_L3144_190) = 0.0
 3152.                      cson(1 + $I_L3145_152, 2 + 4 * $I_L3144_190) = 0.0
 3162.                      pll(1 + $I_L3145_152, 2 + 4 * $I_L3144_190) = gps(1 + $I_L3145_152) * $SCA_sigmid#2_U1
 3146.                      css(1 + $I_L3145_152, 3 + 4 * $I_L3144_190) = 0.0
 3147.                      ccu(1 + $I_L3145_152, 3 + 4 * $I_L3144_190) = 0.0
 3149.                      cdin(1 + $I_L3145_152, 3 + 4 * $I_L3144_190) = 0.0
 3150.                      cstc(1 + $I_L3145_152, 3 + 4 * $I_L3144_190) = 0.0
 3151.                      ccon(1 + $I_L3145_152, 3 + 4 * $I_L3144_190) = 0.0
 3152.                      cson(1 + $I_L3145_152, 3 + 4 * $I_L3144_190) = 0.0
 3162.                      pll(1 + $I_L3145_152, 3 + 4 * $I_L3144_190) = gps(1 + $I_L3145_152) * $SCA_sigmid#3_U2
 3146.                      css(1 + $I_L3145_152, 4 + 4 * $I_L3144_190) = 0.0
 3147.                      ccu(1 + $I_L3145_152, 4 + 4 * $I_L3144_190) = 0.0
 3149.                      cdin(1 + $I_L3145_152, 4 + 4 * $I_L3144_190) = 0.0
 3150.                      cstc(1 + $I_L3145_152, 4 + 4 * $I_L3144_190) = 0.0
 3151.                      ccon(1 + $I_L3145_152, 4 + 4 * $I_L3144_190) = 0.0
 3152.                      cson(1 + $I_L3145_152, 4 + 4 * $I_L3144_190) = 0.0
 3162.                      pll(1 + $I_L3145_152, 4 + 4 * $I_L3144_190) = gps(1 + $I_L3145_152) * $SCA_sigmid#4_U3
 3153.                      $I_L3145_152 = 1 + $I_L3145_152
 3145.                      if ( $I_L3145_152 >= ncols ) exit
 3145.                   enddo
 3154.                   $I_L3144_190 = 1 + $I_L3144_190
 3153.                   if ( $I_L3144_190 >= _rsh( kmax, 2 ) ) exit
 3153.                enddo
 3154.                $I_L3144_173 = and( 0xfffffffffffffffcUL, kmax )
 3154.             endif
 3144.             if ( $I_L3144_173 < kmax ) then
 3144.                $I_L3144_187 = 0
 3144. !dir$ blocking_size( 0, 0 )
 3144.                do
 3161.                   $SCA_sigmid_I0 = sigmid($I_L3144_173 + $I_L3144_187 + 1)
 3145.                   $I_L3145_152 = 0
 3145. !dir$ ivdep
 3145. !dir$ blocking_size( 0, 0 )
 3145.                   do
 3146.                      css(1 + $I_L3145_152, $I_L3144_173 + $I_L3144_187 + 1) = 0.0
 3147.                      ccu(1 + $I_L3145_152, $I_L3144_173 + $I_L3144_187 + 1) = 0.0
 3149.                      cdin(1 + $I_L3145_152, $I_L3144_173 + $I_L3144_187 + 1) = 0.0
 3150.                      cstc(1 + $I_L3145_152, $I_L3144_173 + $I_L3144_187 + 1) = 0.0
 3151.                      ccon(1 + $I_L3145_152, $I_L3144_173 + $I_L3144_187 + 1) = 0.0
 3152.                      cson(1 + $I_L3145_152, $I_L3144_173 + $I_L3144_187 + 1) = 0.0
 3162.                      pll(1 + $I_L3145_152, $I_L3144_173 + $I_L3144_187 + 1) = gps(1 + $I_L3145_152) * $SCA_sigmid_I0
 3153.                      $I_L3145_152 = 1 + $I_L3145_152
 3145.                      if ( $I_L3145_152 >= ncols ) exit
 3145.                   enddo
 3154.                   $I_L3144_187 = 1 + $I_L3144_187
 3153.                   if ( $I_L3144_187 >= kmax + -$I_L3144_173 ) exit
 3153.                enddo
 3153.             endif
 3153.          endif
 3153.       endif
 3168.       if ( ncols > 0 ) then
 3168.          $I_L3168_154 = 0
 3168. !dir$ ivdep
 3168.          do
 3169.             $conv_WR0_R0 = convc(1 + $I_L3168_154)
 3169.             conv(1 + $I_L3168_154) = $conv_WR0_R0
 3170.             clow(1 + $I_L3168_154) = 0.0
 3171.             cinv(1 + $I_L3168_154) = 0.0
 3172.             cmid(1 + $I_L3168_154) = 0.0
 3173.             chigh(1 + $I_L3168_154) = 0.0
 3174.             $ktop_WR0_R2 = int( 5.0e-1 + convt(1 + $I_L3168_154) )
 3174.             ktop(1 + $I_L3168_154) = $ktop_WR0_R2
 3175.             if ( $ktop_WR0_R2 <= 0 ) then
 3168.                goto 10
 3175.             else if ( $ktop_WR0_R2 > kmax ) then
 3175.    10          continue
 3175.                $ktop_WR0_R2 = 1
 3175.                ktop(1 + $I_L3168_154) = 1
 3175.             endif
 3176.             $kbot_WR0_R3 = int( 5.0e-1 + convb(1 + $I_L3168_154) )
 3176.             kbot(1 + $I_L3168_154) = $kbot_WR0_R3
 3177.             if ( $kbot_WR0_R3 <= 0 ) then
 3175.                goto 20
 3177.             else if ( $kbot_WR0_R3 > kmax ) then
 3177.    20          continue
 3177.                kbot(1 + $I_L3168_154) = 1
 3177.             endif
 3178.             klow(1 + $I_L3168_154) = 1
 3179.             kmid(1 + $I_L3168_154) = 1
 3180.             khigh(1 + $I_L3168_154) = 1
 3191.             if ( gps(1 + $I_L3168_154) * sigmid($ktop_WR0_R2) <= 400.0 ) then
 3191.                if ( $conv_WR0_R0 >= 4.0000000000000002e-1 ) then
 3194.                   chigh(1 + $I_L3168_154) = ( min( 1.0, ( 2.0 * ( -2.9999999999999999e-1 + $conv_WR0_R0 ) ) ) )
 3195.                   khigh(1 + $I_L3168_154) = 1 + $ktop_WR0_R2
 3196.                   ccon(1 + $I_L3168_154, 1 + $ktop_WR0_R2) = ( min( 1.0, ( 2.0 * ( -2.9999999999999999e-1 + $conv_WR0_R0 ) ) ) )
 3196.                endif
 3196.             endif
 3198.             $I_L3168_154 = 1 + $I_L3168_154
 3197.             if ( $I_L3168_154 >= ncols ) exit
 3197.          enddo
 3205.          $I_L3205_156 = 0
 3205. !dir$ ivdep
 3205.          do
 3206.             invb(1 + $I_L3205_156) = min( kmax, kmax + -nls )
 3207.             dthdpm(1 + $I_L3205_156) = 0.0
 3208.             $I_L3205_156 = 1 + $I_L3205_156
 3205.             if ( $I_L3205_156 >= ncols ) exit
 3205.          enddo
 3205.       endif
 3210.       if ( -2 + kmax >= 0 ) then
 3211.          if ( ncols > 0 ) then
 3211.             $I_L3211_185 = 0
 3211.             do
 3210.                $I_L3210_183 = 0
 3210. !dir$ blocking_size( 0, 0 )
 3210.                do
 3211.                   $I_L3211_158 = 0
 3211. !dir$ ivdep
 3211. !dir$ blocking_size( 256, 256 )
 3211.                   do
 3212.                      if ( pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 2 + $I_L3210_183) > 700.0 ) then
 3213.                         $dthdp_S8 = ( ( gtmp($I_L3211_158 + 256 * $I_L3211_185 + 1, 1 + $I_L3210_183) * _exp3( log( abs( 1000.0 * 1.0/pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 1 + $I_L3210_183) ) ), ( 1000.0 * 1.0/pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 1 + $I_L3210_183) ), 2.8573561616563808e-1 ) + -( gtmp($I_L3211_158 + 256 * $I_L3211_185 + 1, 2 + $I_L3210_183) * _exp3( log( abs( 1000.0 * 1.0/pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 2 + $I_L3210_183) ) ), ( 1000.0 * 1.0/pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 2 + $I_L3210_183) ), 2.8573561616563808e-1 ) ) ) * 1.0/( pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 1 + $I_L3210_183) + -pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 2 + $I_L3210_183) ) )
 3216.                         if ( ( ( gtmp($I_L3211_158 + 256 * $I_L3211_185 + 1, 1 + $I_L3210_183) * _exp3( log( abs( 1000.0 * 1.0/pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 1 + $I_L3210_183) ) ), ( 1000.0 * 1.0/pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 1 + $I_L3210_183) ), 2.8573561616563808e-1 ) + -( gtmp($I_L3211_158 + 256 * $I_L3211_185 + 1, 2 + $I_L3210_183) * _exp3( log( abs( 1000.0 * 1.0/pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 2 + $I_L3210_183) ) ), ( 1000.0 * 1.0/pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 2 + $I_L3210_183) ), 2.8573561616563808e-1 ) ) ) * 1.0/( pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 1 + $I_L3210_183) + -pll($I_L3211_158 + 256 * $I_L3211_185 + 1, 2 + $I_L3210_183) ) ) < 0.0 ) then
 3217.                            invb($I_L3211_158 + 256 * $I_L3211_185 + 1) = min( invb($I_L3211_158 + 256 * $I_L3211_185 + 1), ( 1 + $I_L3210_183 ) )
 3218.                            if ( $dthdp_S8 < -4.0000000000000001e-2 ) then
 3219.                               if ( $dthdp_S8 < dthdpm($I_L3211_158 + 256 * $I_L3211_185 + 1) ) then
 3220.                                  dthdpm($I_L3211_158 + 256 * $I_L3211_185 + 1) = $dthdp_S8
 3221.                                  klow($I_L3211_158 + 256 * $I_L3211_185 + 1) = ( 2 + $I_L3210_183 )
 3221.                               endif
 3221.                            endif
 3221.                         endif
 3221.                      endif
 3211.                      $I_L3211_158 = 1 + $I_L3211_158
 3225.                      if ( $I_L3211_158 >= min( ncols, 256 + 256 * $I_L3211_185 ) + -256 * $I_L3211_185 ) exit
 3225.                   enddo
 3227.                   $I_L3210_183 = 1 + $I_L3210_183
 3227.                   if ( $I_L3210_183 >= -1 + kmax ) exit
 3227.                enddo
 3211.                $I_L3211_185 = 1 + $I_L3211_185
 3226.                if ( $I_L3211_185 >= 1 + max( 0, -1 + _rsh( 255 + ncols, 8 ) ) ) exit
 3226.             enddo
 3226.          endif
 3226.       endif
 3231.       if ( ncols > 0 ) then
 3231.          $I_L3231_161 = 0
 3231. !dir$ ivdep
 3231.          do
 3232.             if ( dthdpm(1 + $I_L3231_161) < -4.0000000000000001e-2 ) then
 3232.                if ( grh(1 + $I_L3231_161, invb(1 + $I_L3231_161)) > 5.9999999999999998e-1 ) then
 3233.                   $cinv_WR0_R6 = -6.6699999999999999 * ( 4.0000000000000001e-2 + dthdpm(1 + $I_L3231_161) )
 3235.                   $cinv_WR0_R6 = min( 1.0, max( 0.0, $cinv_WR0_R6 ) )
 3235.                   cinv(1 + $I_L3231_161) = $cinv_WR0_R6
 3236.                   if ( grh(1 + $I_L3231_161, invb(1 + $I_L3231_161)) < 8.0000000000000004e-1 ) then
 3237.                      $cinv_WR0_R6 = $cinv_WR0_R6 * ( 1.0 + -5.0 * ( 8.0000000000000004e-1 + -grh(1 + $I_L3231_161, invb(1 + $I_L3231_161)) ) )
 3237.                      cinv(1 + $I_L3231_161) = $cinv_WR0_R6
 3237.                   endif
 3237.                endif
 3237.             endif
 3240.             clow(1 + $I_L3231_161) = cinv(1 + $I_L3231_161)
 3241.             cdin(1 + $I_L3231_161, klow(1 + $I_L3231_161)) = cinv(1 + $I_L3231_161)
 3242.             $I_L3231_161 = 1 + $I_L3231_161
 3239.             if ( $I_L3231_161 >= ncols ) exit
 3239.          enddo
 3239.       endif
 3248.       if ( min( kmax, kmax + -nls ) + -lcnvl > 0 ) then
 3249.          if ( ncols > 0 ) then
 3249.             $I_L3249_175 = 0
 3249.             do
 3248.                $I_L3248_163 = 0
 3248. !dir$ unroll 2
 3248.                do
 3253.                   if ( pll(1 + $I_L3249_175, lcnvl + $I_L3248_163 + 1) > 400.0 ) then
 3254.                      $SCA_cx_I1 = 5.0 * ( -8.0000000000000004e-1 + grh(1 + $I_L3249_175, lcnvl + $I_L3248_163 + 1) )
 3254.                   else
 3256.                      $SCA_cx_I1 = 10.0 * ( -9.0000000000000002e-1 + grh(1 + $I_L3249_175, lcnvl + $I_L3248_163 + 1) )
 3256.                   endif
 3259.                   $SCA_cx_I1 = min( 1.0, ( max( 0.0, $SCA_cx_I1 ) ) * ( max( 0.0, $SCA_cx_I1 ) ) )
 3263.                   if ( pll(1 + $I_L3249_175, lcnvl + $I_L3248_163 + 1) > 700.0 ) then
 3272.                      if ( omg(1 + $I_L3249_175, lcnvl + $I_L3248_163 + 1) >= 5.0000000000000002e-5 ) then
 3273.                         $SCA_cx_I1 = 0.0
 3274.                      else if ( omg(1 + $I_L3249_175, lcnvl + $I_L3248_163 + 1) >= -5.0000000000000002e-5 ) then
 3275.                         delomg(1 + $I_L3249_175) = 10000.0 * ( 5.0000000000000002e-5 + omg(1 + $I_L3249_175, lcnvl + $I_L3248_163 + 1) )
 3276.                         $SCF_P9 = ( 1.0 + -( delomg(1 + $I_L3249_175) * delomg(1 + $I_L3249_175) ) )
 3276.                         $SCA_cx_I1 = $SCA_cx_I1 * $SCF_P9
 3276.                      endif
 3278.                      if ( $SCA_cx_I1 > clow(1 + $I_L3249_175) ) then
 3279.                         klow(1 + $I_L3249_175) = ( lcnvl + $I_L3248_163 + 1 )
 3280.                         clow(1 + $I_L3249_175) = $SCA_cx_I1
 3280.                      endif
 3282.                   else if ( pll(1 + $I_L3249_175, lcnvl + $I_L3248_163 + 1) > 400.0 ) then
 3289.                      if ( $SCA_cx_I1 > cmid(1 + $I_L3249_175) ) then
 3290.                         kmid(1 + $I_L3249_175) = ( lcnvl + $I_L3248_163 + 1 )
 3291.                         cmid(1 + $I_L3249_175) = $SCA_cx_I1
 3291.                      endif
 3291.                   else if ( $SCA_cx_I1 > chigh(1 + $I_L3249_175) ) then
 3301.                      khigh(1 + $I_L3249_175) = ( lcnvl + $I_L3248_163 + 1 )
 3302.                      chigh(1 + $I_L3249_175) = $SCA_cx_I1
 3302.                   endif
 3309.                   $I_L3248_163 = 1 + $I_L3248_163
 3307.                   if ( $I_L3248_163 >= ( min( kmax, kmax + -nls ) + -lcnvl ) ) exit
 3307.                enddo
 3308.                $I_L3249_175 = 1 + $I_L3249_175
 3308.                if ( $I_L3249_175 >= ncols ) exit
 3308.             enddo
 3308.          endif
 3308.       endif
 3310.       if ( ncols > 0 ) then
 3310.          $I_L3310_165 = 0
 3310. !dir$ ivdep
 3310.          do
 3311.             css(1 + $I_L3310_165, kmax + -khigh(1 + $I_L3310_165) + 1) = chigh(1 + $I_L3310_165)
 3312.             cstc(1 + $I_L3310_165, khigh(1 + $I_L3310_165)) = chigh(1 + $I_L3310_165)
 3313.             css(1 + $I_L3310_165, kmax + -kmid(1 + $I_L3310_165) + 1) = cmid(1 + $I_L3310_165)
 3314.             cstc(1 + $I_L3310_165, kmid(1 + $I_L3310_165)) = cmid(1 + $I_L3310_165)
 3319.             if ( klow(1 + $I_L3310_165) >= lcnvl ) then
 3320.                $thklow_S13 = 5.0e-1 * ( pll(1 + $I_L3310_165, -1 + klow(1 + $I_L3310_165)) + -pll(1 + $I_L3310_165, 1 + klow(1 + $I_L3310_165)) )
 3321.                if ( $thklow_S13 <= lthncl ) then
 3322.                   css(1 + $I_L3310_165, kmax + -klow(1 + $I_L3310_165)) = clow(1 + $I_L3310_165)
 3323.                   cstc(1 + $I_L3310_165, 1 + klow(1 + $I_L3310_165)) = clow(1 + $I_L3310_165)
 3323.                endif
 3325.                css(1 + $I_L3310_165, kmax + -klow(1 + $I_L3310_165) + 1) = clow(1 + $I_L3310_165)
 3326.                cstc(1 + $I_L3310_165, klow(1 + $I_L3310_165)) = clow(1 + $I_L3310_165)
 3326.             endif
 3328.             $I_L3310_165 = 1 + $I_L3310_165
 3327.             if ( $I_L3310_165 >= ncols ) exit
 3327.          enddo
 3327.       endif
 3332.       if (  _substr(covlp,1,4) == 'MAXI' ) then
 3333.          if ( ncols > 0 ) then
 3333.             $I_L3333_177 = 0
 3333.             do
 3334.                $t_S15 = kbot(1 + $I_L3333_177)
 3334.                $t_S16 = ktop(1 + $I_L3333_177)
 3334.                if ( $t_S16 + -$t_S15 >= 0 ) then
 3334.                   $SCA_conv_I2 = conv(1 + $I_L3333_177)
 3334.                   $I_L3334_167 = 0
 3334. !dir$ ivdep
 3334.                   do
 3335.                      ccu(1 + $I_L3333_177, kmax + -$t_S15 + -$I_L3334_167 + 1) = $SCA_conv_I2
 3336.                      $I_L3334_167 = 1 + $I_L3334_167
 3334.                      if ( $I_L3334_167 >= $t_S16 + -$t_S15 + 1 ) exit
 3334.                   enddo
 3334.                endif
 3337.                $I_L3333_177 = 1 + $I_L3333_177
 3336.                if ( $I_L3333_177 >= ncols ) exit
 3336.             enddo
 3336.          endif
 3341.       else if (  _substr(covlp,1,4) == 'RAND' ) then
 3342.          if ( ncols > 0 ) then
 3345.             if ( mxrdcc ) then
 3342.                $I_L3342_179 = 0
 3342.                do
 3343.                   $t_S19 = kbot(1 + $I_L3342_179)
 3343.                   $t_S20 = ktop(1 + $I_L3342_179)
 3343.                   if ( $t_S20 + -$t_S19 >= 0 ) then
 3343.                      $SCA_conv_I3 = conv(1 + $I_L3342_179)
 3343.                      $I_L3343_169 = 0
 3343. !dir$ ivdep
 3343.                      do
 3346.                         css(1 + $I_L3342_179, kmax + -$t_S19 + -$I_L3343_169 + 1) = max( $SCA_conv_I3, min( 1.0, css(1 + $I_L3342_179, kmax + -$t_S19 + -$I_L3343_169 + 1) ) )
 3347.                         ccon(1 + $I_L3342_179, $t_S19 + $I_L3343_169) = $SCA_conv_I3
 3349.                         $I_L3343_169 = 1 + $I_L3343_169
 3348.                         if ( $I_L3343_169 >= $t_S20 + -$t_S19 + 1 ) exit
 3348.                      enddo
 3348.                   endif
 3350.                   $I_L3342_179 = 1 + $I_L3342_179
 3349.                   if ( $I_L3342_179 >= ncols ) exit
 3349.                enddo
 3349.             else
 3342.                $I_L3342_181 = 0
 3342.                do
 3343.                   $t_S19 = kbot(1 + $I_L3342_181)
 3343.                   $t_S20 = ktop(1 + $I_L3342_181)
 3343.                   if ( $t_S20 + -$t_S19 >= 0 ) then
 3343.                      $I_L3343_171 = 0
 3343. !dir$ ivdep
 3343.                      do
 3344.                         css(1 + $I_L3342_181, kmax + -$t_S19 + -$I_L3343_171 + 1) = min( 1.0, css(1 + $I_L3342_181, kmax + -$t_S19 + -$I_L3343_171 + 1) )
 3349.                         $I_L3343_171 = 1 + $I_L3343_171
 3348.                         if ( $I_L3343_171 >= $t_S20 + -$t_S19 + 1 ) exit
 3348.                      enddo
 3348.                   endif
 3350.                   $I_L3342_181 = 1 + $I_L3342_181
 3349.                   if ( $I_L3342_181 >= ncols ) exit
 3349.                enddo
 3349.             endif
 3349.          endif
 3349.       endif
 3025.       _free( t$265 )
 3352.       return
 3352.       end
 3352.       
 3364.       
 3364.       subroutine cldgn3( gps, sigmid, grh, omg, gtmp, css, ccu, cdin, cstc, ccon, cson, lcnvl, lthncl, convc, convt, convb, ncols, kmax, nls )
 3364.       t$30 = ncols
 3416.       t$310 = _zla( 0, ncols )
 3364.       t$31 = kmax
 3417.       t$311 = _zla( 0, kmax )
 3364.       t$312 = _zla( 0, ncols )
 3364.       t$313 = _zla( 0, ncols ) * _zla( 0, kmax )
 3444.       t$316 = 8 * _zla( 0, ncols )
 3452.       t$317 = 8 * _zla( 0, ncols )
 3452.       t$319 = 16 * _zla( 0, ncols )
 3442.       t$320 = 16 * _zla( 0, ncols )
 3442.       t$322 = 24 * _zla( 0, ncols )
 3443.       t$323 = 24 * _zla( 0, ncols )
 3443.       t$325 = 32 * _zla( 0, ncols )
 3441.       t$326 = 32 * _zla( 0, ncols )
 3441.       t$328 = 40 * _zla( 0, ncols )
 3454.       t$329 = 40 * _zla( 0, ncols )
 3454.       t$331 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 40 * _zla( 0, ncols )
 3451.       t$332 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 40 * _zla( 0, ncols )
 3451.       t$334 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 48 * _zla( 0, ncols )
 3453.       t$335 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 48 * _zla( 0, ncols )
 3453.       t$337 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 56 * _zla( 0, ncols )
 3455.       t$338 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 56 * _zla( 0, ncols )
 3455.       t$340 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 64 * _zla( 0, ncols )
 3456.       t$342 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 68 * _zla( 0, ncols )
 3446.       t$344 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 72 * _zla( 0, ncols )
 3449.       t$346 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 76 * _zla( 0, ncols )
 3447.       t$348 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 80 * _zla( 0, ncols )
 3448.       t$350 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 84 * _zla( 0, ncols )
 3445.       t$352 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 88 * _zla( 0, ncols )
 3440.       t$353 = _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 88 * _zla( 0, ncols )
 3440.       t$355 = 88 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 3450.       t$356 = 88 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 3450.       t$358 = _zla( 0, ncols ) * _zla( 0, kmax ) * 16 + 96 * _zla( 0, ncols )
 3364.       t$314 = int( _alloc( _zla( 0, ncols ) * _zla( 0, kmax ) * 16 + 96 * _zla( 0, ncols ) ), 8 )
 3444.       t$315 = t$314
 3452.       t$318 = t$314 + 8 * _zla( 0, ncols )
 3442.       t$321 = t$314 + 16 * _zla( 0, ncols )
 3443.       t$324 = t$314 + 24 * _zla( 0, ncols )
 3441.       t$327 = t$314 + 32 * _zla( 0, ncols )
 3454.       t$330 = t$314 + 40 * _zla( 0, ncols )
 3451.       t$333 = t$314 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 40 * _zla( 0, ncols )
 3453.       t$336 = t$314 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 48 * _zla( 0, ncols )
 3455.       t$339 = t$314 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 56 * _zla( 0, ncols )
 3456.       t$341 = t$314 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 64 * _zla( 0, ncols )
 3446.       t$343 = t$314 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 68 * _zla( 0, ncols )
 3449.       t$345 = t$314 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 72 * _zla( 0, ncols )
 3447.       t$347 = t$314 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 76 * _zla( 0, ncols )
 3448.       t$349 = t$314 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 80 * _zla( 0, ncols )
 3445.       t$351 = t$314 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 84 * _zla( 0, ncols )
 3440.       t$354 = t$314 + _zla( 0, ncols ) * _zla( 0, kmax ) * 8 + 88 * _zla( 0, ncols )
 3450.       t$357 = t$314 + 88 * _zla( 0, ncols ) + _zla( 0, ncols ) * _zla( 0, kmax ) * 16
 3479.       if ( kmax > 0 ) then
 3480.          if ( ncols > 0 ) then
 3479.             $I_L3479_137 = 0
 3479.             if ( kmax >= 4 ) then
 3479.                $I_L3479_150 = 0
 3479. !dir$ blocking_size( 0, 0 )
 3479.                do
 3496.                   $SCA_sigmid#1_U0 = sigmid(1 + 4 * $I_L3479_150)
 3496.                   $SCA_sigmid#2_U1 = sigmid(2 + 4 * $I_L3479_150)
 3496.                   $SCA_sigmid#3_U2 = sigmid(3 + 4 * $I_L3479_150)
 3496.                   $SCA_sigmid#4_U3 = sigmid(4 + 4 * $I_L3479_150)
 3480.                   $I_L3480_120 = 0
 3480. !dir$ ivdep
 3480. !dir$ blocking_size( 0, 0 )
 3480.                   do
 3481.                      css(1 + $I_L3480_120, 1 + 4 * $I_L3479_150) = 0.0
 3482.                      ccu(1 + $I_L3480_120, 1 + 4 * $I_L3479_150) = 0.0
 3484.                      cdin(1 + $I_L3480_120, 1 + 4 * $I_L3479_150) = 0.0
 3485.                      cstc(1 + $I_L3480_120, 1 + 4 * $I_L3479_150) = 0.0
 3486.                      ccon(1 + $I_L3480_120, 1 + 4 * $I_L3479_150) = 0.0
 3487.                      cson(1 + $I_L3480_120, 1 + 4 * $I_L3479_150) = 0.0
 3497.                      pll(1 + $I_L3480_120, 1 + 4 * $I_L3479_150) = gps(1 + $I_L3480_120) * $SCA_sigmid#1_U0
 3481.                      css(1 + $I_L3480_120, 2 + 4 * $I_L3479_150) = 0.0
 3482.                      ccu(1 + $I_L3480_120, 2 + 4 * $I_L3479_150) = 0.0
 3484.                      cdin(1 + $I_L3480_120, 2 + 4 * $I_L3479_150) = 0.0
 3485.                      cstc(1 + $I_L3480_120, 2 + 4 * $I_L3479_150) = 0.0
 3486.                      ccon(1 + $I_L3480_120, 2 + 4 * $I_L3479_150) = 0.0
 3487.                      cson(1 + $I_L3480_120, 2 + 4 * $I_L3479_150) = 0.0
 3497.                      pll(1 + $I_L3480_120, 2 + 4 * $I_L3479_150) = gps(1 + $I_L3480_120) * $SCA_sigmid#2_U1
 3481.                      css(1 + $I_L3480_120, 3 + 4 * $I_L3479_150) = 0.0
 3482.                      ccu(1 + $I_L3480_120, 3 + 4 * $I_L3479_150) = 0.0
 3484.                      cdin(1 + $I_L3480_120, 3 + 4 * $I_L3479_150) = 0.0
 3485.                      cstc(1 + $I_L3480_120, 3 + 4 * $I_L3479_150) = 0.0
 3486.                      ccon(1 + $I_L3480_120, 3 + 4 * $I_L3479_150) = 0.0
 3487.                      cson(1 + $I_L3480_120, 3 + 4 * $I_L3479_150) = 0.0
 3497.                      pll(1 + $I_L3480_120, 3 + 4 * $I_L3479_150) = gps(1 + $I_L3480_120) * $SCA_sigmid#3_U2
 3481.                      css(1 + $I_L3480_120, 4 + 4 * $I_L3479_150) = 0.0
 3482.                      ccu(1 + $I_L3480_120, 4 + 4 * $I_L3479_150) = 0.0
 3484.                      cdin(1 + $I_L3480_120, 4 + 4 * $I_L3479_150) = 0.0
 3485.                      cstc(1 + $I_L3480_120, 4 + 4 * $I_L3479_150) = 0.0
 3486.                      ccon(1 + $I_L3480_120, 4 + 4 * $I_L3479_150) = 0.0
 3487.                      cson(1 + $I_L3480_120, 4 + 4 * $I_L3479_150) = 0.0
 3497.                      pll(1 + $I_L3480_120, 4 + 4 * $I_L3479_150) = gps(1 + $I_L3480_120) * $SCA_sigmid#4_U3
 3488.                      $I_L3480_120 = 1 + $I_L3480_120
 3480.                      if ( $I_L3480_120 >= ncols ) exit
 3480.                   enddo
 3489.                   $I_L3479_150 = 1 + $I_L3479_150
 3488.                   if ( $I_L3479_150 >= _rsh( kmax, 2 ) ) exit
 3488.                enddo
 3489.                $I_L3479_137 = and( 0xfffffffffffffffcUL, kmax )
 3489.             endif
 3479.             if ( $I_L3479_137 < kmax ) then
 3479.                $I_L3479_147 = 0
 3479. !dir$ blocking_size( 0, 0 )
 3479.                do
 3496.                   $SCA_sigmid_I0 = sigmid($I_L3479_137 + $I_L3479_147 + 1)
 3480.                   $I_L3480_120 = 0
 3480. !dir$ ivdep
 3480. !dir$ blocking_size( 0, 0 )
 3480.                   do
 3481.                      css(1 + $I_L3480_120, $I_L3479_137 + $I_L3479_147 + 1) = 0.0
 3482.                      ccu(1 + $I_L3480_120, $I_L3479_137 + $I_L3479_147 + 1) = 0.0
 3484.                      cdin(1 + $I_L3480_120, $I_L3479_137 + $I_L3479_147 + 1) = 0.0
 3485.                      cstc(1 + $I_L3480_120, $I_L3479_137 + $I_L3479_147 + 1) = 0.0
 3486.                      ccon(1 + $I_L3480_120, $I_L3479_137 + $I_L3479_147 + 1) = 0.0
 3487.                      cson(1 + $I_L3480_120, $I_L3479_137 + $I_L3479_147 + 1) = 0.0
 3497.                      pll(1 + $I_L3480_120, $I_L3479_137 + $I_L3479_147 + 1) = gps(1 + $I_L3480_120) * $SCA_sigmid_I0
 3488.                      $I_L3480_120 = 1 + $I_L3480_120
 3480.                      if ( $I_L3480_120 >= ncols ) exit
 3480.                   enddo
 3489.                   $I_L3479_147 = 1 + $I_L3479_147
 3488.                   if ( $I_L3479_147 >= kmax + -$I_L3479_137 ) exit
 3488.                enddo
 3488.             endif
 3488.          endif
 3488.       endif
 3503.       if ( ncols > 0 ) then
 3503.          $I_L3503_122 = 0
 3503. !dir$ ivdep
 3503.          do
 3504.             $conv_WR0_R0 = convc(1 + $I_L3503_122)
 3504.             conv(1 + $I_L3503_122) = $conv_WR0_R0
 3505.             clow(1 + $I_L3503_122) = 0.0
 3506.             cinv(1 + $I_L3503_122) = 0.0
 3507.             cmid(1 + $I_L3503_122) = 0.0
 3508.             chigh(1 + $I_L3503_122) = 0.0
 3509.             $ktop_WR0_R2 = int( 5.0e-1 + convt(1 + $I_L3503_122) )
 3509.             ktop(1 + $I_L3503_122) = $ktop_WR0_R2
 3510.             if ( $ktop_WR0_R2 <= 0 ) then
 3503.                goto 10
 3510.             else if ( $ktop_WR0_R2 > kmax ) then
 3510.    10          continue
 3510.                $ktop_WR0_R2 = 1
 3510.                ktop(1 + $I_L3503_122) = 1
 3510.             endif
 3511.             $kbot_WR0_R3 = int( 5.0e-1 + convb(1 + $I_L3503_122) )
 3511.             kbot(1 + $I_L3503_122) = $kbot_WR0_R3
 3512.             if ( $kbot_WR0_R3 <= 0 ) then
 3510.                goto 20
 3512.             else if ( $kbot_WR0_R3 > kmax ) then
 3512.    20          continue
 3512.                kbot(1 + $I_L3503_122) = 1
 3512.             endif
 3513.             klow(1 + $I_L3503_122) = 1
 3514.             kmid(1 + $I_L3503_122) = 1
 3515.             khigh(1 + $I_L3503_122) = 1
 3526.             if ( gps(1 + $I_L3503_122) * sigmid($ktop_WR0_R2) <= 400.0 ) then
 3526.                if ( $conv_WR0_R0 >= 4.0000000000000002e-1 ) then
 3529.                   chigh(1 + $I_L3503_122) = ( min( 1.0, ( 2.0 * ( -2.9999999999999999e-1 + $conv_WR0_R0 ) ) ) )
 3530.                   khigh(1 + $I_L3503_122) = 1 + $ktop_WR0_R2
 3531.                   ccon(1 + $I_L3503_122, 1 + $ktop_WR0_R2) = ( min( 1.0, ( 2.0 * ( -2.9999999999999999e-1 + $conv_WR0_R0 ) ) ) )
 3531.                endif
 3531.             endif
 3533.             $I_L3503_122 = 1 + $I_L3503_122
 3532.             if ( $I_L3503_122 >= ncols ) exit
 3532.          enddo
 3540.          $I_L3540_124 = 0
 3540. !dir$ ivdep
 3540.          do
 3541.             invb(1 + $I_L3540_124) = min( kmax, kmax + -nls )
 3542.             dthdpm(1 + $I_L3540_124) = 0.0
 3543.             $I_L3540_124 = 1 + $I_L3540_124
 3540.             if ( $I_L3540_124 >= ncols ) exit
 3540.          enddo
 3540.       endif
 3545.       if ( -2 + kmax >= 0 ) then
 3546.          if ( ncols > 0 ) then
 3546.             $I_L3546_145 = 0
 3546.             do
 3545.                $I_L3545_143 = 0
 3545. !dir$ blocking_size( 0, 0 )
 3545.                do
 3546.                   $I_L3546_126 = 0
 3546. !dir$ ivdep
 3546. !dir$ blocking_size( 256, 256 )
 3546.                   do
 3547.                      if ( pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 2 + $I_L3545_143) > 700.0 ) then
 3548.                         $dthdp_S8 = ( ( gtmp($I_L3546_126 + 256 * $I_L3546_145 + 1, 1 + $I_L3545_143) * _exp3( log( abs( 1000.0 * 1.0/pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 1 + $I_L3545_143) ) ), ( 1000.0 * 1.0/pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 1 + $I_L3545_143) ), 2.8573561616563808e-1 ) + -( gtmp($I_L3546_126 + 256 * $I_L3546_145 + 1, 2 + $I_L3545_143) * _exp3( log( abs( 1000.0 * 1.0/pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 2 + $I_L3545_143) ) ), ( 1000.0 * 1.0/pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 2 + $I_L3545_143) ), 2.8573561616563808e-1 ) ) ) * 1.0/( pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 1 + $I_L3545_143) + -pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 2 + $I_L3545_143) ) )
 3551.                         if ( ( ( gtmp($I_L3546_126 + 256 * $I_L3546_145 + 1, 1 + $I_L3545_143) * _exp3( log( abs( 1000.0 * 1.0/pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 1 + $I_L3545_143) ) ), ( 1000.0 * 1.0/pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 1 + $I_L3545_143) ), 2.8573561616563808e-1 ) + -( gtmp($I_L3546_126 + 256 * $I_L3546_145 + 1, 2 + $I_L3545_143) * _exp3( log( abs( 1000.0 * 1.0/pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 2 + $I_L3545_143) ) ), ( 1000.0 * 1.0/pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 2 + $I_L3545_143) ), 2.8573561616563808e-1 ) ) ) * 1.0/( pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 1 + $I_L3545_143) + -pll($I_L3546_126 + 256 * $I_L3546_145 + 1, 2 + $I_L3545_143) ) ) < 0.0 ) then
 3552.                            invb($I_L3546_126 + 256 * $I_L3546_145 + 1) = min( invb($I_L3546_126 + 256 * $I_L3546_145 + 1), ( 1 + $I_L3545_143 ) )
 3553.                            if ( $dthdp_S8 < -4.0000000000000001e-2 ) then
 3554.                               if ( $dthdp_S8 < dthdpm($I_L3546_126 + 256 * $I_L3546_145 + 1) ) then
 3555.                                  dthdpm($I_L3546_126 + 256 * $I_L3546_145 + 1) = $dthdp_S8
 3556.                                  klow($I_L3546_126 + 256 * $I_L3546_145 + 1) = ( 2 + $I_L3545_143 )
 3556.                               endif
 3556.                            endif
 3556.                         endif
 3556.                      endif
 3546.                      $I_L3546_126 = 1 + $I_L3546_126
 3560.                      if ( $I_L3546_126 >= min( ncols, 256 + 256 * $I_L3546_145 ) + -256 * $I_L3546_145 ) exit
 3560.                   enddo
 3562.                   $I_L3545_143 = 1 + $I_L3545_143
 3562.                   if ( $I_L3545_143 >= -1 + kmax ) exit
 3562.                enddo
 3546.                $I_L3546_145 = 1 + $I_L3546_145
 3561.                if ( $I_L3546_145 >= 1 + max( 0, -1 + _rsh( 255 + ncols, 8 ) ) ) exit
 3561.             enddo
 3561.          endif
 3561.       endif
 3566.       if ( ncols > 0 ) then
 3566.          $I_L3566_129 = 0
 3566. !dir$ ivdep
 3566.          do
 3567.             if ( dthdpm(1 + $I_L3566_129) < -4.0000000000000001e-2 ) then
 3567.                if ( grh(1 + $I_L3566_129, invb(1 + $I_L3566_129)) > 5.9999999999999998e-1 ) then
 3568.                   $cinv_WR0_R6 = -6.6699999999999999 * ( 4.0000000000000001e-2 + dthdpm(1 + $I_L3566_129) )
 3570.                   $cinv_WR0_R6 = min( 1.0, max( 0.0, $cinv_WR0_R6 ) )
 3570.                   cinv(1 + $I_L3566_129) = $cinv_WR0_R6
 3571.                   if ( grh(1 + $I_L3566_129, invb(1 + $I_L3566_129)) < 8.0000000000000004e-1 ) then
 3572.                      $cinv_WR0_R6 = $cinv_WR0_R6 * ( 1.0 + -5.0 * ( 8.0000000000000004e-1 + -grh(1 + $I_L3566_129, invb(1 + $I_L3566_129)) ) )
 3572.                      cinv(1 + $I_L3566_129) = $cinv_WR0_R6
 3572.                   endif
 3572.                endif
 3572.             endif
 3575.             clow(1 + $I_L3566_129) = cinv(1 + $I_L3566_129)
 3576.             cdin(1 + $I_L3566_129, klow(1 + $I_L3566_129)) = cinv(1 + $I_L3566_129)
 3577.             $I_L3566_129 = 1 + $I_L3566_129
 3574.             if ( $I_L3566_129 >= ncols ) exit
 3574.          enddo
 3574.       endif
 3583.       if ( min( kmax, kmax + -nls ) + -lcnvl > 0 ) then
 3584.          if ( ncols > 0 ) then
 3584.             $I_L3584_139 = 0
 3584.             do
 3583.                $I_L3583_131 = 0
 3583. !dir$ unroll 2
 3583.                do
 3588.                   if ( pll(1 + $I_L3584_139, lcnvl + $I_L3583_131 + 1) > 400.0 ) then
 3589.                      $SCA_cx_I1 = 5.0 * ( -8.0000000000000004e-1 + grh(1 + $I_L3584_139, lcnvl + $I_L3583_131 + 1) )
 3589.                   else
 3591.                      $SCA_cx_I1 = 10.0 * ( -9.0000000000000002e-1 + grh(1 + $I_L3584_139, lcnvl + $I_L3583_131 + 1) )
 3591.                   endif
 3594.                   $SCA_cx_I1 = min( 1.0, ( max( 0.0, $SCA_cx_I1 ) ) * ( max( 0.0, $SCA_cx_I1 ) ) )
 3598.                   if ( pll(1 + $I_L3584_139, lcnvl + $I_L3583_131 + 1) > 700.0 ) then
 3607.                      if ( omg(1 + $I_L3584_139, lcnvl + $I_L3583_131 + 1) >= 5.0000000000000002e-5 ) then
 3608.                         $SCA_cx_I1 = 0.0
 3609.                      else if ( omg(1 + $I_L3584_139, lcnvl + $I_L3583_131 + 1) >= -5.0000000000000002e-5 ) then
 3610.                         delomg(1 + $I_L3584_139) = 10000.0 * ( 5.0000000000000002e-5 + omg(1 + $I_L3584_139, lcnvl + $I_L3583_131 + 1) )
 3611.                         $SCF_P9 = ( 1.0 + -( delomg(1 + $I_L3584_139) * delomg(1 + $I_L3584_139) ) )
 3611.                         $SCA_cx_I1 = $SCA_cx_I1 * $SCF_P9
 3611.                      endif
 3613.                      if ( $SCA_cx_I1 > clow(1 + $I_L3584_139) ) then
 3614.                         klow(1 + $I_L3584_139) = ( lcnvl + $I_L3583_131 + 1 )
 3615.                         clow(1 + $I_L3584_139) = $SCA_cx_I1
 3615.                      endif
 3617.                   else if ( pll(1 + $I_L3584_139, lcnvl + $I_L3583_131 + 1) > 400.0 ) then
 3624.                      if ( $SCA_cx_I1 > cmid(1 + $I_L3584_139) ) then
 3625.                         kmid(1 + $I_L3584_139) = ( lcnvl + $I_L3583_131 + 1 )
 3626.                         cmid(1 + $I_L3584_139) = $SCA_cx_I1
 3626.                      endif
 3626.                   else if ( $SCA_cx_I1 > chigh(1 + $I_L3584_139) ) then
 3636.                      khigh(1 + $I_L3584_139) = ( lcnvl + $I_L3583_131 + 1 )
 3637.                      chigh(1 + $I_L3584_139) = $SCA_cx_I1
 3637.                   endif
 3644.                   $I_L3583_131 = 1 + $I_L3583_131
 3642.                   if ( $I_L3583_131 >= ( min( kmax, kmax + -nls ) + -lcnvl ) ) exit
 3642.                enddo
 3643.                $I_L3584_139 = 1 + $I_L3584_139
 3643.                if ( $I_L3584_139 >= ncols ) exit
 3643.             enddo
 3643.          endif
 3643.       endif
 3645.       if ( ncols > 0 ) then
 3645.          $I_L3645_133 = 0
 3645. !dir$ ivdep
 3645.          do
 3646.             css(1 + $I_L3645_133, kmax + -khigh(1 + $I_L3645_133) + 1) = chigh(1 + $I_L3645_133)
 3647.             cstc(1 + $I_L3645_133, khigh(1 + $I_L3645_133)) = chigh(1 + $I_L3645_133)
 3648.             css(1 + $I_L3645_133, kmax + -kmid(1 + $I_L3645_133) + 1) = cmid(1 + $I_L3645_133)
 3649.             cstc(1 + $I_L3645_133, kmid(1 + $I_L3645_133)) = cmid(1 + $I_L3645_133)
 3654.             if ( klow(1 + $I_L3645_133) >= lcnvl ) then
 3655.                $thklow_S13 = 5.0e-1 * ( pll(1 + $I_L3645_133, -1 + klow(1 + $I_L3645_133)) + -pll(1 + $I_L3645_133, 1 + klow(1 + $I_L3645_133)) )
 3656.                if ( $thklow_S13 <= lthncl ) then
 3657.                   css(1 + $I_L3645_133, kmax + -klow(1 + $I_L3645_133)) = clow(1 + $I_L3645_133)
 3658.                   cstc(1 + $I_L3645_133, 1 + klow(1 + $I_L3645_133)) = clow(1 + $I_L3645_133)
 3658.                endif
 3660.                css(1 + $I_L3645_133, kmax + -klow(1 + $I_L3645_133) + 1) = clow(1 + $I_L3645_133)
 3661.                cstc(1 + $I_L3645_133, klow(1 + $I_L3645_133)) = clow(1 + $I_L3645_133)
 3661.             endif
 3663.             $I_L3645_133 = 1 + $I_L3645_133
 3662.             if ( $I_L3645_133 >= ncols ) exit
 3662.          enddo
 3701.          $I_L3701_141 = 0
 3701.          do
 3702.             $t_S15 = kbot(1 + $I_L3701_141)
 3702.             $t_S16 = ktop(1 + $I_L3701_141)
 3702.             if ( $t_S16 + -$t_S15 >= 0 ) then
 3702.                $SCA_conv_I2 = conv(1 + $I_L3701_141)
 3702.                $I_L3702_135 = 0
 3702. !dir$ ivdep
 3702.                do
 3703.                   ccu(1 + $I_L3701_141, kmax + -$t_S15 + -$I_L3702_135 + 1) = $SCA_conv_I2
 3704.                   css(1 + $I_L3701_141, kmax + -$t_S15 + -$I_L3702_135 + 1) = min( 1.0, css(1 + $I_L3701_141, kmax + -$t_S15 + -$I_L3702_135 + 1) )
 3705.                   ccon(1 + $I_L3701_141, $t_S15 + $I_L3702_135) = $SCA_conv_I2
 3706.                   $I_L3702_135 = 1 + $I_L3702_135
 3702.                   if ( $I_L3702_135 >= $t_S16 + -$t_S15 + 1 ) exit
 3702.                enddo
 3702.             endif
 3707.             $I_L3701_141 = 1 + $I_L3701_141
 3706.             if ( $I_L3701_141 >= ncols ) exit
 3706.          enddo
 3706.       endif
 3364.       _free( t$314 )
 3710.       return
 3710.       end
 3710.       
 3715.       
 3715.       subroutine getoz( ncols, kmax, sigmid, colrad, date, o3l )
 3715.       t$32 = kmax
 3741.       t$359 = _zla( 0, kmax )
 3715.       t$33 = ncols
 3742.       t$360 = _zla( 0, ncols )
 3715.       t$361 = _zla( 0, ncols )
 3715.       t$362 = _zla( 0, kmax ) * _zla( 0, ncols )
 3771.       t$365 = _zla( 0, kmax ) * _zla( 0, ncols ) * 4
 3764.       t$367 = _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 4 * _zla( 0, ncols )
 3765.       t$369 = _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols )
 3781.       t$371 = _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax )
 3715.       t$372 = 18 * _zla( 0, ncols )
 3759.       t$373 = 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 )
 3759.       t$375 = 144 * _zla( 0, ncols ) + 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 )
 3778.       t$376 = 144 * _zla( 0, ncols ) + 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 )
 3778.       t$378 = 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 ) + 152 * _zla( 0, ncols )
 3776.       t$379 = 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 ) + 152 * _zla( 0, ncols )
 3776.       t$381 = 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 ) + 160 * _zla( 0, ncols )
 3777.       t$382 = 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 ) + 160 * _zla( 0, ncols )
 3777.       t$384 = 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 ) + 168 * _zla( 0, ncols )
 3775.       t$385 = 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 ) + 168 * _zla( 0, ncols )
 3775.       t$387 = 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 ) + 176 * _zla( 0, ncols )
 3715.       t$363 = int( _alloc( 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 ) + 176 * _zla( 0, ncols ) ), 8 )
 3771.       t$364 = t$363
 3764.       t$366 = t$363 + _zla( 0, kmax ) * _zla( 0, ncols ) * 4
 3765.       t$368 = t$363 + _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 4 * _zla( 0, ncols )
 3781.       t$370 = t$363 + _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols )
 3759.       t$374 = t$363 + 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 )
 3778.       t$377 = t$363 + 144 * _zla( 0, ncols ) + 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 )
 3776.       t$380 = t$363 + 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 ) + 152 * _zla( 0, ncols )
 3777.       t$383 = t$363 + 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 ) + 160 * _zla( 0, ncols )
 3775.       t$386 = t$363 + 8 * ( ( _zla( 0, kmax ) * _zla( 0, ncols ) * 4 + 8 * _zla( 0, ncols ) + 4 * _zla( 0, kmax ) + 7 ) / 8 ) + 168 * _zla( 0, ncols )
 3787.       date = date + cvmg( 0.0, -year_getoz, date <= year_getoz )
 3793.       $isea_S0 = 1 + cvmg( int( 1.0 + ( date * 1.0/mon_getoz ) ), 1, int( 1.0 + ( date * 1.0/mon_getoz ) ) > 0 ) / 3
 3796.       if ( cvmg( $isea_S0, 1, $isea_S0 /= 5 ) > 5 ) then
 3797.          $Unit_temp_O0 = nfprt
 3797.          _fwrite( _clist( 0, 0, 3, $Unit_temp_O0, Null_Arg, Null_Arg, t$36,  _substr(t$35,1,53), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), Null_Arg )
 3798.          $Unit_temp_O1 = nferr
 3798.          _fwrite( _clist( 0, 0, 3, $Unit_temp_O1, Null_Arg, Null_Arg, t$38,  _substr(t$37,1,53), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), Null_Arg )
 3799.           _substr(t$847,1,4) = '9954'
 3799.          call _stop(  _substr(t$847,1,4) )
 3799.       else
 3801.          if ( ncols > 0 ) then
 3801.             $I_L3801_88 = 0
 3801. !dir$ ivdep
 3801.             do
 3802.                $theta_S3 = 90.0 + -57.29577951308238 * colrad(1 + $I_L3801_88)
 3809.                la(1 + $I_L3801_88) = int( 19.501000000000001 + -( 2.0000000000000001e-1 * $theta_S3 ) )
 3810.                ll(1 + $I_L3801_88) = int( 19.001000000000001 + -( 2.0000000000000001e-1 * $theta_S3 ) )
 3816.                $Coss_P0 = coss( ( 1.0/year_getoz * ( -14.8125 + date ) * 6.28318530717958 ) )
 3816.                rsin1(1 + $I_L3801_88) = cimag( $Coss_P0 )
 3817.                rcos1(1 + $I_L3801_88) = real( $Coss_P0, 8 )
 3818.                rcos2(1 + $I_L3801_88) = cos( 12.56637061435916 * ( 1.0/year_getoz * ( -14.8125 + date ) ) )
 3819.                rate(1 + $I_L3801_88) = real( 19 + -( int( 19.001000000000001 + -( 2.0000000000000001e-1 * $theta_S3 ) ) ), 8 ) + -( 2.0000000000000001e-1 * $theta_S3 )
 3823.                $I_L3801_88 = 1 + $I_L3801_88
 3801.                if ( $I_L3801_88 >= ncols ) exit
 3801.             enddo
 3825.             $I_L3825_102 = 0
 3825.             do
 3824.                $SCA_la_I9 = la(1 + $I_L3825_102)
 3824.                $SCA_ll_I10 = ll(1 + $I_L3825_102)
 3824.                $SCA_rsin1_I11 = rsin1(1 + $I_L3825_102)
 3824.                $SCA_rcos1_I12 = rcos1(1 + $I_L3825_102)
 3824.                $SCA_rcos2_I13 = rcos2(1 + $I_L3825_102)
 3824.                $SCA_rate_I14 = rate(1 + $I_L3825_102)
 3824.                $I_L3824_90 = 0
 3824. !dir$ ivdep
 3824.                do
 3826.                   $a1_WR0_R0 = 2.5e-1 * ( (ozone%base_addr)(1 + $I_L3824_90, $SCA_la_I9, 1, 0) + (ozone%base_addr)(1 + $I_L3824_90, $SCA_la_I9, 2, 0) + (ozone%base_addr)(1 + $I_L3824_90, $SCA_la_I9, 3, 0) + (ozone%base_addr)(1 + $I_L3824_90, $SCA_la_I9, 4, 0) )
 3828.                   $a2_WR0_R1 = 5.0e-1 * ( (ozone%base_addr)(1 + $I_L3824_90, $SCA_la_I9, 2, 0) + -(ozone%base_addr)(1 + $I_L3824_90, $SCA_la_I9, 4, 0) )
 3829.                   $a3_WR0_R2 = 5.0e-1 * ( (ozone%base_addr)(1 + $I_L3824_90, $SCA_la_I9, 1, 0) + -(ozone%base_addr)(1 + $I_L3824_90, $SCA_la_I9, 3, 0) )
 3830.                   $a4_WR0_R3 = 2.5e-1 * ( (ozone%base_addr)(1 + $I_L3824_90, $SCA_la_I9, 1, 0) + (ozone%base_addr)(1 + $I_L3824_90, $SCA_la_I9, 3, 0) + -(ozone%base_addr)(1 + $I_L3824_90, $SCA_la_I9, 2, 0) + -(ozone%base_addr)(1 + $I_L3824_90, $SCA_la_I9, 4, 0) )
 3832.                   $b1_WR0_R4 = 2.5e-1 * ( (ozone%base_addr)(1 + $I_L3824_90, $SCA_ll_I10, 1, 0) + (ozone%base_addr)(1 + $I_L3824_90, $SCA_ll_I10, 2, 0) + (ozone%base_addr)(1 + $I_L3824_90, $SCA_ll_I10, 3, 0) + (ozone%base_addr)(1 + $I_L3824_90, $SCA_ll_I10, 4, 0) )
 3834.                   $b2_WR0_R5 = 5.0e-1 * ( (ozone%base_addr)(1 + $I_L3824_90, $SCA_ll_I10, 2, 0) + -(ozone%base_addr)(1 + $I_L3824_90, $SCA_ll_I10, 4, 0) )
 3835.                   $b3_WR0_R6 = 5.0e-1 * ( (ozone%base_addr)(1 + $I_L3824_90, $SCA_ll_I10, 1, 0) + -(ozone%base_addr)(1 + $I_L3824_90, $SCA_ll_I10, 3, 0) )
 3836.                   $b4_WR0_R7 = 2.5e-1 * ( (ozone%base_addr)(1 + $I_L3824_90, $SCA_ll_I10, 1, 0) + (ozone%base_addr)(1 + $I_L3824_90, $SCA_ll_I10, 3, 0) + -(ozone%base_addr)(1 + $I_L3824_90, $SCA_ll_I10, 2, 0) + -(ozone%base_addr)(1 + $I_L3824_90, $SCA_ll_I10, 4, 0) )
 3841.                   ozo3l(1 + $I_L3825_102, 1 + $I_L3824_90) = ( 1.0e-4 * ( ( $a1_WR0_R0 + $SCA_rsin1_I11 * $a2_WR0_R1 + $SCA_rcos1_I12 * $a3_WR0_R2 + $SCA_rcos2_I13 * $a4_WR0_R3 ) + $SCA_rate_I14 * ( ( $b1_WR0_R4 + $SCA_rsin1_I11 * $b2_WR0_R5 + $SCA_rcos1_I12 * $b3_WR0_R6 + $SCA_rcos2_I13 * $b4_WR0_R7 ) + -( $a1_WR0_R0 + $SCA_rsin1_I11 * $a2_WR0_R1 + $SCA_rcos1_I12 * $a3_WR0_R2 + $SCA_rcos2_I13 * $a4_WR0_R3 ) ) ) )
 3843.                   $I_L3824_90 = 1 + $I_L3824_90
 3825.                   if ( $I_L3824_90 >= 18 ) exit
 3825.                enddo
 3842.                $I_L3825_102 = 1 + $I_L3825_102
 3842.                if ( $I_L3825_102 >= ncols ) exit
 3842.             enddo
 3842.          endif
 3844.          if ( inter_getoz ) then
 3845.             if ( kmax > 0 ) then
 3846.                $SC_ozsig_I8 = ozsig(1)
 3845.                $I_L3845_92 = 0
 3845. !dir$ ivdep
 3845.                do
 3846.                   $notfound_WR0_R11 = sigmid(1 + $I_L3845_92) > $SC_ozsig_I8
 3846.                   notfound(1 + $I_L3845_92) = $notfound_WR0_R11
 3847.                   kk(1, 1 + $I_L3845_92) = cvmg( 18, 2, $notfound_WR0_R11 )
 3852.                   $I_L3845_92 = 1 + $I_L3845_92
 3845.                   if ( $I_L3845_92 >= kmax ) exit
 3845.                enddo
 3853.                $I_L3853_104 = 0
 3853.                do
 3854.                   if ( notfound(1 + $I_L3853_104) ) then
 3856.                      $SC_sigmid_I17 = sigmid(1 + $I_L3853_104)
 3855.                      $I_L3855_94 = 0
 3855. !dir$ ivdep
 3855.                      do
 3856.                         if ( $SC_sigmid_I17 <= ozsig(1 + $I_L3855_94) .orelse. $SC_sigmid_I17 > ozsig(2 + $I_L3855_94) ) then
 3860.                            $I_L3855_94 = 1 + $I_L3855_94
 3859.                         else
 3859.                         endif
 3859.                         if ( $I_L3855_94 >= 17 ) exit
 3859.                      enddo
 3859.                   endif
 3862.                   $I_L3853_104 = 1 + $I_L3853_104
 3861.                   if ( $I_L3853_104 >= kmax ) exit
 3861.                enddo
 3864.                if ( -2 + ncols >= 0 ) then
 3863.                   $I_L3863_106 = 0
 3863.                   do
 3864.                      $SCA_kk_I15 = kk(1, 1 + $I_L3863_106)
 3864.                      $I_L3864_96 = 0
 3864. !dir$ ivdep
 3864.                      do
 3865.                         kk(2 + $I_L3864_96, 1 + $I_L3863_106) = $SCA_kk_I15
 3866.                         $I_L3864_96 = 1 + $I_L3864_96
 3864.                         if ( $I_L3864_96 >= -1 + ncols ) exit
 3864.                      enddo
 3867.                      $I_L3863_106 = 1 + $I_L3863_106
 3866.                      if ( $I_L3863_106 >= kmax ) exit
 3866.                   enddo
 3866.                endif
 3871.                if ( ncols > 0 ) then
 3870.                   $I_L3870_108 = 0
 3870.                   do
 3871.                      $SCA_sigmid_I16 = sigmid(1 + $I_L3870_108)
 3871.                      $I_L3871_98 = 0
 3871. !dir$ ivdep
 3871.                      do
 3872.                         $aa_S13 = ( ( ozo3l(1 + $I_L3871_98, kk(1 + $I_L3871_98, 1 + $I_L3870_108)) + -ozo3l(1 + $I_L3871_98, -1 + kk(1 + $I_L3871_98, 1 + $I_L3870_108)) ) * 1.0/( ozsig(kk(1 + $I_L3871_98, 1 + $I_L3870_108)) + -ozsig(-1 + kk(1 + $I_L3871_98, 1 + $I_L3870_108)) ) )
 3873.                         $bb_S14 = ozo3l(1 + $I_L3871_98, -1 + kk(1 + $I_L3871_98, 1 + $I_L3870_108)) + -( $aa_S13 * ozsig(-1 + kk(1 + $I_L3871_98, 1 + $I_L3870_108)) )
 3874.                         o3l(1 + $I_L3871_98, kmax + -$I_L3870_108) = $bb_S14 + $aa_S13 * $SCA_sigmid_I16
 3875.                         $I_L3871_98 = 1 + $I_L3871_98
 3871.                         if ( $I_L3871_98 >= ncols ) exit
 3871.                      enddo
 3876.                      $I_L3870_108 = 1 + $I_L3870_108
 3875.                      if ( $I_L3870_108 >= kmax ) exit
 3875.                   enddo
 3875.                endif
 3875.             endif
 3875.          endif
 3878.          if ( inter_getoz == 0 ) then
 3880.             if ( ncols > 0 ) then
 3879.                $I_L3879_110 = 0
 3879.                do
 3880.                   $I_L3880_100 = 0
 3880. !dir$ ivdep
 3880.                   do
 3881.                      o3l(1 + $I_L3880_100, 1 + $I_L3879_110) = ozo3l(1 + $I_L3880_100, 1 + $I_L3879_110)
 3882.                      $I_L3880_100 = 1 + $I_L3880_100
 3880.                      if ( $I_L3880_100 >= ncols ) exit
 3880.                   enddo
 3883.                   $I_L3879_110 = 1 + $I_L3879_110
 3882.                   if ( $I_L3879_110 >= 18 ) exit
 3882.                enddo
 3882.             endif
 3882.          endif
 3715.          _free( t$363 )
 3715.       endif
 3885.       return
 3885.       end
 3885.       
 3887.       
 3887.       subroutine cloud_field( ncols, kmax, nls, icld, covlp, mxrdcc, lcnvl, lthncl, sig, ps, qrel, omg, te, convc, convt, convb, convts, convcs, convbs, cld, clu, cloudcover, cldcovtot, cldcovinv, cldcovsat, cldcovcon, cldcovsha )
 3887.       t$39 = kmax
 3917.       t$388 = _zla( 0, kmax )
 3887.       t$40 = ncols
 3918.       t$389 = _zla( 0, ncols )
 3887.       t$390 = _zla( 0, ncols )
 3887.       t$391 = _zla( 0, kmax ) * _zla( 0, ncols )
 3959.       $F_A33 = kmax
 3959.       $F_A34 = ncols
 3959.       if ( and( -$F_A34, -$F_A33 ) < 0 ) then
 3959.          $I_L3959_64 = 0
 3959.          do
 3959.             $I_L3959_44 = 0
 3959. !dir$ ivdep
 3959.             do
 3959.                cld(1 + $I_L3959_44, 1 + $I_L3959_64) = 0.0
 3959.                $I_L3959_44 = 1 + $I_L3959_44
 3959.                if ( $I_L3959_44 >= $F_A34 ) exit
 3959.             enddo
 3959.             $I_L3959_64 = 1 + $I_L3959_64
 3959.             if ( $I_L3959_64 >= $F_A33 ) exit
 3959.          enddo
 3959.       endif
 3960.       $F_A35 = kmax
 3960.       $F_A36 = ncols
 3960.       if ( and( -$F_A36, -$F_A35 ) < 0 ) then
 3960.          $I_L3960_66 = 0
 3960.          do
 3960.             $I_L3960_46 = 0
 3960. !dir$ ivdep
 3960.             do
 3960.                clu(1 + $I_L3960_46, 1 + $I_L3960_66) = 0.0
 3960.                $I_L3960_46 = 1 + $I_L3960_46
 3960.                if ( $I_L3960_46 >= $F_A36 ) exit
 3960.             enddo
 3960.             $I_L3960_66 = 1 + $I_L3960_66
 3960.             if ( $I_L3960_66 >= $F_A35 ) exit
 3960.          enddo
 3960.       endif
 3961.       $F_A37 = kmax
 3961.       $F_A38 = ncols
 3961.       if ( and( -$F_A38, -$F_A37 ) < 0 ) then
 3961.          $I_L3961_68 = 0
 3961.          do
 3961.             $I_L3961_48 = 0
 3961. !dir$ ivdep
 3961.             do
 3961.                cldcovtot(1 + $I_L3961_48, 1 + $I_L3961_68) = 0.0
 3961.                $I_L3961_48 = 1 + $I_L3961_48
 3961.                if ( $I_L3961_48 >= $F_A38 ) exit
 3961.             enddo
 3961.             $I_L3961_68 = 1 + $I_L3961_68
 3961.             if ( $I_L3961_68 >= $F_A37 ) exit
 3961.          enddo
 3961.       endif
 3962.       $F_A39 = kmax
 3962.       $F_A40 = ncols
 3962.       if ( and( -$F_A40, -$F_A39 ) < 0 ) then
 3962.          $I_L3962_70 = 0
 3962.          do
 3962.             $I_L3962_50 = 0
 3962. !dir$ ivdep
 3962.             do
 3962.                cldcovinv(1 + $I_L3962_50, 1 + $I_L3962_70) = 0.0
 3962.                $I_L3962_50 = 1 + $I_L3962_50
 3962.                if ( $I_L3962_50 >= $F_A40 ) exit
 3962.             enddo
 3962.             $I_L3962_70 = 1 + $I_L3962_70
 3962.             if ( $I_L3962_70 >= $F_A39 ) exit
 3962.          enddo
 3962.       endif
 3963.       $F_A41 = kmax
 3963.       $F_A42 = ncols
 3963.       if ( and( -$F_A42, -$F_A41 ) < 0 ) then
 3963.          $I_L3963_72 = 0
 3963.          do
 3963.             $I_L3963_52 = 0
 3963. !dir$ ivdep
 3963.             do
 3963.                cldcovsat(1 + $I_L3963_52, 1 + $I_L3963_72) = 0.0
 3963.                $I_L3963_52 = 1 + $I_L3963_52
 3963.                if ( $I_L3963_52 >= $F_A42 ) exit
 3963.             enddo
 3963.             $I_L3963_72 = 1 + $I_L3963_72
 3963.             if ( $I_L3963_72 >= $F_A41 ) exit
 3963.          enddo
 3963.       endif
 3964.       $F_A43 = kmax
 3964.       $F_A44 = ncols
 3964.       if ( and( -$F_A44, -$F_A43 ) < 0 ) then
 3964.          $I_L3964_74 = 0
 3964.          do
 3964.             $I_L3964_54 = 0
 3964. !dir$ ivdep
 3964.             do
 3964.                cldcovcon(1 + $I_L3964_54, 1 + $I_L3964_74) = 0.0
 3964.                $I_L3964_54 = 1 + $I_L3964_54
 3964.                if ( $I_L3964_54 >= $F_A44 ) exit
 3964.             enddo
 3964.             $I_L3964_74 = 1 + $I_L3964_74
 3964.             if ( $I_L3964_74 >= $F_A43 ) exit
 3964.          enddo
 3964.       endif
 3965.       $F_A45 = kmax
 3965.       $F_A46 = ncols
 3965.       if ( and( -$F_A46, -$F_A45 ) < 0 ) then
 3965.          $I_L3965_76 = 0
 3965.          do
 3965.             $I_L3965_56 = 0
 3965. !dir$ ivdep
 3965.             do
 3965.                cldcovsha(1 + $I_L3965_56, 1 + $I_L3965_76) = 0.0
 3965.                $I_L3965_56 = 1 + $I_L3965_56
 3965.                if ( $I_L3965_56 >= $F_A46 ) exit
 3965.             enddo
 3965.             $I_L3965_76 = 1 + $I_L3965_76
 3965.             if ( $I_L3965_76 >= $F_A45 ) exit
 3965.          enddo
 3965.       endif
 3966.       $F_A47 = ncols
 3966.       if ( ncols > 0 ) then
 3966.          $I_L3966_58 = 0
 3966. !dir$ ivdep
 3966.          do
 3966.             cloudcover(1 + $I_L3966_58) = 0.0
 3966.             $I_L3966_58 = 1 + $I_L3966_58
 3966.             if ( $I_L3966_58 >= $F_A47 ) exit
 3966.          enddo
 3966.       endif
 3968.       if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'LCH' .orelse.  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'NON' ) then
 3969.          if ( icld == 1 ) then
 3970.             call cldgen(  _substr(covlp,1,4), ps(1), sig(1), qrel(1, 1), omg(1, 1), te(1, 1), cld(1, 1), clu(1, 1), cldcovinv(1, 1), cldcovsat(1, 1), cldcovcon(1, 1), cldcovsha(1, 1), mxrdcc, lcnvl, lthncl, convc(1), convt(1), convb(1), ncols, kmax, nls )
 3970.          endif
 3974.          if ( icld == 3 ) then
 3975.             call cldgn2(  _substr(covlp,1,4), ps(1), sig(1), qrel(1, 1), omg(1, 1), te(1, 1), cld(1, 1), clu(1, 1), cldcovinv(1, 1), cldcovsat(1, 1), cldcovcon(1, 1), cldcovsha(1, 1), mxrdcc, lcnvl, convc(1), convt(1), convb(1), convts(1), convcs(1), convbs(1), ncols, kmax, nls )
 3975.          endif
 3975.       else
 3979.          call cldgn3( ps(1), sig(1), qrel(1, 1), omg(1, 1), te(1, 1), cld(1, 1), clu(1, 1), cldcovinv(1, 1), cldcovsat(1, 1), cldcovcon(1, 1), cldcovsha(1, 1), lcnvl, lthncl, convc(1), convt(1), convb(1), ncols, kmax, nls )
 3979.       endif
 3986.       if ( ncols > 0 ) then
 3986.          $I_L3986_36 = 0
 3986. !dir$ ivdep
 3986.          do
 3987.             cloudcover(1 + $I_L3986_36) = 1.0
 3988.             $I_L3986_36 = 1 + $I_L3986_36
 3986.             if ( $I_L3986_36 >= ncols ) exit
 3986.          enddo
 3986.       endif
 3990.       if (  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'LCH' .orelse.  _substr(iswrad,1,_ltrim(  _substr(iswrad,1,3) )) == 'NON' ) then
 3991.          if ( kmax > 0 ) then
 3993.             if ( ncols > 0 ) then
 3991.                $I_L3991_62 = 0
 3991. !dir$ blocking_size( 0, 0 )
 3991.                do
 3993.                   $I_L3993_40 = 0
 3993. !dir$ ivdep
 3993. !dir$ blocking_size( 0, 0 )
 3993.                   do
 3994.                      cldcovtot(1 + $I_L3993_40, 1 + $I_L3991_62) = cld(1 + $I_L3993_40, kmax + -$I_L3991_62)
 3995.                      cloudcover(1 + $I_L3993_40) = cloudcover(1 + $I_L3993_40) * ( 1.0 + -cld(1 + $I_L3993_40, 1 + $I_L3991_62) )
 3996.                      $I_L3993_40 = 1 + $I_L3993_40
 3993.                      if ( $I_L3993_40 >= ncols ) exit
 3993.                   enddo
 3997.                   $I_L3991_62 = 1 + $I_L3991_62
 3996.                   if ( $I_L3991_62 >= kmax ) exit
 3996.                enddo
 3996.             endif
 3996.          endif
 3996.       else
 3999.          if ( kmax > 0 ) then
 4001.             if ( ncols > 0 ) then
 3999.                $I_L3999_60 = 0
 3999. !dir$ blocking_size( 0, 0 )
 3999.                do
 4001.                   $I_L4001_38 = 0
 4001. !dir$ ivdep
 4001. !dir$ blocking_size( 0, 0 )
 4001.                   do
 4002.                      $cldcovtot_WR0_R0 = max( cld(1 + $I_L4001_38, kmax + -$I_L3999_60), clu(1 + $I_L4001_38, kmax + -$I_L3999_60) )
 4002.                      cldcovtot(1 + $I_L4001_38, 1 + $I_L3999_60) = $cldcovtot_WR0_R0
 4003.                      cloudcover(1 + $I_L4001_38) = cloudcover(1 + $I_L4001_38) * ( 1.0 + -$cldcovtot_WR0_R0 )
 4004.                      $I_L4001_38 = 1 + $I_L4001_38
 4001.                      if ( $I_L4001_38 >= ncols ) exit
 4001.                   enddo
 4005.                   $I_L3999_60 = 1 + $I_L3999_60
 4004.                   if ( $I_L3999_60 >= kmax ) exit
 4004.                enddo
 4004.             endif
 4004.          endif
 4004.       endif
 4008.       if ( ncols > 0 ) then
 4008.          $I_L4008_42 = 0
 4008. !dir$ ivdep
 4008.          do
 4009.             cloudcover(1 + $I_L4008_42) = 1.0 + -cloudcover(1 + $I_L4008_42)
 4010.             $I_L4008_42 = 1 + $I_L4008_42
 4008.             if ( $I_L4008_42 >= ncols ) exit
 4008.          enddo
 4008.       endif
 4012.       return
 4012.       end
 4012.       
 4014.       
 4014.       subroutine cloud_micro_ccm3( ncols, kmax, sigmid, sigbot, delsig, imask, ps, te, qe, tsea, flippbot, clwp, lmixr, fice, rei, rel, taud )
 4014.       t$41 = kmax
 4101.       t$392 = _zla( 0, kmax )
 4014.       t$42 = ( 1 + kmax )
 4102.       t$393 = _zla( 0, ( 1 + kmax ) )
 4014.       t$43 = ncols
 4104.       t$394 = _zla( 0, ncols )
 4014.       t$395 = _zla( 0, ncols )
 4014.       t$396 = _zla( 0, kmax ) * _zla( 0, ncols )
 4014.       t$397 = _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols )
 4146.       t$400 = _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8
 4142.       t$401 = _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8
 4142.       t$403 = _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + 8 * _zla( 0, ncols )
 4144.       t$404 = _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + 8 * _zla( 0, ncols )
 4144.       t$406 = _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + 16 * _zla( 0, ncols )
 4143.       t$407 = _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + 16 * _zla( 0, ncols )
 4143.       t$409 = _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + 24 * _zla( 0, ncols )
 4149.       t$410 = _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + 24 * _zla( 0, ncols )
 4149.       t$412 = _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + _zla( 0, kmax ) * _zla( 0, ncols ) * 8 + 24 * _zla( 0, ncols )
 4148.       t$413 = _zla( 0, kmax ) * _zla( 0, ncols ) * 8 + 24 * _zla( 0, ncols ) + _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8
 4148.       t$415 = _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + 24 * _zla( 0, ncols ) + _zla( 0, kmax ) * _zla( 0, ncols ) * 16
 4145.       t$416 = 24 * _zla( 0, ncols ) + _zla( 0, kmax ) * _zla( 0, ncols ) * 16 + _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8
 4145.       t$418 = 24 * _zla( 0, ncols ) + _zla( 0, kmax ) * _zla( 0, ncols ) * 16 + _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 16
 4014.       t$398 = int( _alloc( 24 * _zla( 0, ncols ) + _zla( 0, kmax ) * _zla( 0, ncols ) * 16 + _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 16 ), 8 )
 4146.       t$399 = t$398
 4142.       t$402 = t$398 + _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8
 4144.       t$405 = t$398 + _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + 8 * _zla( 0, ncols )
 4143.       t$408 = t$398 + _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + 16 * _zla( 0, ncols )
 4149.       t$411 = t$398 + _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + 24 * _zla( 0, ncols )
 4148.       t$414 = t$398 + _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + _zla( 0, kmax ) * _zla( 0, ncols ) * 8 + 24 * _zla( 0, ncols )
 4145.       t$417 = t$398 + _zla( 0, ( 1 + kmax ) ) * _zla( 0, ncols ) * 8 + 24 * _zla( 0, ncols ) + _zla( 0, kmax ) * _zla( 0, ncols ) * 16
 4159.       $F_A33 = kmax
 4159.       $F_A34 = ncols
 4159.       if ( and( -$F_A34, -$F_A33 ) < 0 ) then
 4159.          $I_L4159_223 = 0
 4159.          do
 4159.             $I_L4159_203 = 0
 4159. !dir$ ivdep
 4159.             do
 4159.                clwp(1 + $I_L4159_203, 1 + $I_L4159_223) = 0.0
 4159.                $I_L4159_203 = 1 + $I_L4159_203
 4159.                if ( $I_L4159_203 >= $F_A34 ) exit
 4159.             enddo
 4159.             $I_L4159_223 = 1 + $I_L4159_223
 4159.             if ( $I_L4159_223 >= $F_A33 ) exit
 4159.          enddo
 4159.       endif
 4160.       $F_A35 = kmax
 4160.       $F_A36 = ncols
 4160.       if ( and( -$F_A36, -$F_A35 ) < 0 ) then
 4160.          $I_L4160_225 = 0
 4160.          do
 4160.             $I_L4160_205 = 0
 4160. !dir$ ivdep
 4160.             do
 4160.                lmixr(1 + $I_L4160_205, 1 + $I_L4160_225) = 0.0
 4160.                $I_L4160_205 = 1 + $I_L4160_205
 4160.                if ( $I_L4160_205 >= $F_A36 ) exit
 4160.             enddo
 4160.             $I_L4160_225 = 1 + $I_L4160_225
 4160.             if ( $I_L4160_225 >= $F_A35 ) exit
 4160.          enddo
 4160.       endif
 4161.       $F_A37 = kmax
 4161.       $F_A38 = ncols
 4161.       if ( and( -$F_A38, -$F_A37 ) < 0 ) then
 4161.          $I_L4161_227 = 0
 4161.          do
 4161.             $I_L4161_207 = 0
 4161. !dir$ ivdep
 4161.             do
 4161.                fice(1 + $I_L4161_207, 1 + $I_L4161_227) = 0.0
 4161.                $I_L4161_207 = 1 + $I_L4161_207
 4161.                if ( $I_L4161_207 >= $F_A38 ) exit
 4161.             enddo
 4161.             $I_L4161_227 = 1 + $I_L4161_227
 4161.             if ( $I_L4161_227 >= $F_A37 ) exit
 4161.          enddo
 4161.       endif
 4162.       $F_A39 = kmax
 4162.       $F_A40 = ncols
 4162.       if ( and( -$F_A40, -$F_A39 ) < 0 ) then
 4162.          $I_L4162_229 = 0
 4162.          do
 4162.             $I_L4162_209 = 0
 4162. !dir$ ivdep
 4162.             do
 4162.                rei(1 + $I_L4162_209, 1 + $I_L4162_229) = 0.0
 4162.                $I_L4162_209 = 1 + $I_L4162_209
 4162.                if ( $I_L4162_209 >= $F_A40 ) exit
 4162.             enddo
 4162.             $I_L4162_229 = 1 + $I_L4162_229
 4162.             if ( $I_L4162_229 >= $F_A39 ) exit
 4162.          enddo
 4162.       endif
 4163.       $F_A41 = kmax
 4163.       $F_A42 = ncols
 4163.       if ( and( -$F_A42, -$F_A41 ) < 0 ) then
 4163.          $I_L4163_231 = 0
 4163.          do
 4163.             $I_L4163_211 = 0
 4163. !dir$ ivdep
 4163.             do
 4163.                rel(1 + $I_L4163_211, 1 + $I_L4163_231) = 0.0
 4163.                $I_L4163_211 = 1 + $I_L4163_211
 4163.                if ( $I_L4163_211 >= $F_A42 ) exit
 4163.             enddo
 4163.             $I_L4163_231 = 1 + $I_L4163_231
 4163.             if ( $I_L4163_231 >= $F_A41 ) exit
 4163.          enddo
 4163.       endif
 4164.       $F_A43 = ncols
 4164.       if ( ncols > 0 ) then
 4164.          $I_L4164_213 = 0
 4164. !dir$ ivdep
 4164.          do
 4164.             pw(1 + $I_L4164_213) = 0.0
 4164.             $I_L4164_213 = 1 + $I_L4164_213
 4164.             if ( $I_L4164_213 >= $F_A43 ) exit
 4164.          enddo
 4170.          if ( -2 + kmax >= 0 ) then
 4168.             $I_L4168_215 = 0
 4168. !dir$ ivdep
 4168.             do
 4169.                zibot(1 + $I_L4168_215, 1) = 0.0
 4170.                $I_L4170_184 = 0
 4170. !dir$ unroll 4
 4170.                do
 4171.                   $SCF_P0 = log( ( flippbot(1 + $I_L4168_215, kmax + -$I_L4170_184) * 1.0/flippbot(1 + $I_L4168_215, kmax + -$I_L4170_184 + -1) ) ) * te(1 + $I_L4168_215, 1 + $I_L4170_184) * 29.29081632653061
 4171.                   zibot(1 + $I_L4168_215, 2 + $I_L4170_184) = zibot(1 + $I_L4168_215, 1 + $I_L4170_184) + $SCF_P0
 4174.                   $I_L4170_184 = 1 + $I_L4170_184
 4170.                   if ( $I_L4170_184 >= -1 + kmax ) exit
 4170.                enddo
 4175.                $I_L4168_215 = 1 + $I_L4168_215
 4174.                if ( $I_L4168_215 >= ncols ) exit
 4174.             enddo
 4174.          else
 4168.             $I_L4168_201 = 0
 4168. !dir$ ivdep
 4168.             do
 4169.                zibot(1 + $I_L4168_201, 1) = 0.0
 4175.                $I_L4168_201 = 1 + $I_L4168_201
 4174.                if ( $I_L4168_201 >= ncols ) exit
 4174.             enddo
 4174.          endif
 4176.          $I_L4176_186 = 0
 4176. !dir$ ivdep
 4176.          do
 4177.             zibot(1 + $I_L4176_186, 1 + kmax) = zibot(1 + $I_L4176_186, kmax) + log( 2.0 * flippbot(1 + $I_L4176_186, 1) ) * te(1 + $I_L4176_186, kmax) * 29.29081632653061
 4179.             $I_L4176_186 = 1 + $I_L4176_186
 4176.             if ( $I_L4176_186 >= ncols ) exit
 4176.          enddo
 4176.       endif
 4188.       if ( kmax > 0 ) then
 4189.          if ( ncols > 0 ) then
 4190.              _substr($W0,1,1) = 'n'
 4190.             $W1 = ncols
 4190.             $W2 = kmax
 4190.             $W3 = 1.0
 4190.             $W4 = ncols
 4190.             $W5 = 1
 4190.             $W6 = 1.0
 4190.             $W7 = 1
 4190.             _dgemv(  _substr($W0,1,1), $W1, $W2, $W3, qe(1, 1), $W4, delsig(1), $W5, $W6, pw(1), $W7 )
 4242.             $I_L4242_221 = 0
 4242.             do
 4243.                $weight_S6 = min( 0.0, 2.5 * ( -4.0000000000000002e-1 + sigmid(1 + $I_L4242_221) ) )
 4244.                $I_L4244_194 = 0
 4244. !dir$ ivdep
 4244.                do
 4245.                   rei(1 + $I_L4244_194, 1 + $I_L4242_221) = 10.0 + -20.0 * $weight_S6
 4254.                   fice(1 + $I_L4244_194, 1 + $I_L4242_221) = max( 0.0, min( 1.0, 5.0000000000000003e-2 * ( 263.16000000000003 + -te(1 + $I_L4244_194, 1 + $I_L4242_221) ) ) )
 4246.                   $I_L4244_194 = 1 + $I_L4244_194
 4244.                   if ( $I_L4244_194 >= ncols ) exit
 4244.                enddo
 4247.                $I_L4242_221 = 1 + $I_L4242_221
 4246.                if ( $I_L4242_221 >= kmax ) exit
 4246.             enddo
 4262.             $I_L4262_235 = 0
 4262.             do
 4261.                $I_L4261_233 = 0
 4261. !dir$ ivdep
 4261. !dir$ blocking_size( 0, 0 )
 4261.                do
 4262.                   $I_L4262_196 = 0
 4262. !dir$ blocking_size( 256, 256 )
 4262.                   do
 4263.                      if ( imask($I_L4262_196 + 256 * $I_L4262_235 + 1) <= 0 ) then
 4264.                         rel($I_L4262_196 + 256 * $I_L4262_235 + 1, 1 + $I_L4261_233) = 10.0
 4264.                      else
 4266.                         rel($I_L4262_196 + 256 * $I_L4262_235 + 1, 1 + $I_L4261_233) = 5.0 + 5.0 * fice($I_L4262_196 + 256 * $I_L4262_235 + 1, 1 + $I_L4261_233)
 4267.                         if ( fice($I_L4262_196 + 256 * $I_L4262_235 + 1, 1 + $I_L4261_233) == 1.0 ) then
 4267.                            rel($I_L4262_196 + 256 * $I_L4262_235 + 1, 1 + $I_L4261_233) = rei($I_L4262_196 + 256 * $I_L4262_235 + 1, 1 + $I_L4261_233)
 4267.                         endif
 4267.                      endif
 4262.                      $I_L4262_196 = 1 + $I_L4262_196
 4268.                      if ( $I_L4262_196 >= min( ncols, 256 + 256 * $I_L4262_235 ) + -256 * $I_L4262_235 ) exit
 4268.                   enddo
 4270.                   $I_L4261_233 = 1 + $I_L4261_233
 4270.                   if ( $I_L4261_233 >= kmax ) exit
 4270.                enddo
 4262.                $I_L4262_235 = 1 + $I_L4262_235
 4269.                if ( $I_L4262_235 >= 1 + max( 0, -1 + _rsh( 255 + ncols, 8 ) ) ) exit
 4269.             enddo
 4269.          endif
 4269.       endif
 4193.       if ( ncols > 0 ) then
 4193.          $I_L4193_188 = 0
 4193. !dir$ ivdep
 4193.          do
 4194.             $pw_WR0_R0 = ps(1 + $I_L4193_188) * pw(1 + $I_L4193_188) * 10.204081632653059
 4194.             pw(1 + $I_L4193_188) = $pw_WR0_R0
 4199.             $hl_WR0_R1 = 700.0 * log( max( 1.0, 1.0 + $pw_WR0_R0 ) )
 4199.             hl(1 + $I_L4193_188) = $hl_WR0_R1
 4200.             rhl(1 + $I_L4193_188) = 1.0/$hl_WR0_R1
 4195.             $I_L4193_188 = 1 + $I_L4193_188
 4193.             if ( $I_L4193_188 >= ncols ) exit
 4193.          enddo
 4193.       endif
 4203.       if ( kmax >= 0 ) then
 4204.          if ( ncols > 0 ) then
 4203.             $I_L4203_217 = 0
 4203.             if ( -3 + kmax >= 0 ) then
 4203.                $I_L4203_240 = 0
 4203. !dir$ blocking_size( 0, 0 )
 4203.                do
 4204.                   $I_L4204_190 = 0
 4204. !dir$ ivdep
 4204. !dir$ blocking_size( 0, 0 )
 4204.                   do
 4206.                      emziohl(1 + $I_L4204_190, 1 + 4 * $I_L4203_240) = _expn( -( zibot(1 + $I_L4204_190, 1 + 4 * $I_L4203_240) * rhl(1 + $I_L4204_190) ) )
 4206.                      emziohl(1 + $I_L4204_190, 2 + 4 * $I_L4203_240) = _expn( -( zibot(1 + $I_L4204_190, 2 + 4 * $I_L4203_240) * rhl(1 + $I_L4204_190) ) )
 4206.                      emziohl(1 + $I_L4204_190, 3 + 4 * $I_L4203_240) = _expn( -( zibot(1 + $I_L4204_190, 3 + 4 * $I_L4203_240) * rhl(1 + $I_L4204_190) ) )
 4206.                      emziohl(1 + $I_L4204_190, 4 + 4 * $I_L4203_240) = _expn( -( zibot(1 + $I_L4204_190, 4 + 4 * $I_L4203_240) * rhl(1 + $I_L4204_190) ) )
 4207.                      $I_L4204_190 = 1 + $I_L4204_190
 4204.                      if ( $I_L4204_190 >= ncols ) exit
 4204.                   enddo
 4208.                   $I_L4203_240 = 1 + $I_L4203_240
 4207.                   if ( $I_L4203_240 >= _rsh( 1 + kmax, 2 ) ) exit
 4207.                enddo
 4208.                $I_L4203_217 = and( 0xfffffffffffffffcUL, 1 + kmax )
 4208.             endif
 4203.             if ( $I_L4203_217 < 1 + kmax ) then
 4203.                $I_L4203_237 = 0
 4203. !dir$ blocking_size( 0, 0 )
 4203.                do
 4204.                   $I_L4204_190 = 0
 4204. !dir$ ivdep
 4204. !dir$ blocking_size( 0, 0 )
 4204.                   do
 4206.                      emziohl(1 + $I_L4204_190, $I_L4203_217 + $I_L4203_237 + 1) = _expn( -( zibot(1 + $I_L4204_190, $I_L4203_217 + $I_L4203_237 + 1) * rhl(1 + $I_L4204_190) ) )
 4207.                      $I_L4204_190 = 1 + $I_L4204_190
 4204.                      if ( $I_L4204_190 >= ncols ) exit
 4204.                   enddo
 4208.                   $I_L4203_237 = 1 + $I_L4203_237
 4207.                   if ( $I_L4203_237 >= kmax + -$I_L4203_217 + 1 ) exit
 4207.                enddo
 4207.             endif
 4207.          endif
 4207.       endif
 4214.       if ( kmax > 0 ) then
 4215.          if ( ncols > 0 ) then
 4214.             $I_L4214_219 = 0
 4214.             do
 4234.                $SCA_delsig_I0 = delsig(1 + $I_L4214_219)
 4215.                $I_L4215_192 = 0
 4215. !dir$ ivdep
 4215.                do
 4216.                   $clwp_WR0_R2 = ( emziohl(1 + $I_L4215_192, 1 + $I_L4214_219) + -emziohl(1 + $I_L4215_192, 2 + $I_L4214_219) ) * hl(1 + $I_L4215_192) * 2.0999999999999999e-1
 4216.                   clwp(1 + $I_L4215_192, 1 + $I_L4214_219) = $clwp_WR0_R2
 4235.                   lmixr(1 + $I_L4215_192, 1 + $I_L4214_219) = ( ( 1.0/$SCA_delsig_I0 * $clwp_WR0_R2 * 9.800000000000001e-5 ) * 1.0/ps(1 + $I_L4215_192) )
 4217.                   $I_L4215_192 = 1 + $I_L4215_192
 4215.                   if ( $I_L4215_192 >= ncols ) exit
 4215.                enddo
 4274.                $I_L4274_199 = 0
 4274. !dir$ ivdep
 4274.                do
 4276.                   $tauxcl_WR0_R3 = clwp(1 + $I_L4274_199, 1 + $I_L4214_219) * ( 2.2610000000000002e-2 + ( 1.4365000000000001 * 1.0/rel(1 + $I_L4274_199, 1 + $I_L4214_219) ) ) * ( 1.0 + -fice(1 + $I_L4274_199, 1 + $I_L4214_219) )
 4277.                   $tauxci_WR0_R4 = clwp(1 + $I_L4274_199, 1 + $I_L4214_219) * ( 3.4480000000000001e-3 + ( 2.431 * 1.0/rei(1 + $I_L4274_199, 1 + $I_L4214_219) ) ) * fice(1 + $I_L4274_199, 1 + $I_L4214_219)
 4278.                   if ( tsea(1 + $I_L4274_199) > 0.0 ) then
 4279.                      taud(1 + $I_L4274_199, 1 + $I_L4214_219) = 6.9999999999999996e-1 * ( $tauxcl_WR0_R3 + $tauxci_WR0_R4 )
 4279.                   else
 4281.                      taud(1 + $I_L4274_199, 1 + $I_L4214_219) = ( $tauxcl_WR0_R3 + $tauxci_WR0_R4 )
 4281.                   endif
 4283.                   $I_L4274_199 = 1 + $I_L4274_199
 4282.                   if ( $I_L4274_199 >= ncols ) exit
 4282.                enddo
 4218.                $I_L4214_219 = 1 + $I_L4214_219
 4217.                if ( $I_L4214_219 >= kmax ) exit
 4217.             enddo
 4217.          endif
 4217.       endif
 4014.       _free( t$398 )
 4287.       return
 4287.       end
 4287.       
 4289.       
 4289.       subroutine astropar( ncols, colrad, lonrad, id, tod, yrl, date, solar, cosine )
 4289.       t$44 = ncols
 4294.       t$419 = _zla( 0, ncols )
 4315.       t$422 = 8 * _zla( 0, ncols )
 4316.       t$423 = 8 * _zla( 0, ncols )
 4316.       t$425 = 16 * _zla( 0, ncols )
 4289.       t$420 = int( _alloc( 16 * _zla( 0, ncols ) ), 8 )
 4315.       t$421 = t$420
 4316.       t$424 = t$420 + 8 * _zla( 0, ncols )
 4325.       call radtim( id(1), delta, ratio, etime, tod, date, yrl )
 4326.       solar = 1365.0 * ratio
 4328.       $Coss_P0 = coss( delta )
 4330.       if ( ncols > 0 ) then
 4330.          $I_L4330_12 = 0
 4330. !dir$ ivdep
 4330.          do
 4331.             $Coss_P1 = coss( colrad(1 + $I_L4330_12) )
 4331.             coslat(1 + $I_L4330_12) = real( $Coss_P0, 8 ) * cimag( $Coss_P1 )
 4332.             sinlat(1 + $I_L4330_12) = cimag( $Coss_P0 ) * real( $Coss_P1, 8 )
 4333.             $I_L4330_12 = 1 + $I_L4330_12
 4330.             if ( $I_L4330_12 >= ncols ) exit
 4330.          enddo
 4330.       endif
 4334.       $frh_S4 = 2.7777777777777778e-4 * ( -3.125e-2 + mod( 3.125e-2 + tod, 3600.0 ) )
 4335.       if ( ncols > 0 ) then
 4336.          $SC_id_I0 = id(1)
 4335.          $I_L4335_14 = 0
 4335. !dir$ ivdep
 4335.          do
 4336.             $atime_S5 = etime + 2.6179938779914919e-1 * ( -6.6666666666666666e-2 * lonrad(1 + $I_L4335_14) + -$SC_id_I0 + -$frh_S4 + 12.0 )
 4337.             cosine(1 + $I_L4335_14) = sinlat(1 + $I_L4335_14) + coslat(1 + $I_L4335_14) * cos( $atime_S5 )
 4338.             $I_L4335_14 = 1 + $I_L4335_14
 4335.             if ( $I_L4335_14 >= ncols ) exit
 4335.          enddo
 4335.       endif
 4289.       _free( t$420 )
 4340.       return
 4340.       end
 4340.       
  112.       
  112.       module modradiationdriver
 4342.       return
 4342.       end
 4342.       
