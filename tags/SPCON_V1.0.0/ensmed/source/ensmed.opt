       !        
       !        Cray Inc. Decompilation
       !        WARNING - This output is provided for information only.
       !        
       !        Cray Inc. reserves the right to change the format of this
       !        information at any time and does not guarantee the
       !        readability or accuracy of this information.
       !        
       !        This information may not be compilable and corresponds to
       !        the internal representation of the program during the
       !        optimization phase of the compilation process.
       !        
       !        Source                :  ensmed.f90
       !        File                  :  ensmed.opt
       !        Format                :  Fortran
       !        Target                :  X86, 64-bit
       !        
   60.       
   60.       program ensmed
   64.       call mpi_init( ierr )
   65.       call mpi_comm_size( 1140850688, numproc, ierr )
   66.       call mpi_comm_rank( 1140850688, thisproc, ierr )
   70.       call getarg( 1,  _substr(anldate,1,10) )
   71.       _fwrite( _clist( 0, 0, 3,  _substr(ensmedi,1,100), Null_Arg, Null_Arg, t$3,  _substr(t$2,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'ensmed.', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype( '.nml', 0x800600000000L ) ) )
   75.       t$8 = 9 + ( _ltrim(  _substr(ensmedi,1,100) ) )
   75.       t$10 = int( _alloc( _zla( 0, t$8 ) ), 8 )
   75.        _substr(t$9,1,_zla( 0, t$8 )) = //( 'File 10: ',  _substr(ensmedi,1,_ltrim(  _substr(ensmedi,1,100) )) )
   75.       _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(t$9,1,_zla( 0, t$8 )), 0x800600000000L ) ) )
   75.       _free( t$10 )
   76.       t$12 = 10
   76.        _substr(t$13,1,4) = 'OLD'
   76.        _substr(t$14,1,9) = 'FORMATTED'
   76.       t$15(1) = 0x100000000000000L
   76. !dir$ suppress t$12
   76.       t$15(2) = int( loc( t$12 ), 8 )
   76.       t$15(3) = 0
   76.       t$15(4) = 0
   76. !dir$ suppress  _substr(ensmedi,1,_ltrim(  _substr(ensmedi,1,100) ))
   76.       t$15(5) = int( loc(  _substr(ensmedi,1,_ltrim(  _substr(ensmedi,1,100) )) ), 8 )
   76.       t$15(6) = _ltrim(  _substr(ensmedi,1,100) )
   76. !dir$ suppress  _substr(t$13,1,3)
   76.       t$15(7) = int( loc(  _substr(t$13,1,3) ), 8 )
   76.       t$15(8) = 3
   76.       t$15(9) = 0
   76. !dir$ suppress  _substr(t$14,1,9)
   76.       t$15(11) = int( loc(  _substr(t$14,1,9) ), 8 )
   76.       t$15(12) = 9
   76.       t$15(13) = 0
   76.       t$15(14) = 0
   76.       t$15(16) = 0
   76.       t$15(18) = 0
   76.       t$15(20) = 0
   76.       t$15(22) = 0
   76.       t$15(24) = 0
   76.       t$15(25) = 0
   76.       t$15(27) = 0
   76.       t$15(29) = 0
   76.       t$15(31) = 0
   76.       t$15(33) = 0
   76.       t$15(35) = 0
   76.       t$11 = _open( t$15 )
   77.       t$280 = 100
   77.       t$281 = 100
   77.       t$282 = 200
   77.       t$283 = 200
   77.       ierr = 0
   77.       do
   77.          t$284 = _fread( _clist( 0, 1, 3, 10, ierr, Null_Arg, t$267,  _substr(t$266,1,7), Null_Arg, Null_Arg, Null_Arg, 0x2000200000000L, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(line,1,100), 0x800600000000L ), _iotype(  _substr(line2,1,100), 0x800600000000L ) ) )
   77.          if (  _substr(line,1,10) == 'NBYTE     ' ) then
   77.             _fread( _clist( 0, 0, 3,  _substr(line2,1,4), Null_Arg, Null_Arg, t$269,  _substr(t$268,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( nbyte, 0x2000200000000L ) ) )
   77.          else if (  _substr(line,1,10) == 'NFCTDY    ' ) then
   77.             _fread( _clist( 0, 0, 3,  _substr(line2,1,4), Null_Arg, Null_Arg, t$271,  _substr(t$270,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( nfctdy, 0x2000200000000L ) ) )
   77.          else if (  _substr(line,1,10) == 'FREQCALC  ' ) then
   77.             _fread( _clist( 0, 0, 3,  _substr(line2,1,4), Null_Arg, Null_Arg, t$273,  _substr(t$272,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( freqcalc, 0x2000200000000L ) ) )
   77.          else if (  _substr(line,1,10) == 'MEMB      ' ) then
   77.             _fread( _clist( 0, 0, 3,  _substr(line2,1,4), Null_Arg, Null_Arg, t$275,  _substr(t$274,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( nmembers, 0x2000200000000L ) ) )
   77.          else if (  _substr(line,1,10) == 'IMAX      ' ) then
   77.             _fread( _clist( 0, 0, 3,  _substr(line2,1,4), Null_Arg, Null_Arg, t$277,  _substr(t$276,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( imax, 0x2000200000000L ) ) )
   77.          else if (  _substr(line,1,10) == 'JMAX      ' ) then
   77.             _fread( _clist( 0, 0, 3,  _substr(line2,1,4), Null_Arg, Null_Arg, t$279,  _substr(t$278,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( jmax, 0x2000200000000L ) ) )
   77.          else if (  _substr(line,1,10) == 'DATAINDIR ' ) then
   77.              _substr(dirin,1,100) =  _substr(line2,1,100)
   77.          else if (  _substr(line,1,10) == 'DATAOUTDIR' ) then
   77.              _substr(dirout,1,100) =  _substr(line2,1,100)
   77.          else if (  _substr(line,1,10) == 'RESOL     ' ) then
   77.              _substr(resol,1,200) =  _substr(line2,1,100)
   77.          else if (  _substr(line,1,10) == 'PREFX     ' ) then
   77.              _substr(prefx,1,200) =  _substr(line2,1,100)
   77.          endif
   77.          if ( ierr /= 0 ) exit
   77.       enddo
   78.       t$12 = 10
   78.       t$17(1) = 0x100000000000000L
   78. !dir$ suppress t$12
   78.       t$17(2) = int( loc( t$12 ), 8 )
   78.       t$17(3) = 0
   78.       t$17(4) = 0
   78.       t$17(5) = 0
   78.       t$17(7) = 0
   78.       t$17(8) = 0
   78.       t$16 = _close( t$17 )
   80.       _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'nbyte   : ', 0x800600000000L ), _iotype( nbyte, 0x2000200000000L ) ) )
   81.       _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'nfctdy  : ', 0x800600000000L ), _iotype( nfctdy, 0x2000200000000L ) ) )
   82.       _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'freqcalc: ', 0x800600000000L ), _iotype( freqcalc, 0x2000200000000L ) ) )
   83.       _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'nmembers: ', 0x800600000000L ), _iotype( nmembers, 0x2000200000000L ) ) )
   84.       _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'imax    : ', 0x800600000000L ), _iotype( imax, 0x2000200000000L ) ) )
   85.       _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'jmax    : ', 0x800600000000L ), _iotype( jmax, 0x2000200000000L ) ) )
   86.       _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'dirin   : ', 0x800600000000L ), _iotype(  _substr(dirin,1,100), 0x800600000000L ) ) )
   87.       _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'dirout  : ', 0x800600000000L ), _iotype(  _substr(dirout,1,100), 0x800600000000L ) ) )
   88.       _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'resol   : ', 0x800600000000L ), _iotype(  _substr(resol,1,200), 0x800600000000L ) ) )
   89.       _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'prefx   : ', 0x800600000000L ), _iotype(  _substr(prefx,1,200), 0x800600000000L ) ) )
   91.       if ( freqcalc > 24 ) then
   91.           _substr(t$18,1,38) = 'Main Program: freqcalc must be .LE. 24'
   91.          call _stop(  _substr(t$18,1,38) )
   91.       else if ( mod( 24, freqcalc ) /= 0 ) then
   94.           _substr(t$19,1,65) = 'Main Program: freqcalc must be a divisor of 24. Ex.: 6, 12 and 24'
   94.          call _stop(  _substr(t$19,1,65) )
   94.       else
   96.          $noutpday_S1 = 24 / freqcalc
   99.          ngrbs = 2 + nfctdy * $noutpday_S1
  100.          nxny = imax * jmax
  101.          nbits = 8 * nbyte
  105.          fctdate%header%a_contig = 1
  105.          fctdate%dim_1%LB = 1
  105.          fctdate%dim_1%EX = ( max( 0, 2 + nfctdy * $noutpday_S1 ) )
  105.          fctdate%dim_1%SM = 10
  105.          $_allo_P0(0) = 0x1000000000001L
  105.          $_allo_P0(1) = loc( fctdate )
  105.          call __allocate( $_allo_P0, ierr, 0x2000200000000L, _fcd( 0, 0 ) )
  106.          if ( ierr /= 0 ) then
  106.              _substr(t$20,1,36) = 'DOES NOT ALLOCATE CORRECTLY: fctdate'
  106.             call _stop(  _substr(t$20,1,36) )
  106.          else
  107.             lstinctl%header%a_contig = 1
  107.             lstinctl%dim_1%LB = 1
  107.             lstinctl%dim_1%EX = ( max( 0, nmembers ) )
  107.             lstinctl%dim_1%SM = 200
  107.             lstinctl%dim_2%LB = 1
  107.             lstinctl%dim_2%EX = ( max( 0, 2 + nfctdy * $noutpday_S1 ) )
  107.             lstinctl%dim_2%SM = ( 200 * max( 0, nmembers ) )
  107.             $_allo_P1(0) = 0x1000000000001L
  107.             $_allo_P1(1) = loc( lstinctl )
  107.             call __allocate( $_allo_P1, ierr, 0x2000200000000L, _fcd( 0, 0 ) )
  108.             if ( ierr /= 0 ) then
  108.                 _substr(t$21,1,38) = 'DOES NOT ALLOCATE CORRECTLY: lstinctl '
  108.                call _stop(  _substr(t$21,1,38) )
  108.             else
  109.                lstingrb%header%a_contig = 1
  109.                lstingrb%dim_1%LB = 1
  109.                lstingrb%dim_1%EX = ( max( 0, nmembers ) )
  109.                lstingrb%dim_1%SM = 200
  109.                lstingrb%dim_2%LB = 1
  109.                lstingrb%dim_2%EX = ( max( 0, 2 + nfctdy * $noutpday_S1 ) )
  109.                lstingrb%dim_2%SM = ( 200 * max( 0, nmembers ) )
  109.                $_allo_P2(0) = 0x1000000000001L
  109.                $_allo_P2(1) = loc( lstingrb )
  109.                call __allocate( $_allo_P2, ierr, 0x2000200000000L, _fcd( 0, 0 ) )
  110.                if ( ierr /= 0 ) then
  110.                    _substr(t$22,1,38) = 'DOES NOT ALLOCATE CORRECTLY: lstingrb '
  110.                   call _stop(  _substr(t$22,1,38) )
  110.                else
  111.                   lstoutctl%header%a_contig = 1
  111.                   lstoutctl%dim_1%LB = 1
  111.                   lstoutctl%dim_1%EX = ( max( 0, 2 + nfctdy * $noutpday_S1 ) )
  111.                   lstoutctl%dim_1%SM = 200
  111.                   $_allo_P3(0) = 0x1000000000001L
  111.                   $_allo_P3(1) = loc( lstoutctl )
  111.                   call __allocate( $_allo_P3, ierr, 0x2000200000000L, _fcd( 0, 0 ) )
  112.                   if ( ierr /= 0 ) then
  112.                       _substr(t$23,1,39) = 'DOES NOT ALLOCATE CORRECTLY: lstoutctl '
  112.                      call _stop(  _substr(t$23,1,39) )
  112.                   else
  113.                      lstoutgrb%header%a_contig = 1
  113.                      lstoutgrb%dim_1%LB = 1
  113.                      lstoutgrb%dim_1%EX = ( max( 0, 2 + nfctdy * $noutpday_S1 ) )
  113.                      lstoutgrb%dim_1%SM = 200
  113.                      $_allo_P4(0) = 0x1000000000001L
  113.                      $_allo_P4(1) = loc( lstoutgrb )
  113.                      call __allocate( $_allo_P4, ierr, 0x2000200000000L, _fcd( 0, 0 ) )
  114.                      if ( ierr /= 0 ) then
  114.                          _substr(t$24,1,39) = 'DOES NOT ALLOCATE CORRECTLY: lstoutgrb '
  114.                         call _stop(  _substr(t$24,1,39) )
  114.                      else
  115.                         tmp%header%a_contig = 1
  115.                         tmp%dim_1%LB = 1
  115.                         tmp%dim_1%EX = ( max( 0, imax * jmax ) )
  115.                         tmp%dim_1%SM = 1
  115.                         $_allo_P5(0) = 0x1000000000001L
  115.                         $_allo_P5(1) = loc( tmp )
  115.                         call __allocate( $_allo_P5, ierr, 0x2000200000000L, _fcd( 0, 0 ) )
  116.                         if ( ierr /= 0 ) then
  116.                             _substr(t$25,1,32) = 'DOES NOT ALLOCATE CORRECTLY: tmp'
  116.                            call _stop(  _substr(t$25,1,32) )
  116.                         else
  117.                            bitmap%header%a_contig = 1
  117.                            bitmap%dim_1%LB = 1
  117.                            bitmap%dim_1%EX = ( max( 0, imax * jmax ) )
  117.                            bitmap%dim_1%SM = 1
  117.                            $_allo_P6(0) = 0x1000000000001L
  117.                            $_allo_P6(1) = loc( bitmap )
  117.                            call __allocate( $_allo_P6, ierr, 0x2000200000000L, _fcd( 0, 0 ) )
  118.                            if ( ierr /= 0 ) then
  118.                                _substr(t$26,1,35) = 'DOES NOT ALLOCATE CORRECTLY: bitmap'
  118.                               call _stop(  _substr(t$26,1,35) )
  118.                            else
  119.                               varsmed%header%a_contig = 1
  119.                               varsmed%dim_1%LB = 1
  119.                               varsmed%dim_1%EX = ( max( 0, imax * jmax ) )
  119.                               varsmed%dim_1%SM = 1
  119.                               $_allo_P7(0) = 0x1000000000001L
  119.                               $_allo_P7(1) = loc( varsmed )
  119.                               call __allocate( $_allo_P7, ierr, 0x2000200000000L, _fcd( 0, 0 ) )
  120.                               if ( ierr /= 0 ) then
  120.                                   _substr(t$27,1,36) = 'DOES NOT ALLOCATE CORRECTLY: varsmed'
  120.                                  call _stop(  _substr(t$27,1,36) )
  120.                               else
  124.                                  call caldate(  _substr(anldate,1,10), ngrbs, freqcalc,  _substr((fctdate%base_addr)(_dv_lb( fctdate, 1 ), 0),1,10) )
  128.                                  call getlstgrb(  _substr(anldate,1,10),  _substr((fctdate%base_addr)(_dv_lb( fctdate, 1 ), 0),1,10), ngrbs, nmembers,  _substr(prefx,1,200),  _substr(resol,1,200),  _substr((lstinctl%base_addr)(_dv_lb( lstinctl, 1 ), _dv_lb( lstinctl, 2 ), 0),1,200),  _substr((lstingrb%base_addr)(_dv_lb( lstingrb, 1 ), _dv_lb( lstingrb, 2 ), 0),1,200),  _substr((lstoutctl%base_addr)(_dv_lb( lstoutctl, 1 ), 0),1,200),  _substr((lstoutgrb%base_addr)(_dv_lb( lstoutgrb, 1 ), 0),1,200),  _substr(lstoutlst,1,200) )
  133.                                  t$28 = ( _ltrim(  _substr(dirout,1,100) ) ) + ( _ltrim(  _substr(lstoutlst,1,200) ) )
  133.                                  t$30 = int( _alloc( max( 0, t$28 ) ), 8 )
  133.                                   _substr(t$29,1,max( 0, t$28 )) = //(  _substr(dirout,1,_ltrim(  _substr(dirout,1,100) )),  _substr(lstoutlst,1,_ltrim(  _substr(lstoutlst,1,200) )) )
  133.                                  _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'FILE10: ', 0x800600000000L ), _iotype(  _substr(t$29,1,max( 0, t$28 )), 0x800600000000L ) ) )
  133.                                  _free( t$30 )
  134.                                  t$12 = 10
  134.                                  t$32 = ( _ltrim(  _substr(dirout,1,100) ) ) + ( _ltrim(  _substr(lstoutlst,1,200) ) )
  134.                                  t$34 = int( _alloc( max( 0, t$32 ) ), 8 )
  134.                                   _substr(t$33,1,max( 0, t$32 )) = //(  _substr(dirout,1,_ltrim(  _substr(dirout,1,100) )),  _substr(lstoutlst,1,_ltrim(  _substr(lstoutlst,1,200) )) )
  134.                                   _substr(t$35,1,7) = 'UNKNOWN'
  134.                                   _substr(t$36,1,9) = 'FORMATTED'
  134.                                  t$37(1) = 0x100000000000000L
  134. !dir$ suppress t$12
  134.                                  t$37(2) = int( loc( t$12 ), 8 )
  134.                                  t$37(3) = 0
  134.                                  t$37(4) = 0
  134. !dir$ suppress  _substr(t$33,1,max( 0, t$32 ))
  134.                                  t$37(5) = int( loc(  _substr(t$33,1,max( 0, t$32 )) ), 8 )
  134.                                  t$37(6) = ( max( 0, t$32 ) )
  134. !dir$ suppress  _substr(t$35,1,7)
  134.                                  t$37(7) = int( loc(  _substr(t$35,1,7) ), 8 )
  134.                                  t$37(8) = 7
  134.                                  t$37(9) = 0
  134. !dir$ suppress  _substr(t$36,1,9)
  134.                                  t$37(11) = int( loc(  _substr(t$36,1,9) ), 8 )
  134.                                  t$37(12) = 9
  134.                                  t$37(13) = 0
  134.                                  t$37(14) = 0
  134.                                  t$37(16) = 0
  134.                                  t$37(18) = 0
  134.                                  t$37(20) = 0
  134.                                  t$37(22) = 0
  134.                                  t$37(24) = 0
  134.                                  t$37(25) = 0
  134.                                  t$37(27) = 0
  134.                                  t$37(29) = 0
  134.                                  t$37(31) = 0
  134.                                  t$37(33) = 0
  134.                                  t$37(35) = 0
  134.                                  t$31 = _open( t$37 )
  134.                                  _free( t$34 )
  135.                                  if ( ngrbs > 0 ) then
  135.                                     $I_L135_20 = 0
  135.                                     do
  136.                                        if ( ( 1 + $I_L135_20 < _dv_lb( lstoutctl, 1 ) .or. ( 1 + $I_L135_20 ) > -1 + _dv_lb( lstoutctl, 1 ) + _dv_ex( lstoutctl, 1 ) ) /= .false. ) then
  136.                                            _substr(t$42,1,11) = 'ensmed.f90'
  136.                                            _substr(t$43,1,10) = 'LSTOUTCTL'
  136.                                           t$12 = _dv_lb( lstoutctl, 1 )
  136.                                           t$44 = -1 + _dv_lb( lstoutctl, 1 ) + _dv_ex( lstoutctl, 1 )
  136.                                           t$45 = 1 + $I_L135_20
  136.                                           call _bounds_error(  _substr(t$42,1,11), 636,  _substr(t$43,1,10), 1, t$12, t$44, t$45, t$41 )
  136.                                        endif
  136.                                        if ( ( 1 + $I_L135_20 < _dv_lb( lstoutctl, 1 ) .or. ( 1 + $I_L135_20 ) > -1 + _dv_lb( lstoutctl, 1 ) + _dv_ex( lstoutctl, 1 ) ) /= .false. ) then
  136.                                            _substr(t$47,1,11) = 'ensmed.f90'
  136.                                            _substr(t$48,1,10) = 'LSTOUTCTL'
  136.                                           t$49 = _dv_lb( lstoutctl, 1 )
  136.                                           t$50 = -1 + _dv_lb( lstoutctl, 1 ) + _dv_ex( lstoutctl, 1 )
  136.                                           t$51 = 1 + $I_L135_20
  136.                                           call _bounds_error(  _substr(t$47,1,11), 636,  _substr(t$48,1,10), 1, t$49, t$50, t$51, t$46 )
  136.                                        endif
  136.                                        if ( ( 1 + $I_L135_20 < _dv_lb( lstoutctl, 1 ) .or. ( 1 + $I_L135_20 ) > -1 + _dv_lb( lstoutctl, 1 ) + _dv_ex( lstoutctl, 1 ) ) /= .false. ) then
  136.                                            _substr(t$53,1,11) = 'ensmed.f90'
  136.                                            _substr(t$54,1,10) = 'LSTOUTCTL'
  136.                                           t$55 = _dv_lb( lstoutctl, 1 )
  136.                                           t$56 = -1 + _dv_lb( lstoutctl, 1 ) + _dv_ex( lstoutctl, 1 )
  136.                                           t$57 = 1 + $I_L135_20
  136.                                           call _bounds_error(  _substr(t$53,1,11), 636,  _substr(t$54,1,10), 1, t$55, t$56, t$57, t$52 )
  136.                                        endif
  136.                                        _fwrite( _clist( 0, 0, 3, 10, Null_Arg, Null_Arg, t$5,  _substr(t$4,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr((lstoutctl%base_addr)(1 + $I_L135_20, 0),1,_ltrim(  _substr((lstoutctl%base_addr)(1 + $I_L135_20, 0),1,200) )), 0x800600000000L ) ) )
  137.                                        if ( ( 1 + $I_L135_20 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $I_L135_20 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  137.                                            _substr(t$59,1,11) = 'ensmed.f90'
  137.                                            _substr(t$60,1,10) = 'LSTOUTGRB'
  137.                                           t$12 = _dv_lb( lstoutgrb, 1 )
  137.                                           t$44 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  137.                                           t$45 = 1 + $I_L135_20
  137.                                           call _bounds_error(  _substr(t$59,1,11), 637,  _substr(t$60,1,10), 1, t$12, t$44, t$45, t$58 )
  137.                                        endif
  137.                                        if ( ( 1 + $I_L135_20 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $I_L135_20 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  137.                                            _substr(t$62,1,11) = 'ensmed.f90'
  137.                                            _substr(t$63,1,10) = 'LSTOUTGRB'
  137.                                           t$49 = _dv_lb( lstoutgrb, 1 )
  137.                                           t$50 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  137.                                           t$51 = 1 + $I_L135_20
  137.                                           call _bounds_error(  _substr(t$62,1,11), 637,  _substr(t$63,1,10), 1, t$49, t$50, t$51, t$61 )
  137.                                        endif
  137.                                        if ( ( 1 + $I_L135_20 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $I_L135_20 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  137.                                            _substr(t$65,1,11) = 'ensmed.f90'
  137.                                            _substr(t$66,1,10) = 'LSTOUTGRB'
  137.                                           t$55 = _dv_lb( lstoutgrb, 1 )
  137.                                           t$56 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  137.                                           t$57 = 1 + $I_L135_20
  137.                                           call _bounds_error(  _substr(t$65,1,11), 637,  _substr(t$66,1,10), 1, t$55, t$56, t$57, t$64 )
  137.                                        endif
  137.                                        _fwrite( _clist( 0, 0, 3, 10, Null_Arg, Null_Arg, t$7,  _substr(t$6,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr((lstoutgrb%base_addr)(1 + $I_L135_20, 0),1,_ltrim(  _substr((lstoutgrb%base_addr)(1 + $I_L135_20, 0),1,200) )), 0x800600000000L ) ) )
  138.                                        $I_L135_20 = 1 + $I_L135_20
  138.                                        if ( $I_L135_20 >= ngrbs ) exit
  138.                                     enddo
  138.                                  endif
  139.                                  t$12 = 10
  139.                                  t$68(1) = 0x100000000000000L
  139. !dir$ suppress t$12
  139.                                  t$68(2) = int( loc( t$12 ), 8 )
  139.                                  t$68(3) = 0
  139.                                  t$68(4) = 0
  139.                                  t$68(5) = 0
  139.                                  t$68(7) = 0
  139.                                  t$68(8) = 0
  139.                                  t$67 = _close( t$68 )
  141.                                  if ( numproc <= ngrbs ) then
  142.                                     $ngrbslocal_S2 = ngrbs / numproc
  143.                                     $restlocal_S4 = ngrbs + -( numproc * $ngrbslocal_S2 )
  149.                                     if ( thisproc < ngrbs + -( numproc * $ngrbslocal_S2 ) ) then
  151.                                        $restlocal_S4 = 0
  150.                                        $ngrbslocal_S2 = 1 + $ngrbslocal_S2
  150.                                     endif
  156.                                     if ( $ngrbslocal_S2 > 0 ) then
  156.                                        $I_L156_28 = 0
  156.                                        do
  157.                                           if ( ( nmembers < _dv_lb( lstinctl, 1 ) .or. nmembers > -1 + _dv_lb( lstinctl, 1 ) + _dv_ex( lstinctl, 1 ) ) /= .false. ) then
  157.                                               _substr(t$75,1,11) = 'ensmed.f90'
  157.                                               _substr(t$76,1,9) = 'LSTINCTL'
  157.                                              t$44 = _dv_lb( lstinctl, 1 )
  157.                                              t$45 = -1 + _dv_lb( lstinctl, 1 ) + _dv_ex( lstinctl, 1 )
  157.                                              t$49 = nmembers
  157.                                              call _bounds_error(  _substr(t$75,1,11), 657,  _substr(t$76,1,9), 1, t$44, t$45, t$49, t$74 )
  157.                                           endif
  157.                                           if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstinctl, 2 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstinctl, 2 ) + _dv_ex( lstinctl, 2 ) ) /= .false. ) then
  157.                                               _substr(t$78,1,11) = 'ensmed.f90'
  157.                                               _substr(t$79,1,9) = 'LSTINCTL'
  157.                                              t$50 = _dv_lb( lstinctl, 2 )
  157.                                              t$51 = -1 + _dv_lb( lstinctl, 2 ) + _dv_ex( lstinctl, 2 )
  157.                                              t$55 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  157.                                              call _bounds_error(  _substr(t$78,1,11), 657,  _substr(t$79,1,9), 2, t$50, t$51, t$55, t$77 )
  157.                                           endif
  157.                                           if ( ( nmembers < _dv_lb( lstinctl, 1 ) .or. nmembers > -1 + _dv_lb( lstinctl, 1 ) + _dv_ex( lstinctl, 1 ) ) /= .false. ) then
  157.                                               _substr(t$81,1,11) = 'ensmed.f90'
  157.                                               _substr(t$82,1,9) = 'LSTINCTL'
  157.                                              t$56 = _dv_lb( lstinctl, 1 )
  157.                                              t$57 = -1 + _dv_lb( lstinctl, 1 ) + _dv_ex( lstinctl, 1 )
  157.                                              t$12 = nmembers
  157.                                              call _bounds_error(  _substr(t$81,1,11), 657,  _substr(t$82,1,9), 1, t$56, t$57, t$12, t$80 )
  157.                                           endif
  157.                                           if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstinctl, 2 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstinctl, 2 ) + _dv_ex( lstinctl, 2 ) ) /= .false. ) then
  157.                                               _substr(t$84,1,11) = 'ensmed.f90'
  157.                                               _substr(t$85,1,9) = 'LSTINCTL'
  157.                                              t$86 = _dv_lb( lstinctl, 2 )
  157.                                              t$87 = -1 + _dv_lb( lstinctl, 2 ) + _dv_ex( lstinctl, 2 )
  157.                                              t$88 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  157.                                              call _bounds_error(  _substr(t$84,1,11), 657,  _substr(t$85,1,9), 2, t$86, t$87, t$88, t$83 )
  157.                                           endif
  157.                                           if ( ( nmembers < _dv_lb( lstinctl, 1 ) .or. nmembers > -1 + _dv_lb( lstinctl, 1 ) + _dv_ex( lstinctl, 1 ) ) /= .false. ) then
  157.                                               _substr(t$90,1,11) = 'ensmed.f90'
  157.                                               _substr(t$91,1,9) = 'LSTINCTL'
  157.                                              t$92 = _dv_lb( lstinctl, 1 )
  157.                                              t$93 = -1 + _dv_lb( lstinctl, 1 ) + _dv_ex( lstinctl, 1 )
  157.                                              t$94 = nmembers
  157.                                              call _bounds_error(  _substr(t$90,1,11), 657,  _substr(t$91,1,9), 1, t$92, t$93, t$94, t$89 )
  157.                                           endif
  157.                                           if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstinctl, 2 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstinctl, 2 ) + _dv_ex( lstinctl, 2 ) ) /= .false. ) then
  157.                                               _substr(t$96,1,11) = 'ensmed.f90'
  157.                                               _substr(t$97,1,9) = 'LSTINCTL'
  157.                                              t$98 = _dv_lb( lstinctl, 2 )
  157.                                              t$99 = -1 + _dv_lb( lstinctl, 2 ) + _dv_ex( lstinctl, 2 )
  157.                                              t$100 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  157.                                              call _bounds_error(  _substr(t$96,1,11), 657,  _substr(t$97,1,9), 2, t$98, t$99, t$100, t$95 )
  157.                                           endif
  157.                                           t$101 = ( _ltrim(  _substr(dirin,1,100) ) ) + ( _ltrim(  _substr((lstinctl%base_addr)(nmembers, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  157.                                           t$103 = int( _alloc( max( 0, t$101 ) ), 8 )
  157.                                            _substr(t$102,1,max( 0, t$101 )) = //(  _substr(dirin,1,_ltrim(  _substr(dirin,1,100) )),  _substr((lstinctl%base_addr)(nmembers, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstinctl%base_addr)(nmembers, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  157.                                           _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'FILE11: ', 0x800600000000L ), _iotype(  _substr(t$102,1,max( 0, t$101 )), 0x800600000000L ) ) )
  157.                                           _free( t$103 )
  158.                                           t$44 = 11
  158.                                           t$105 = ( _ltrim(  _substr(dirin,1,100) ) ) + ( _ltrim(  _substr((lstinctl%base_addr)(nmembers, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  158.                                           t$107 = int( _alloc( max( 0, t$105 ) ), 8 )
  158.                                            _substr(t$106,1,max( 0, t$105 )) = //(  _substr(dirin,1,_ltrim(  _substr(dirin,1,100) )),  _substr((lstinctl%base_addr)(nmembers, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstinctl%base_addr)(nmembers, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  158.                                            _substr(t$108,1,7) = 'UNKNOWN'
  158.                                            _substr(t$109,1,9) = 'FORMATTED'
  158.                                           t$110(1) = 0x100000000000000L
  158. !dir$ suppress t$44
  158.                                           t$110(2) = int( loc( t$44 ), 8 )
  158.                                           t$110(3) = 0
  158.                                           t$110(4) = 0
  158. !dir$ suppress  _substr(t$106,1,max( 0, t$105 ))
  158.                                           t$110(5) = int( loc(  _substr(t$106,1,max( 0, t$105 )) ), 8 )
  158.                                           t$110(6) = ( max( 0, t$105 ) )
  158. !dir$ suppress  _substr(t$108,1,7)
  158.                                           t$110(7) = int( loc(  _substr(t$108,1,7) ), 8 )
  158.                                           t$110(8) = 7
  158.                                           t$110(9) = 0
  158. !dir$ suppress  _substr(t$109,1,9)
  158.                                           t$110(11) = int( loc(  _substr(t$109,1,9) ), 8 )
  158.                                           t$110(12) = 9
  158.                                           t$110(13) = 0
  158.                                           t$110(14) = 0
  158.                                           t$110(16) = 0
  158.                                           t$110(18) = 0
  158.                                           t$110(20) = 0
  158.                                           t$110(22) = 0
  158.                                           t$110(24) = 0
  158.                                           t$110(25) = 0
  158.                                           t$110(27) = 0
  158.                                           t$110(29) = 0
  158.                                           t$110(31) = 0
  158.                                           t$110(33) = 0
  158.                                           t$110(35) = 0
  158.                                           t$104 = _open( t$110 )
  158.                                           _free( t$107 )
  159.                                           if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutctl, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutctl, 1 ) + _dv_ex( lstoutctl, 1 ) ) /= .false. ) then
  159.                                               _substr(t$112,1,11) = 'ensmed.f90'
  159.                                               _substr(t$113,1,10) = 'LSTOUTCTL'
  159.                                              t$45 = _dv_lb( lstoutctl, 1 )
  159.                                              t$49 = -1 + _dv_lb( lstoutctl, 1 ) + _dv_ex( lstoutctl, 1 )
  159.                                              t$50 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  159.                                              call _bounds_error(  _substr(t$112,1,11), 659,  _substr(t$113,1,10), 1, t$45, t$49, t$50, t$111 )
  159.                                           endif
  159.                                           if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutctl, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutctl, 1 ) + _dv_ex( lstoutctl, 1 ) ) /= .false. ) then
  159.                                               _substr(t$115,1,11) = 'ensmed.f90'
  159.                                               _substr(t$116,1,10) = 'LSTOUTCTL'
  159.                                              t$51 = _dv_lb( lstoutctl, 1 )
  159.                                              t$55 = -1 + _dv_lb( lstoutctl, 1 ) + _dv_ex( lstoutctl, 1 )
  159.                                              t$56 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  159.                                              call _bounds_error(  _substr(t$115,1,11), 659,  _substr(t$116,1,10), 1, t$51, t$55, t$56, t$114 )
  159.                                           endif
  159.                                           if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutctl, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutctl, 1 ) + _dv_ex( lstoutctl, 1 ) ) /= .false. ) then
  159.                                               _substr(t$118,1,11) = 'ensmed.f90'
  159.                                               _substr(t$119,1,10) = 'LSTOUTCTL'
  159.                                              t$57 = _dv_lb( lstoutctl, 1 )
  159.                                              t$12 = -1 + _dv_lb( lstoutctl, 1 ) + _dv_ex( lstoutctl, 1 )
  159.                                              t$86 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  159.                                              call _bounds_error(  _substr(t$118,1,11), 659,  _substr(t$119,1,10), 1, t$57, t$12, t$86, t$117 )
  159.                                           endif
  159.                                           t$120 = ( _ltrim(  _substr(dirout,1,100) ) ) + ( _ltrim(  _substr((lstoutctl%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  159.                                           t$122 = int( _alloc( max( 0, t$120 ) ), 8 )
  159.                                            _substr(t$121,1,max( 0, t$120 )) = //(  _substr(dirout,1,_ltrim(  _substr(dirout,1,100) )),  _substr((lstoutctl%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstoutctl%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  159.                                           _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'FILE19: ', 0x800600000000L ), _iotype(  _substr(t$121,1,max( 0, t$120 )), 0x800600000000L ) ) )
  159.                                           _free( t$122 )
  160.                                           t$87 = 19
  160.                                           t$124 = ( _ltrim(  _substr(dirout,1,100) ) ) + ( _ltrim(  _substr((lstoutctl%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  160.                                           t$126 = int( _alloc( max( 0, t$124 ) ), 8 )
  160.                                            _substr(t$125,1,max( 0, t$124 )) = //(  _substr(dirout,1,_ltrim(  _substr(dirout,1,100) )),  _substr((lstoutctl%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstoutctl%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  160.                                            _substr(t$127,1,7) = 'UNKNOWN'
  160.                                            _substr(t$128,1,9) = 'FORMATTED'
  160.                                           t$129(1) = 0x100000000000000L
  160. !dir$ suppress t$87
  160.                                           t$129(2) = int( loc( t$87 ), 8 )
  160.                                           t$129(3) = 0
  160.                                           t$129(4) = 0
  160. !dir$ suppress  _substr(t$125,1,max( 0, t$124 ))
  160.                                           t$129(5) = int( loc(  _substr(t$125,1,max( 0, t$124 )) ), 8 )
  160.                                           t$129(6) = ( max( 0, t$124 ) )
  160. !dir$ suppress  _substr(t$127,1,7)
  160.                                           t$129(7) = int( loc(  _substr(t$127,1,7) ), 8 )
  160.                                           t$129(8) = 7
  160.                                           t$129(9) = 0
  160. !dir$ suppress  _substr(t$128,1,9)
  160.                                           t$129(11) = int( loc(  _substr(t$128,1,9) ), 8 )
  160.                                           t$129(12) = 9
  160.                                           t$129(13) = 0
  160.                                           t$129(14) = 0
  160.                                           t$129(16) = 0
  160.                                           t$129(18) = 0
  160.                                           t$129(20) = 0
  160.                                           t$129(22) = 0
  160.                                           t$129(24) = 0
  160.                                           t$129(25) = 0
  160.                                           t$129(27) = 0
  160.                                           t$129(29) = 0
  160.                                           t$129(31) = 0
  160.                                           t$129(33) = 0
  160.                                           t$129(35) = 0
  160.                                           t$123 = _open( t$129 )
  160.                                           _free( t$126 )
  161.                                           t$488 = 200
  161.                                           lname = _ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )
  161.                                           t$489 = 6 + ( _ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  161.                                           t$491 = int( _alloc( max( 0, t$489 ) ), 8 )
  161.                                            _substr(t$490,1,max( 0, t$489 )) = //( 'dset ^',  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  161.                                           _fwrite( _clist( 0, 0, 3, 19, Null_Arg, Null_Arg, t$473,  _substr(t$472,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(t$490,1,max( 0, t$489 )), 0x800600000000L ) ) )
  161.                                           _free( t$491 )
  161.                                           _fwrite( _clist( 0, 0, 3, 19, Null_Arg, Null_Arg, t$475,  _substr(t$474,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( '*', 0x800600000000L ) ) )
  161.                                           t$492 = 11 + max( 0, -4 + lname )
  161.                                           t$494 = int( _alloc( max( 0, 11 + max( 0, -4 + lname ) ) ), 8 )
  161.                                            _substr(t$493,1,max( 0, 11 + max( 0, -4 + lname ) )) = //( 'index ^', //(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,max( 0, -4 + lname )), '.idx' ) )
  161.                                           _fwrite( _clist( 0, 0, 3, 19, Null_Arg, Null_Arg, t$477,  _substr(t$476,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(t$493,1,max( 0, 11 + max( 0, -4 + lname ) )), 0x800600000000L ) ) )
  161.                                           _free( t$494 )
  161.                                           _fread( _clist( 0, 0, 3, 11, Null_Arg, Null_Arg, t$479,  _substr(t$478,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(line,1,256), 0x800600000000L ) ) )
  161.                                           _fread( _clist( 0, 0, 3, 11, Null_Arg, Null_Arg, t$481,  _substr(t$480,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(line,1,256), 0x800600000000L ) ) )
  161.                                           _fread( _clist( 0, 0, 3, 11, Null_Arg, Null_Arg, t$483,  _substr(t$482,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(line,1,256), 0x800600000000L ) ) )
  161.                                           do
  161.                                              t$495 = _fread( _clist( 0, 1, 3, 11, ierr, Null_Arg, t$485,  _substr(t$484,1,3), Null_Arg, Null_Arg, Null_Arg, 0x2000200000000L, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(line,1,256), 0x800600000000L ) ) )
  161.                                              if ( ierr /= 0 ) goto 10
  161.                                           enddo
  161.    10                                     continue
  162.                                           t$88 = 11
  162.                                           t$131(1) = 0x100000000000000L
  162. !dir$ suppress t$88
  162.                                           t$131(2) = int( loc( t$88 ), 8 )
  162.                                           t$131(3) = 0
  162.                                           t$131(4) = 0
  162.                                           t$131(5) = 0
  162.                                           t$131(7) = 0
  162.                                           t$131(8) = 0
  162.                                           t$130 = _close( t$131 )
  163.                                           t$92 = 19
  163.                                           t$133(1) = 0x100000000000000L
  163. !dir$ suppress t$92
  163.                                           t$133(2) = int( loc( t$92 ), 8 )
  163.                                           t$133(3) = 0
  163.                                           t$133(4) = 0
  163.                                           t$133(5) = 0
  163.                                           t$133(7) = 0
  163.                                           t$133(8) = 0
  163.                                           t$132 = _close( t$133 )
  164.                                           if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  164.                                               _substr(t$135,1,11) = 'ensmed.f90'
  164.                                               _substr(t$136,1,10) = 'LSTOUTGRB'
  164.                                              t$93 = _dv_lb( lstoutgrb, 1 )
  164.                                              t$94 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  164.                                              t$98 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  164.                                              call _bounds_error(  _substr(t$135,1,11), 664,  _substr(t$136,1,10), 1, t$93, t$94, t$98, t$134 )
  164.                                           endif
  164.                                           if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  164.                                               _substr(t$138,1,11) = 'ensmed.f90'
  164.                                               _substr(t$139,1,10) = 'LSTOUTGRB'
  164.                                              t$99 = _dv_lb( lstoutgrb, 1 )
  164.                                              t$100 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  164.                                              t$44 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  164.                                              call _bounds_error(  _substr(t$138,1,11), 664,  _substr(t$139,1,10), 1, t$99, t$100, t$44, t$137 )
  164.                                           endif
  164.                                           if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  164.                                               _substr(t$141,1,11) = 'ensmed.f90'
  164.                                               _substr(t$142,1,10) = 'LSTOUTGRB'
  164.                                              t$45 = _dv_lb( lstoutgrb, 1 )
  164.                                              t$49 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  164.                                              t$50 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  164.                                              call _bounds_error(  _substr(t$141,1,11), 664,  _substr(t$142,1,10), 1, t$45, t$49, t$50, t$140 )
  164.                                           endif
  164.                                           t$143 = ( _ltrim(  _substr(dirout,1,100) ) ) + ( _ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  164.                                           t$145 = int( _alloc( max( 0, t$143 ) ), 8 )
  164.                                            _substr(t$144,1,max( 0, t$143 )) = //(  _substr(dirout,1,_ltrim(  _substr(dirout,1,100) )),  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  164.                                           _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'FILE20: ', 0x800600000000L ), _iotype(  _substr(t$144,1,max( 0, t$143 )), 0x800600000000L ) ) )
  164.                                           _free( t$145 )
  165.                                           t$146 = ( _ltrim(  _substr(dirout,1,100) ) ) + ( _ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  165.                                           t$148 = int( _alloc( max( 0, t$146 ) ), 8 )
  165.                                            _substr(t$147,1,max( 0, t$146 )) = //(  _substr(dirout,1,_ltrim(  _substr(dirout,1,100) )),  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  165.                                           call baopen( 20,  _substr(t$147,1,max( 0, t$146 )), ierr )
  165.                                           _free( t$148 )
  166.                                           if ( ierr /= 0 ) then
  167.                                              if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  167.                                                  _substr(t$150,1,11) = 'ensmed.f90'
  167.                                                  _substr(t$151,1,10) = 'LSTOUTGRB'
  167.                                                 t$51 = _dv_lb( lstoutgrb, 1 )
  167.                                                 t$55 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  167.                                                 t$56 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  167.                                                 call _bounds_error(  _substr(t$150,1,11), 667,  _substr(t$151,1,10), 1, t$51, t$55, t$56, t$149 )
  167.                                              endif
  167.                                              if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  167.                                                  _substr(t$153,1,11) = 'ensmed.f90'
  167.                                                  _substr(t$154,1,10) = 'LSTOUTGRB'
  167.                                                 t$57 = _dv_lb( lstoutgrb, 1 )
  167.                                                 t$12 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  167.                                                 t$86 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  167.                                                 call _bounds_error(  _substr(t$153,1,11), 667,  _substr(t$154,1,10), 1, t$57, t$12, t$86, t$152 )
  167.                                              endif
  167.                                              if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  167.                                                  _substr(t$156,1,11) = 'ensmed.f90'
  167.                                                  _substr(t$157,1,10) = 'LSTOUTGRB'
  167.                                                 t$87 = _dv_lb( lstoutgrb, 1 )
  167.                                                 t$88 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  167.                                                 t$92 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  167.                                                 call _bounds_error(  _substr(t$156,1,11), 667,  _substr(t$157,1,10), 1, t$87, t$88, t$92, t$155 )
  167.                                              endif
  167.                                              t$158 = ( _ltrim(  _substr(dirout,1,100) ) ) + ( _ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  167.                                              t$160 = int( _alloc( max( 0, t$158 ) ), 8 )
  167.                                               _substr(t$159,1,max( 0, t$158 )) = //(  _substr(dirout,1,_ltrim(  _substr(dirout,1,100) )),  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  167.                                              _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'STOP BAOPEN TROUBLE  File: ', 0x800600000000L ), _iotype( 20, 0x2000200000000L ), _iotype(  _substr(t$159,1,max( 0, t$158 )), 0x800600000000L ), _iotype( '  ierr:', 0x800600000000L ), _iotype( ierr, 0x2000200000000L ) ) )
  167.                                              _free( t$160 )
  168.                                               _substr(t$161,1,4) = ' '
  168.                                              call _stop(  _substr(t$161,1,1) )
  168.                                              goto 50
  168.                                           endif
  170.                                           if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  170.                                               _substr(t$163,1,11) = 'ensmed.f90'
  170.                                               _substr(t$164,1,10) = 'LSTOUTGRB'
  170.                                              t$93 = _dv_lb( lstoutgrb, 1 )
  170.                                              t$94 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  170.                                              t$98 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  170.                                              call _bounds_error(  _substr(t$163,1,11), 670,  _substr(t$164,1,10), 1, t$93, t$94, t$98, t$162 )
  170.                                           endif
  170.                                           if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  170.                                               _substr(t$166,1,11) = 'ensmed.f90'
  170.                                               _substr(t$167,1,10) = 'LSTOUTGRB'
  170.                                              t$99 = _dv_lb( lstoutgrb, 1 )
  170.                                              t$100 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  170.                                              t$44 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  170.                                              call _bounds_error(  _substr(t$166,1,11), 670,  _substr(t$167,1,10), 1, t$99, t$100, t$44, t$165 )
  170.                                           endif
  170.                                           if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  170.                                               _substr(t$169,1,11) = 'ensmed.f90'
  170.                                               _substr(t$170,1,10) = 'LSTOUTGRB'
  170.                                              t$45 = _dv_lb( lstoutgrb, 1 )
  170.                                              t$49 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  170.                                              t$50 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  170.                                              call _bounds_error(  _substr(t$169,1,11), 670,  _substr(t$170,1,10), 1, t$45, t$49, t$50, t$168 )
  170.                                           endif
  170.                                           t$171 = ( _ltrim(  _substr(dirout,1,100) ) ) + ( _ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  170.                                           t$173 = int( _alloc( max( 0, t$171 ) ), 8 )
  170.                                            _substr(t$172,1,max( 0, t$171 )) = //(  _substr(dirout,1,_ltrim(  _substr(dirout,1,100) )),  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  170.                                           _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'BAOPEN OK  File: ', 0x800600000000L ), _iotype( 20, 0x2000200000000L ), _iotype(  _substr(t$172,1,max( 0, t$171 )), 0x800600000000L ), _iotype( '  ierr:', 0x800600000000L ), _iotype( ierr, 0x2000200000000L ) ) )
  170.                                           _free( t$173 )
  172.                                           if ( nmembers > 0 ) then
  172.                                              $I_L172_22 = 0
  172.                                              do
  173.                                                 t$177 = ( 21 + $I_L172_22 )
  173.                                                 t$178 = ( _ltrim(  _substr(dirin,1,100) ) ) + ( _ltrim(  _substr((lstingrb%base_addr)(1 + $I_L172_22, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  173.                                                 t$180 = int( _alloc( max( 0, t$178 ) ), 8 )
  173.                                                  _substr(t$179,1,max( 0, t$178 )) = //(  _substr(dirin,1,_ltrim(  _substr(dirin,1,100) )),  _substr((lstingrb%base_addr)(1 + $I_L172_22, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstingrb%base_addr)(1 + $I_L172_22, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  173.                                                 call baopen( t$177,  _substr(t$179,1,max( 0, t$178 )), ierr )
  173.                                                 _free( t$180 )
  174.                                                 if ( ierr /= 0 ) then
  175.                                                    if ( ( 1 + $I_L172_22 < _dv_lb( lstingrb, 1 ) .or. ( 1 + $I_L172_22 ) > -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 ) ) /= .false. ) then
  175.                                                        _substr(t$182,1,11) = 'ensmed.f90'
  175.                                                        _substr(t$183,1,9) = 'LSTINGRB'
  175.                                                       t$51 = _dv_lb( lstingrb, 1 )
  175.                                                       t$55 = -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 )
  175.                                                       t$56 = 1 + $I_L172_22
  175.                                                       call _bounds_error(  _substr(t$182,1,11), 675,  _substr(t$183,1,9), 1, t$51, t$55, t$56, t$181 )
  175.                                                    endif
  175.                                                    if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstingrb, 2 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 ) ) /= .false. ) then
  175.                                                        _substr(t$185,1,11) = 'ensmed.f90'
  175.                                                        _substr(t$186,1,9) = 'LSTINGRB'
  175.                                                       t$57 = _dv_lb( lstingrb, 2 )
  175.                                                       t$12 = -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 )
  175.                                                       t$86 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  175.                                                       call _bounds_error(  _substr(t$185,1,11), 675,  _substr(t$186,1,9), 2, t$57, t$12, t$86, t$184 )
  175.                                                    endif
  175.                                                    if ( ( 1 + $I_L172_22 < _dv_lb( lstingrb, 1 ) .or. ( 1 + $I_L172_22 ) > -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 ) ) /= .false. ) then
  175.                                                        _substr(t$188,1,11) = 'ensmed.f90'
  175.                                                        _substr(t$189,1,9) = 'LSTINGRB'
  175.                                                       t$87 = _dv_lb( lstingrb, 1 )
  175.                                                       t$88 = -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 )
  175.                                                       t$92 = 1 + $I_L172_22
  175.                                                       call _bounds_error(  _substr(t$188,1,11), 675,  _substr(t$189,1,9), 1, t$87, t$88, t$92, t$187 )
  175.                                                    endif
  175.                                                    if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstingrb, 2 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 ) ) /= .false. ) then
  175.                                                        _substr(t$191,1,11) = 'ensmed.f90'
  175.                                                        _substr(t$192,1,9) = 'LSTINGRB'
  175.                                                       t$93 = _dv_lb( lstingrb, 2 )
  175.                                                       t$94 = -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 )
  175.                                                       t$98 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  175.                                                       call _bounds_error(  _substr(t$191,1,11), 675,  _substr(t$192,1,9), 2, t$93, t$94, t$98, t$190 )
  175.                                                    endif
  175.                                                    if ( ( 1 + $I_L172_22 < _dv_lb( lstingrb, 1 ) .or. ( 1 + $I_L172_22 ) > -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 ) ) /= .false. ) then
  175.                                                        _substr(t$194,1,11) = 'ensmed.f90'
  175.                                                        _substr(t$195,1,9) = 'LSTINGRB'
  175.                                                       t$99 = _dv_lb( lstingrb, 1 )
  175.                                                       t$100 = -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 )
  175.                                                       t$44 = 1 + $I_L172_22
  175.                                                       call _bounds_error(  _substr(t$194,1,11), 675,  _substr(t$195,1,9), 1, t$99, t$100, t$44, t$193 )
  175.                                                    endif
  175.                                                    if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstingrb, 2 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 ) ) /= .false. ) then
  175.                                                        _substr(t$197,1,11) = 'ensmed.f90'
  175.                                                        _substr(t$198,1,9) = 'LSTINGRB'
  175.                                                       t$45 = _dv_lb( lstingrb, 2 )
  175.                                                       t$49 = -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 )
  175.                                                       t$50 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  175.                                                       call _bounds_error(  _substr(t$197,1,11), 675,  _substr(t$198,1,9), 2, t$45, t$49, t$50, t$196 )
  175.                                                    endif
  175.                                                    t$199 = ( _ltrim(  _substr(dirin,1,100) ) ) + ( _ltrim(  _substr((lstingrb%base_addr)(1 + $I_L172_22, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  175.                                                    t$201 = int( _alloc( max( 0, t$199 ) ), 8 )
  175.                                                     _substr(t$200,1,max( 0, t$199 )) = //(  _substr(dirin,1,_ltrim(  _substr(dirin,1,100) )),  _substr((lstingrb%base_addr)(1 + $I_L172_22, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstingrb%base_addr)(1 + $I_L172_22, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  175.                                                    $IOitem_O1 = ( 21 + $I_L172_22 )
  175.                                                    _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'STOP BAOPEN TROUBLE  File:', 0x800600000000L ), _iotype( $IOitem_O1, 0x2000200000000L ), _iotype(  _substr(t$200,1,max( 0, t$199 )), 0x800600000000L ), _iotype( '  ierr:', 0x800600000000L ), _iotype( ierr, 0x2000200000000L ) ) )
  175.                                                    _free( t$201 )
  176.                                                     _substr(t$202,1,4) = ' '
  176.                                                    call _stop(  _substr(t$202,1,1) )
  176.                                                    goto 50
  176.                                                 endif
  178.                                                 if ( ( 1 + $I_L172_22 < _dv_lb( lstingrb, 1 ) .or. ( 1 + $I_L172_22 ) > -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 ) ) /= .false. ) then
  178.                                                     _substr(t$204,1,11) = 'ensmed.f90'
  178.                                                     _substr(t$205,1,9) = 'LSTINGRB'
  178.                                                    t$51 = _dv_lb( lstingrb, 1 )
  178.                                                    t$55 = -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 )
  178.                                                    t$56 = 1 + $I_L172_22
  178.                                                    call _bounds_error(  _substr(t$204,1,11), 678,  _substr(t$205,1,9), 1, t$51, t$55, t$56, t$203 )
  178.                                                 endif
  178.                                                 if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstingrb, 2 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 ) ) /= .false. ) then
  178.                                                     _substr(t$207,1,11) = 'ensmed.f90'
  178.                                                     _substr(t$208,1,9) = 'LSTINGRB'
  178.                                                    t$57 = _dv_lb( lstingrb, 2 )
  178.                                                    t$12 = -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 )
  178.                                                    t$86 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  178.                                                    call _bounds_error(  _substr(t$207,1,11), 678,  _substr(t$208,1,9), 2, t$57, t$12, t$86, t$206 )
  178.                                                 endif
  178.                                                 if ( ( 1 + $I_L172_22 < _dv_lb( lstingrb, 1 ) .or. ( 1 + $I_L172_22 ) > -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 ) ) /= .false. ) then
  178.                                                     _substr(t$210,1,11) = 'ensmed.f90'
  178.                                                     _substr(t$211,1,9) = 'LSTINGRB'
  178.                                                    t$87 = _dv_lb( lstingrb, 1 )
  178.                                                    t$88 = -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 )
  178.                                                    t$92 = 1 + $I_L172_22
  178.                                                    call _bounds_error(  _substr(t$210,1,11), 678,  _substr(t$211,1,9), 1, t$87, t$88, t$92, t$209 )
  178.                                                 endif
  178.                                                 if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstingrb, 2 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 ) ) /= .false. ) then
  178.                                                     _substr(t$213,1,11) = 'ensmed.f90'
  178.                                                     _substr(t$214,1,9) = 'LSTINGRB'
  178.                                                    t$93 = _dv_lb( lstingrb, 2 )
  178.                                                    t$94 = -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 )
  178.                                                    t$98 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  178.                                                    call _bounds_error(  _substr(t$213,1,11), 678,  _substr(t$214,1,9), 2, t$93, t$94, t$98, t$212 )
  178.                                                 endif
  178.                                                 if ( ( 1 + $I_L172_22 < _dv_lb( lstingrb, 1 ) .or. ( 1 + $I_L172_22 ) > -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 ) ) /= .false. ) then
  178.                                                     _substr(t$216,1,11) = 'ensmed.f90'
  178.                                                     _substr(t$217,1,9) = 'LSTINGRB'
  178.                                                    t$99 = _dv_lb( lstingrb, 1 )
  178.                                                    t$100 = -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 )
  178.                                                    t$44 = 1 + $I_L172_22
  178.                                                    call _bounds_error(  _substr(t$216,1,11), 678,  _substr(t$217,1,9), 1, t$99, t$100, t$44, t$215 )
  178.                                                 endif
  178.                                                 if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstingrb, 2 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 ) ) /= .false. ) then
  178.                                                     _substr(t$219,1,11) = 'ensmed.f90'
  178.                                                     _substr(t$220,1,9) = 'LSTINGRB'
  178.                                                    t$45 = _dv_lb( lstingrb, 2 )
  178.                                                    t$49 = -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 )
  178.                                                    t$50 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  178.                                                    call _bounds_error(  _substr(t$219,1,11), 678,  _substr(t$220,1,9), 2, t$45, t$49, t$50, t$218 )
  178.                                                 endif
  178.                                                 t$221 = ( _ltrim(  _substr(dirin,1,100) ) ) + ( _ltrim(  _substr((lstingrb%base_addr)(1 + $I_L172_22, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  178.                                                 t$223 = int( _alloc( max( 0, t$221 ) ), 8 )
  178.                                                  _substr(t$222,1,max( 0, t$221 )) = //(  _substr(dirin,1,_ltrim(  _substr(dirin,1,100) )),  _substr((lstingrb%base_addr)(1 + $I_L172_22, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstingrb%base_addr)(1 + $I_L172_22, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  178.                                                 $IOitem_O0 = ( 21 + $I_L172_22 )
  178.                                                 _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'BAOPEN OK  File:', 0x800600000000L ), _iotype( $IOitem_O0, 0x2000200000000L ), _iotype(  _substr(t$222,1,max( 0, t$221 )), 0x800600000000L ), _iotype( '  ierr:', 0x800600000000L ), _iotype( ierr, 0x2000200000000L ) ) )
  178.                                                 _free( t$223 )
  180.                                                 $I_L172_22 = 1 + $I_L172_22
  179.                                                 if ( $I_L172_22 >= nmembers ) exit
  179.                                              enddo
  179.                                              goto 20
  179.                                           else
  179.    20                                        continue
  182.                                              iseek = 0
  182.                                              do
  185.                                                 $F_A33 = ( max( 0, imax * jmax ) )
  185.                                                 if ( imax * jmax > 0 ) then
  185.                                                    $I_A1 = 0
  185. !dir$ ivdep
  185.                                                    do
  185.                                                       (varsmed%base_addr)(1 + $I_A1, 0) = 0.0
  185.                                                       $I_A1 = 1 + $I_A1
  185.                                                       if ( $I_A1 >= $F_A33 ) exit
  185.                                                    enddo
  185.                                                 endif
  186.                                                 if ( nmembers > 0 ) then
  186.                                                    $I_L186_24 = 0
  186.                                                    do
  187.                                                       t$177 = ( 21 + $I_L186_24 )
  187.                                                       call skgb( t$177, iseek, 32000, lskip, lgrib )
  188.                                                       if ( lgrib == 0 ) exit
  189.                                                       t$177 = ( 21 + $I_L186_24 )
  189.                                                       call getgb1r( t$177, lskip, lgrib, nxny, kpds(1), kgds(1), kens(1), (bitmap%base_addr)(1, 0), (tmp%base_addr)(1, 0), ierr )
  190.                                                       if ( ierr /= 0 ) exit
  193.                                                       $F_A34 = ( max( 0, imax * jmax ) )
  193.                                                       if ( imax * jmax > 0 ) then
  193.                                                          $I_A1 = 0
  193. !dir$ ivdep
  193.                                                          do
  193.                                                             (varsmed%base_addr)(1 + $I_A1, 0) = (varsmed%base_addr)(1 + $I_A1, 0) + (tmp%base_addr)(1 + $I_A1, 0)
  193.                                                             $I_A1 = 1 + $I_A1
  193.                                                             if ( $I_A1 >= $F_A34 ) exit
  193.                                                          enddo
  193.                                                       endif
  194.                                                       $I_L186_24 = 1 + $I_L186_24
  194.                                                       if ( $I_L186_24 >= nmembers ) exit
  194.                                                    enddo
  194.                                                 endif
  195.                                                 if ( lgrib == 0 ) then
  208.                                                    call baclose( 20, ierr )
  209.                                                    if ( ierr /= 0 ) then
  210.                                                       if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  210.                                                           _substr(t$229,1,11) = 'ensmed.f90'
  210.                                                           _substr(t$230,1,10) = 'LSTOUTGRB'
  210.                                                          t$51 = _dv_lb( lstoutgrb, 1 )
  210.                                                          t$55 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  210.                                                          t$56 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  210.                                                          call _bounds_error(  _substr(t$229,1,11), 710,  _substr(t$230,1,10), 1, t$51, t$55, t$56, t$228 )
  210.                                                       endif
  210.                                                       if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  210.                                                           _substr(t$232,1,11) = 'ensmed.f90'
  210.                                                           _substr(t$233,1,10) = 'LSTOUTGRB'
  210.                                                          t$57 = _dv_lb( lstoutgrb, 1 )
  210.                                                          t$12 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  210.                                                          t$86 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  210.                                                          call _bounds_error(  _substr(t$232,1,11), 710,  _substr(t$233,1,10), 1, t$57, t$12, t$86, t$231 )
  210.                                                       endif
  210.                                                       if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstoutgrb, 1 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 ) ) /= .false. ) then
  210.                                                           _substr(t$235,1,11) = 'ensmed.f90'
  210.                                                           _substr(t$236,1,10) = 'LSTOUTGRB'
  210.                                                          t$87 = _dv_lb( lstoutgrb, 1 )
  210.                                                          t$88 = -1 + _dv_lb( lstoutgrb, 1 ) + _dv_ex( lstoutgrb, 1 )
  210.                                                          t$92 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  210.                                                          call _bounds_error(  _substr(t$235,1,11), 710,  _substr(t$236,1,10), 1, t$87, t$88, t$92, t$234 )
  210.                                                       endif
  210.                                                       t$237 = ( _ltrim(  _substr(dirout,1,100) ) ) + ( _ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  210.                                                       t$239 = int( _alloc( max( 0, t$237 ) ), 8 )
  210.                                                        _substr(t$238,1,max( 0, t$237 )) = //(  _substr(dirout,1,_ltrim(  _substr(dirout,1,100) )),  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstoutgrb%base_addr)(1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  210.                                                       _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'STOP BACLOSE TROUBLE  File: 20', 0x800600000000L ), _iotype(  _substr(t$238,1,max( 0, t$237 )), 0x800600000000L ), _iotype( '  ierr:', 0x800600000000L ), _iotype( ierr, 0x2000200000000L ) ) )
  210.                                                       _free( t$239 )
  211.                                                        _substr(t$240,1,4) = ' '
  211.                                                       call _stop(  _substr(t$240,1,1) )
  211.                                                    else if ( nmembers > 0 ) then
  214.                                                       $I_L214_26 = 0
  214.                                                       do
  215.                                                          t$177 = ( 21 + $I_L214_26 )
  215.                                                          call baclose( t$177, ierr )
  216.                                                          if ( ierr /= 0 ) then
  217.                                                             if ( ( 1 + $I_L214_26 < _dv_lb( lstingrb, 1 ) .or. ( 1 + $I_L214_26 ) > -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 ) ) /= .false. ) then
  217.                                                                 _substr(t$245,1,11) = 'ensmed.f90'
  217.                                                                 _substr(t$246,1,9) = 'LSTINGRB'
  217.                                                                t$93 = _dv_lb( lstingrb, 1 )
  217.                                                                t$94 = -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 )
  217.                                                                t$98 = 1 + $I_L214_26
  217.                                                                call _bounds_error(  _substr(t$245,1,11), 717,  _substr(t$246,1,9), 1, t$93, t$94, t$98, t$244 )
  217.                                                             endif
  217.                                                             if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstingrb, 2 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 ) ) /= .false. ) then
  217.                                                                 _substr(t$248,1,11) = 'ensmed.f90'
  217.                                                                 _substr(t$249,1,9) = 'LSTINGRB'
  217.                                                                t$99 = _dv_lb( lstingrb, 2 )
  217.                                                                t$100 = -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 )
  217.                                                                t$44 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  217.                                                                call _bounds_error(  _substr(t$248,1,11), 717,  _substr(t$249,1,9), 2, t$99, t$100, t$44, t$247 )
  217.                                                             endif
  217.                                                             if ( ( 1 + $I_L214_26 < _dv_lb( lstingrb, 1 ) .or. ( 1 + $I_L214_26 ) > -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 ) ) /= .false. ) then
  217.                                                                 _substr(t$251,1,11) = 'ensmed.f90'
  217.                                                                 _substr(t$252,1,9) = 'LSTINGRB'
  217.                                                                t$45 = _dv_lb( lstingrb, 1 )
  217.                                                                t$49 = -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 )
  217.                                                                t$50 = 1 + $I_L214_26
  217.                                                                call _bounds_error(  _substr(t$251,1,11), 717,  _substr(t$252,1,9), 1, t$45, t$49, t$50, t$250 )
  217.                                                             endif
  217.                                                             if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstingrb, 2 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 ) ) /= .false. ) then
  217.                                                                 _substr(t$254,1,11) = 'ensmed.f90'
  217.                                                                 _substr(t$255,1,9) = 'LSTINGRB'
  217.                                                                t$51 = _dv_lb( lstingrb, 2 )
  217.                                                                t$55 = -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 )
  217.                                                                t$56 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  217.                                                                call _bounds_error(  _substr(t$254,1,11), 717,  _substr(t$255,1,9), 2, t$51, t$55, t$56, t$253 )
  217.                                                             endif
  217.                                                             if ( ( 1 + $I_L214_26 < _dv_lb( lstingrb, 1 ) .or. ( 1 + $I_L214_26 ) > -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 ) ) /= .false. ) then
  217.                                                                 _substr(t$257,1,11) = 'ensmed.f90'
  217.                                                                 _substr(t$258,1,9) = 'LSTINGRB'
  217.                                                                t$57 = _dv_lb( lstingrb, 1 )
  217.                                                                t$12 = -1 + _dv_lb( lstingrb, 1 ) + _dv_ex( lstingrb, 1 )
  217.                                                                t$86 = 1 + $I_L214_26
  217.                                                                call _bounds_error(  _substr(t$257,1,11), 717,  _substr(t$258,1,9), 1, t$57, t$12, t$86, t$256 )
  217.                                                             endif
  217.                                                             if ( ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 < _dv_lb( lstingrb, 2 ) .or. ( 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2 ) > -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 ) ) /= .false. ) then
  217.                                                                 _substr(t$260,1,11) = 'ensmed.f90'
  217.                                                                 _substr(t$261,1,9) = 'LSTINGRB'
  217.                                                                t$87 = _dv_lb( lstingrb, 2 )
  217.                                                                t$88 = -1 + _dv_lb( lstingrb, 2 ) + _dv_ex( lstingrb, 2 )
  217.                                                                t$92 = 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2
  217.                                                                call _bounds_error(  _substr(t$260,1,11), 717,  _substr(t$261,1,9), 2, t$87, t$88, t$92, t$259 )
  217.                                                             endif
  217.                                                             t$262 = ( _ltrim(  _substr(dirin,1,100) ) ) + ( _ltrim(  _substr((lstingrb%base_addr)(1 + $I_L214_26, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) ) )
  217.                                                             t$264 = int( _alloc( max( 0, t$262 ) ), 8 )
  217.                                                              _substr(t$263,1,max( 0, t$262 )) = //(  _substr(dirin,1,_ltrim(  _substr(dirin,1,100) )),  _substr((lstingrb%base_addr)(1 + $I_L214_26, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,_ltrim(  _substr((lstingrb%base_addr)(1 + $I_L214_26, 1 + $restlocal_S4 + $I_L156_28 + thisproc * $ngrbslocal_S2, 0),1,200) )) )
  217.                                                             $IOitem_O2 = ( 21 + $I_L214_26 )
  217.                                                             _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'STOP BACLOSE TROUBLE  File:', 0x800600000000L ), _iotype( $IOitem_O2, 0x2000200000000L ), _iotype(  _substr(t$263,1,max( 0, t$262 )), 0x800600000000L ), _iotype( '  ierr:', 0x800600000000L ), _iotype( ierr, 0x2000200000000L ) ) )
  217.                                                             _free( t$264 )
  218.                                                              _substr(t$265,1,4) = ' '
  218.                                                             call _stop(  _substr(t$265,1,1) )
  218.                                                             goto 50
  218.                                                          endif
  220.                                                          $I_L214_26 = 1 + $I_L214_26
  220.                                                          if ( $I_L214_26 >= nmembers ) exit
  220.                                                       enddo
  220.                                                       goto 30
  220.                                                    else
  220.    30                                                 continue
  221.                                                       $I_L156_28 = 1 + $I_L156_28
  221.                                                       if ( $I_L156_28 >= $ngrbslocal_S2 ) then
  220.                                                          goto 40
  220.                                                       endif
  220.                                                    endif
  220.                                                 endif
  196.                                                 $F_A35 = ( max( 0, imax * jmax ) )
  196.                                                 if ( imax * jmax > 0 ) then
  196.                                                    $I_A1 = 0
  196. !dir$ ivdep
  196.                                                    do
  196.                                                       (varsmed%base_addr)(1 + $I_A1, 0) = ( (varsmed%base_addr)(1 + $I_A1, 0) * 1.0/( real( nmembers ) ) )
  196.                                                       $I_A1 = 1 + $I_A1
  196.                                                       if ( $I_A1 >= $F_A35 ) exit
  196.                                                    enddo
  196.                                                 endif
  197.                                                 _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'putgben:', 0x800600000000L ), _iotype( nbits, 0x2000200000000L ) ) )
  199.                                                 call putgben( 20, nxny, kpds(1), kgds(1), kens(1), 0, nbits, (bitmap%base_addr)(1, 0), (varsmed%base_addr)(1, 0), ierr )
  200.                                                 if ( ierr /= 0 ) then
  201.                                                    _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'PUTGBEN failed!  ierr=', 0x800600000000L ), _iotype( ierr, 0x2000200000000L ) ) )
  202.                                                     _substr(t$227,1,10) = 'WRITE_GRIB'
  202.                                                    call _stop(  _substr(t$227,1,10) )
  202.                                                    goto 50
  202.                                                 endif
  202.                                              enddo
  202.                                           endif
  202.                                        else
  202.    40                                     continue
  222.                                           if ( fctdate%header%assoc == 1 ) then
  222.                                              $_allo_P8(0) = 0x1000000000001L
  222.                                              $_allo_P8(1) = loc( fctdate )
  222.                                              call __deallocate( $_allo_P8, 0, 0, _fcd( 0, 0 ) )
  222.                                              fctdate%header%assoc = 0
  222.                                           endif
  223.                                           if ( lstoutctl%header%assoc == 1 ) then
  223.                                              $_allo_P9(0) = 0x1000000000001L
  223.                                              $_allo_P9(1) = loc( lstoutctl )
  223.                                              call __deallocate( $_allo_P9, 0, 0, _fcd( 0, 0 ) )
  223.                                              lstoutctl%header%assoc = 0
  223.                                           endif
  224.                                           if ( lstoutgrb%header%assoc == 1 ) then
  224.                                              $_allo_P10(0) = 0x1000000000001L
  224.                                              $_allo_P10(1) = loc( lstoutgrb )
  224.                                              call __deallocate( $_allo_P10, 0, 0, _fcd( 0, 0 ) )
  224.                                              lstoutgrb%header%assoc = 0
  224.                                           endif
  225.                                           if ( lstinctl%header%assoc == 1 ) then
  225.                                              $_allo_P11(0) = 0x1000000000001L
  225.                                              $_allo_P11(1) = loc( lstinctl )
  225.                                              call __deallocate( $_allo_P11, 0, 0, _fcd( 0, 0 ) )
  225.                                              lstinctl%header%assoc = 0
  225.                                           endif
  226.                                           if ( lstingrb%header%assoc == 1 ) then
  226.                                              $_allo_P12(0) = 0x1000000000001L
  226.                                              $_allo_P12(1) = loc( lstingrb )
  226.                                              call __deallocate( $_allo_P12, 0, 0, _fcd( 0, 0 ) )
  226.                                              lstingrb%header%assoc = 0
  226.                                           endif
  227.                                           if ( tmp%header%assoc == 1 ) then
  227.                                              $_allo_P13(0) = 0x1000000000001L
  227.                                              $_allo_P13(1) = loc( tmp )
  227.                                              call __deallocate( $_allo_P13, 0, 0, _fcd( 0, 0 ) )
  227.                                              tmp%header%assoc = 0
  227.                                           endif
  228.                                           if ( varsmed%header%assoc == 1 ) then
  228.                                              $_allo_P14(0) = 0x1000000000001L
  228.                                              $_allo_P14(1) = loc( varsmed )
  228.                                              call __deallocate( $_allo_P14, 0, 0, _fcd( 0, 0 ) )
  228.                                              varsmed%header%assoc = 0
  228.                                           endif
  229.                                           if ( bitmap%header%assoc == 1 ) then
  229.                                              $_allo_P15(0) = 0x1000000000001L
  229.                                              $_allo_P15(1) = loc( bitmap )
  229.                                              call __deallocate( $_allo_P15, 0, 0, _fcd( 0, 0 ) )
  229.                                              bitmap%header%assoc = 0
  229.                                           endif
  230.                                           call mpi_finalize( ierr )
  232.                                           call _end
  232.                                        endif
  232.                                     else
  145.                                        call mpi_finalize( ierr )
  146.                                         _substr(t$69,1,72) = 'The number of CPU or Process can not be greater than the number of ngrbs'
  146.                                        call _stop(  _substr(t$69,1,72) )
  146.                                     endif
  146.                                  endif
  146.                               endif
  146.                            endif
  146.                         endif
  146.                      endif
  146.                   endif
  146.                endif
  146.             endif
  146.          endif
  146.    50    continue
  232.          return
  232.       end
  232.       
  242.       
  242.       subroutine attribute( unit, nbyte, nfctdy, freqcalc, nmembers, imax, jmax, dirin, dirout, resol, prefx )
  242.       t$280 = _len( dirin )
  242.       t$281 = _len( dirout )
  242.       t$282 = _len( resol )
  242.       t$283 = _len( prefx )
  254.       ierr = 0
  254.       do
  258.          $Unit_temp_O0 = unit
  258.          t$284 = _fread( _clist( 0, 1, 3, $Unit_temp_O0, ierr, Null_Arg, t$267,  _substr(t$266,1,7), Null_Arg, Null_Arg, Null_Arg, 0x2000200000000L, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(line,1,100), 0x800600000000L ), _iotype(  _substr(line2,1,100), 0x800600000000L ) ) )
  259.          if (  _substr(line,1,10) == 'NBYTE     ' ) then
  260.             _fread( _clist( 0, 0, 3,  _substr(line2,1,4), Null_Arg, Null_Arg, t$269,  _substr(t$268,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( nbyte, 0x2000200000000L ) ) )
  261.          else if (  _substr(line,1,10) == 'NFCTDY    ' ) then
  262.             _fread( _clist( 0, 0, 3,  _substr(line2,1,4), Null_Arg, Null_Arg, t$271,  _substr(t$270,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( nfctdy, 0x2000200000000L ) ) )
  262.          else if (  _substr(line,1,10) == 'FREQCALC  ' ) then
  264.             _fread( _clist( 0, 0, 3,  _substr(line2,1,4), Null_Arg, Null_Arg, t$273,  _substr(t$272,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( freqcalc, 0x2000200000000L ) ) )
  264.          else if (  _substr(line,1,10) == 'MEMB      ' ) then
  266.             _fread( _clist( 0, 0, 3,  _substr(line2,1,4), Null_Arg, Null_Arg, t$275,  _substr(t$274,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( nmembers, 0x2000200000000L ) ) )
  266.          else if (  _substr(line,1,10) == 'IMAX      ' ) then
  268.             _fread( _clist( 0, 0, 3,  _substr(line2,1,4), Null_Arg, Null_Arg, t$277,  _substr(t$276,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( imax, 0x2000200000000L ) ) )
  268.          else if (  _substr(line,1,10) == 'JMAX      ' ) then
  270.             _fread( _clist( 0, 0, 3,  _substr(line2,1,4), Null_Arg, Null_Arg, t$279,  _substr(t$278,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( jmax, 0x2000200000000L ) ) )
  270.          else if (  _substr(line,1,10) == 'DATAINDIR ' ) then
  272.              _substr(dirin,1,_len( dirin )) =  _substr(line2,1,100)
  272.          else if (  _substr(line,1,10) == 'DATAOUTDIR' ) then
  274.              _substr(dirout,1,_len( dirout )) =  _substr(line2,1,100)
  274.          else if (  _substr(line,1,10) == 'RESOL     ' ) then
  276.              _substr(resol,1,_len( resol )) =  _substr(line2,1,100)
  276.          else if (  _substr(line,1,10) == 'PREFX     ' ) then
  278.              _substr(prefx,1,_len( prefx )) =  _substr(line2,1,100)
  278.          endif
  279.          if ( ierr /= 0 ) exit
  279.       enddo
  284.       return
  284.       end
  284.       
  295.       
  295.       subroutine caldate( anldate, ngrbs, freqcalc, fctdate )
  295.       t$285 = ngrbs
  301.       t$308 = _zla( 0, ngrbs )
  315.       _fread( _clist( 0, 0, 3,  _substr(anldate,1,4), Null_Arg, Null_Arg, t$287,  _substr(t$286,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( iyy, 0x2000200000000L ) ) )
  316.       _fread( _clist( 0, 0, 3,  _substr(anldate,5,2), Null_Arg, Null_Arg, t$289,  _substr(t$288,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( imm, 0x2000200000000L ) ) )
  317.       _fread( _clist( 0, 0, 3,  _substr(anldate,7,2), Null_Arg, Null_Arg, t$291,  _substr(t$290,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( idd, 0x2000200000000L ) ) )
  318.       _fread( _clist( 0, 0, 3,  _substr(anldate,9,2), Null_Arg, Null_Arg, t$293,  _substr(t$292,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( ihh, 0x2000200000000L ) ) )
  323.       if ( freqcalc > 24 ) then
  323.           _substr(t$309,1,56) = 'Caldate: variable inthour must be less or equal 24 hours'
  323.          call _stop(  _substr(t$309,1,56) )
  323.       else
  325.          _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, t$295,  _substr(t$294,1,5), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'FCT DATES:', 0x800600000000L ) ) )
  328.          if ( mod( iyy, 4 ) == 0 ) then
  329.             $lastd_S0 = monlb(imm)
  329.          else
  331.             $lastd_S0 = monl(imm)
  331.          endif
  335.          $_IOitem_P0(0) = iyy
  335.          $_IOitem_P0(1) = imm
  335.          $_IOitem_P0(2) = idd
  335.          $_IOitem_P0(3) = ihh
  335.          _fwrite( _clist( 0, 0, 3,  _substr(datep,1,10), Null_Arg, Null_Arg, t$297,  _substr(t$296,1,12), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( (&)$_IOitem_P0(:( 0, 3, 1 )), 0x2000200000000L ) ) )
  336.           _substr(fctdate(1),1,10) =  _substr(datep,1,10)
  337.          if ( ngrbs <= 0 ) then
  337.              _substr(t$311,1,11) = 'ensmed.f90'
  337.              _substr(t$312,1,8) = 'FCTDATE'
  337.             call _bounds_error(  _substr(t$311,1,11), 837,  _substr(t$312,1,8), 1, 1, t$285, 1, t$310 )
  337.          endif
  337.          _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, t$299,  _substr(t$298,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'fctdate(1):', 0x800600000000L ), _iotype(  _substr(fctdate(1),1,10), 0x800600000000L ) ) )
  340.          $_IOitem_P1(0) = iyy
  340.          $_IOitem_P1(1) = imm
  340.          $_IOitem_P1(2) = idd
  340.          $_IOitem_P1(3) = ihh
  340.          _fwrite( _clist( 0, 0, 3,  _substr(datep,1,10), Null_Arg, Null_Arg, t$301,  _substr(t$300,1,12), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( (&)$_IOitem_P1(:( 0, 3, 1 )), 0x2000200000000L ) ) )
  341.           _substr(fctdate(2),1,10) =  _substr(datep,1,10)
  342.          if ( 2 > t$285 ) then
  342.              _substr(t$314,1,11) = 'ensmed.f90'
  342.              _substr(t$315,1,8) = 'FCTDATE'
  342.             call _bounds_error(  _substr(t$314,1,11), 842,  _substr(t$315,1,8), 1, 1, t$285, 2, t$313 )
  342.          endif
  342.          _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, t$303,  _substr(t$302,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'fctdate(2):', 0x800600000000L ), _iotype(  _substr(fctdate(2),1,10), 0x800600000000L ) ) )
  344.          if ( -3 + ngrbs >= 0 ) then
  344.             $I_L344_4 = 0
  344.             do
  346.                ihh = ihh + freqcalc
  347.                if ( ihh >= 24 ) then
  349.                   idd = 1 + idd
  348.                   ihh = -24 + ihh
  350.                   if ( idd > $lastd_S0 ) then
  351.                      idd = 1
  352.                      imm = 1 + imm
  353.                      if ( imm > 12 ) then
  354.                         imm = 1
  355.                         iyy = 1 + iyy
  355.                      endif
  358.                      if ( mod( iyy, 4 ) == 0 ) then
  359.                         $lastd_S0 = monlb(imm)
  359.                      else
  361.                         $lastd_S0 = monl(imm)
  361.                      endif
  361.                   endif
  361.                endif
  366.                $_IOitem_P2(0) = iyy
  366.                $_IOitem_P2(1) = imm
  366.                $_IOitem_P2(2) = idd
  366.                $_IOitem_P2(3) = ihh
  366.                _fwrite( _clist( 0, 0, 3,  _substr(datep,1,10), Null_Arg, Null_Arg, t$305,  _substr(t$304,1,12), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( (&)$_IOitem_P2(:( 0, 3, 1 )), 0x2000200000000L ) ) )
  367.                 _substr(fctdate(3 + $I_L344_4),1,10) =  _substr(datep,1,10)
  369.                if ( ( ( 3 + $I_L344_4 ) <= 0 .or. ( 3 + $I_L344_4 ) > t$285 ) /= .false. ) then
  369.                    _substr(t$320,1,11) = 'ensmed.f90'
  369.                    _substr(t$321,1,8) = 'FCTDATE'
  369.                   t$322 = 3 + $I_L344_4
  369.                   call _bounds_error(  _substr(t$320,1,11), 869,  _substr(t$321,1,8), 1, 1, t$285, t$322, t$319 )
  369.                endif
  369.                $IOitem_O0 = ( 3 + $I_L344_4 )
  369.                _fwrite( _clist( 0, 0, 3, Null_Arg, Null_Arg, Null_Arg, t$307,  _substr(t$306,1,8), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'fctdate(', 0x800600000000L ), _iotype( $IOitem_O0, 0x2000200000000L ), _iotype( '):', 0x800600000000L ), _iotype(  _substr(fctdate(3 + $I_L344_4),1,10), 0x800600000000L ) ) )
  371.                $I_L344_4 = 1 + $I_L344_4
  371.                if ( $I_L344_4 >= -2 + ngrbs ) exit
  371.             enddo
  371.          endif
  371.       endif
  374.       return
  374.       end
  374.       
  386.       
  386.       subroutine getlstgrb( anldate, fctdate, ngrbs, nmembers, prefx, resol, lstinctl, lstingrb, lstoutctl, lstoutgrb, lstoutlst )
  386.       t$323 = ngrbs
  393.       t$375 = _zla( 0, ngrbs )
  386.       t$376 = _len( prefx )
  386.       t$377 = _len( resol )
  386.       t$324 = nmembers
  386.       t$378 = _len( lstinctl )
  398.       t$379 = _zla( 0, nmembers )
  386.       t$380 = _zla( 0, nmembers ) * _len( lstinctl )
  386.       t$381 = _zla( 0, ngrbs ) * _zla( 0, nmembers )
  386.       t$382 = _len( lstingrb )
  386.       t$383 = _zla( 0, nmembers ) * _len( lstingrb )
  386.       t$384 = _len( lstoutctl )
  386.       t$385 = _len( lstoutgrb )
  386.       t$386 = _len( lstoutlst )
  409.       if ( ngrbs > 0 ) then
  409.          $I_L409_16 = 0
  409.          do
  413.             if ( -3 + nmembers >= 0 ) then
  413.                $I_L413_12 = 0
  413.                do
  414.                   if ( $I_L409_16 == 0 ) then
  415.                      if ( 0 >= t$323 ) then
  415.                          _substr(t$394,1,11) = 'ensmed.f90'
  415.                          _substr(t$395,1,8) = 'FCTDATE'
  415.                         t$396 = 1
  415.                         call _bounds_error(  _substr(t$394,1,11), 915,  _substr(t$395,1,8), 1, 1, t$323, t$396, t$393 )
  415.                      endif
  415.                      $IOitem_O0 = ( 1 + $I_L413_12 )
  415.                      _fwrite( _clist( 0, 0, 3,  _substr(lstinctl(1 + $I_L413_12, 1),1,_len( lstinctl )), Null_Arg, Null_Arg, t$326,  _substr(t$325,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype( $IOitem_O0, 0x2000200000000L ), _iotype( 'P', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1),1,10), 0x800600000000L ), _iotype( 'P.icn.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.ctl', 0x800600000000L ) ) )
  416.                      if ( 0 >= t$323 ) then
  416.                          _substr(t$398,1,11) = 'ensmed.f90'
  416.                          _substr(t$399,1,8) = 'FCTDATE'
  416.                         t$396 = 1
  416.                         call _bounds_error(  _substr(t$398,1,11), 916,  _substr(t$399,1,8), 1, 1, t$323, t$396, t$397 )
  416.                      endif
  416.                      $IOitem_O1 = ( 1 + $I_L413_12 )
  416.                      _fwrite( _clist( 0, 0, 3,  _substr(lstingrb(1 + $I_L413_12, 1),1,_len( lstingrb )), Null_Arg, Null_Arg, t$328,  _substr(t$327,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype( $IOitem_O1, 0x2000200000000L ), _iotype( 'P', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1),1,10), 0x800600000000L ), _iotype( 'P.icn.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.grb', 0x800600000000L ) ) )
  416.                   endif
  419.                   if ( $I_L409_16 == 1 ) then
  420.                      if ( 2 > t$323 ) then
  420.                          _substr(t$401,1,11) = 'ensmed.f90'
  420.                          _substr(t$402,1,8) = 'FCTDATE'
  420.                         t$396 = 2
  420.                         call _bounds_error(  _substr(t$401,1,11), 920,  _substr(t$402,1,8), 1, 1, t$323, t$396, t$400 )
  420.                      endif
  420.                      $IOitem_O2 = ( 1 + $I_L413_12 )
  420.                      _fwrite( _clist( 0, 0, 3,  _substr(lstinctl(1 + $I_L413_12, 2),1,_len( lstinctl )), Null_Arg, Null_Arg, t$330,  _substr(t$329,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype( $IOitem_O2, 0x2000200000000L ), _iotype( 'P', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(2),1,10), 0x800600000000L ), _iotype( 'P.inz.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.ctl', 0x800600000000L ) ) )
  421.                      if ( 2 > t$323 ) then
  421.                          _substr(t$404,1,11) = 'ensmed.f90'
  421.                          _substr(t$405,1,8) = 'FCTDATE'
  421.                         t$396 = 2
  421.                         call _bounds_error(  _substr(t$404,1,11), 921,  _substr(t$405,1,8), 1, 1, t$323, t$396, t$403 )
  421.                      endif
  421.                      $IOitem_O3 = ( 1 + $I_L413_12 )
  421.                      _fwrite( _clist( 0, 0, 3,  _substr(lstingrb(1 + $I_L413_12, 2),1,_len( lstingrb )), Null_Arg, Null_Arg, t$332,  _substr(t$331,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype( $IOitem_O3, 0x2000200000000L ), _iotype( 'P', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(2),1,10), 0x800600000000L ), _iotype( 'P.inz.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.grb', 0x800600000000L ) ) )
  421.                   endif
  424.                   if ( ( 1 + $I_L409_16 ) > 2 ) then
  425.                      if ( ( ( 1 + $I_L409_16 ) <= 0 .or. ( 1 + $I_L409_16 ) > t$323 ) /= .false. ) then
  425.                          _substr(t$407,1,11) = 'ensmed.f90'
  425.                          _substr(t$408,1,8) = 'FCTDATE'
  425.                         t$396 = 1 + $I_L409_16
  425.                         call _bounds_error(  _substr(t$407,1,11), 925,  _substr(t$408,1,8), 1, 1, t$323, t$396, t$406 )
  425.                      endif
  425.                      $IOitem_O4 = ( 1 + $I_L413_12 )
  425.                      _fwrite( _clist( 0, 0, 3,  _substr(lstinctl(1 + $I_L413_12, 1 + $I_L409_16),1,_len( lstinctl )), Null_Arg, Null_Arg, t$334,  _substr(t$333,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype( $IOitem_O4, 0x2000200000000L ), _iotype( 'P', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1 + $I_L409_16),1,10), 0x800600000000L ), _iotype( 'P.fct.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.ctl', 0x800600000000L ) ) )
  426.                      if ( ( ( 1 + $I_L409_16 ) <= 0 .or. ( 1 + $I_L409_16 ) > t$323 ) /= .false. ) then
  426.                          _substr(t$410,1,11) = 'ensmed.f90'
  426.                          _substr(t$411,1,8) = 'FCTDATE'
  426.                         t$396 = 1 + $I_L409_16
  426.                         call _bounds_error(  _substr(t$410,1,11), 926,  _substr(t$411,1,8), 1, 1, t$323, t$396, t$409 )
  426.                      endif
  426.                      $IOitem_O5 = ( 1 + $I_L413_12 )
  426.                      _fwrite( _clist( 0, 0, 3,  _substr(lstingrb(1 + $I_L413_12, 1 + $I_L409_16),1,_len( lstingrb )), Null_Arg, Null_Arg, t$336,  _substr(t$335,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype( $IOitem_O5, 0x2000200000000L ), _iotype( 'P', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1 + $I_L409_16),1,10), 0x800600000000L ), _iotype( 'P.fct.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.grb', 0x800600000000L ) ) )
  426.                   endif
  429.                   $I_L413_12 = 1 + $I_L413_12
  428.                   if ( $I_L413_12 >= ( -1 + nmembers ) / 2 ) exit
  428.                enddo
  428.             endif
  431.             if ( -3 + nmembers >= 0 ) then
  431.                $I_L431_14 = 0
  431.                do
  432.                   if ( $I_L409_16 == 0 ) then
  433.                      if ( 0 >= t$323 ) then
  433.                          _substr(t$416,1,11) = 'ensmed.f90'
  433.                          _substr(t$417,1,8) = 'FCTDATE'
  433.                         t$396 = 1
  433.                         call _bounds_error(  _substr(t$416,1,11), 933,  _substr(t$417,1,8), 1, 1, t$323, t$396, t$415 )
  433.                      endif
  433.                      $IOitem_O6 = ( 1 + $I_L431_14 )
  433.                      _fwrite( _clist( 0, 0, 3,  _substr(lstinctl(1 + $I_L431_14 + ( -1 + nmembers ) / 2, 1),1,_len( lstinctl )), Null_Arg, Null_Arg, t$338,  _substr(t$337,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype( $IOitem_O6, 0x2000200000000L ), _iotype( 'N', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1),1,10), 0x800600000000L ), _iotype( 'P.icn.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.ctl', 0x800600000000L ) ) )
  434.                      if ( 0 >= t$323 ) then
  434.                          _substr(t$419,1,11) = 'ensmed.f90'
  434.                          _substr(t$420,1,8) = 'FCTDATE'
  434.                         t$396 = 1
  434.                         call _bounds_error(  _substr(t$419,1,11), 934,  _substr(t$420,1,8), 1, 1, t$323, t$396, t$418 )
  434.                      endif
  434.                      $IOitem_O7 = ( 1 + $I_L431_14 )
  434.                      _fwrite( _clist( 0, 0, 3,  _substr(lstingrb(1 + $I_L431_14 + ( -1 + nmembers ) / 2, 1),1,_len( lstingrb )), Null_Arg, Null_Arg, t$340,  _substr(t$339,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype( $IOitem_O7, 0x2000200000000L ), _iotype( 'N', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1),1,10), 0x800600000000L ), _iotype( 'P.icn.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.grb', 0x800600000000L ) ) )
  434.                   endif
  437.                   if ( $I_L409_16 == 1 ) then
  438.                      if ( 2 > t$323 ) then
  438.                          _substr(t$422,1,11) = 'ensmed.f90'
  438.                          _substr(t$423,1,8) = 'FCTDATE'
  438.                         t$396 = 2
  438.                         call _bounds_error(  _substr(t$422,1,11), 938,  _substr(t$423,1,8), 1, 1, t$323, t$396, t$421 )
  438.                      endif
  438.                      $IOitem_O8 = ( 1 + $I_L431_14 )
  438.                      _fwrite( _clist( 0, 0, 3,  _substr(lstinctl(1 + $I_L431_14 + ( -1 + nmembers ) / 2, 2),1,_len( lstinctl )), Null_Arg, Null_Arg, t$342,  _substr(t$341,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype( $IOitem_O8, 0x2000200000000L ), _iotype( 'N', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(2),1,10), 0x800600000000L ), _iotype( 'P.inz.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.ctl', 0x800600000000L ) ) )
  439.                      if ( 2 > t$323 ) then
  439.                          _substr(t$425,1,11) = 'ensmed.f90'
  439.                          _substr(t$426,1,8) = 'FCTDATE'
  439.                         t$396 = 2
  439.                         call _bounds_error(  _substr(t$425,1,11), 939,  _substr(t$426,1,8), 1, 1, t$323, t$396, t$424 )
  439.                      endif
  439.                      $IOitem_O9 = ( 1 + $I_L431_14 )
  439.                      _fwrite( _clist( 0, 0, 3,  _substr(lstingrb(1 + $I_L431_14 + ( -1 + nmembers ) / 2, 2),1,_len( lstingrb )), Null_Arg, Null_Arg, t$344,  _substr(t$343,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype( $IOitem_O9, 0x2000200000000L ), _iotype( 'N', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(2),1,10), 0x800600000000L ), _iotype( 'P.inz.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.grb', 0x800600000000L ) ) )
  439.                   endif
  442.                   if ( ( 1 + $I_L409_16 ) > 2 ) then
  443.                      if ( ( ( 1 + $I_L409_16 ) <= 0 .or. ( 1 + $I_L409_16 ) > t$323 ) /= .false. ) then
  443.                          _substr(t$428,1,11) = 'ensmed.f90'
  443.                          _substr(t$429,1,8) = 'FCTDATE'
  443.                         t$396 = 1 + $I_L409_16
  443.                         call _bounds_error(  _substr(t$428,1,11), 943,  _substr(t$429,1,8), 1, 1, t$323, t$396, t$427 )
  443.                      endif
  443.                      $IOitem_O10 = ( 1 + $I_L431_14 )
  443.                      _fwrite( _clist( 0, 0, 3,  _substr(lstinctl(1 + $I_L431_14 + ( -1 + nmembers ) / 2, 1 + $I_L409_16),1,_len( lstinctl )), Null_Arg, Null_Arg, t$346,  _substr(t$345,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype( $IOitem_O10, 0x2000200000000L ), _iotype( 'N', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1 + $I_L409_16),1,10), 0x800600000000L ), _iotype( 'P.fct.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.ctl', 0x800600000000L ) ) )
  444.                      if ( ( ( 1 + $I_L409_16 ) <= 0 .or. ( 1 + $I_L409_16 ) > t$323 ) /= .false. ) then
  444.                          _substr(t$431,1,11) = 'ensmed.f90'
  444.                          _substr(t$432,1,8) = 'FCTDATE'
  444.                         t$396 = 1 + $I_L409_16
  444.                         call _bounds_error(  _substr(t$431,1,11), 944,  _substr(t$432,1,8), 1, 1, t$323, t$396, t$430 )
  444.                      endif
  444.                      $IOitem_O11 = ( 1 + $I_L431_14 )
  444.                      _fwrite( _clist( 0, 0, 3,  _substr(lstingrb(1 + $I_L431_14 + ( -1 + nmembers ) / 2, 1 + $I_L409_16),1,_len( lstingrb )), Null_Arg, Null_Arg, t$348,  _substr(t$347,1,11), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype( $IOitem_O11, 0x2000200000000L ), _iotype( 'N', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1 + $I_L409_16),1,10), 0x800600000000L ), _iotype( 'P.fct.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.grb', 0x800600000000L ) ) )
  444.                   endif
  447.                   $I_L431_14 = 1 + $I_L431_14
  446.                   if ( $I_L431_14 >= ( -1 + nmembers ) / 2 ) exit
  446.                enddo
  446.             endif
  449.             if ( $I_L409_16 == 0 ) then
  450.                if ( 0 >= t$323 ) then
  450.                    _substr(t$434,1,11) = 'ensmed.f90'
  450.                    _substr(t$435,1,8) = 'FCTDATE'
  450.                   t$396 = 1
  450.                   call _bounds_error(  _substr(t$434,1,11), 950,  _substr(t$435,1,8), 1, 1, t$323, t$396, t$433 )
  450.                endif
  450.                _fwrite( _clist( 0, 0, 3,  _substr(lstinctl(nmembers, 1),1,_len( lstinctl )), Null_Arg, Null_Arg, t$350,  _substr(t$349,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype(  _substr(prefx,1,_ltrim(  _substr(prefx,1,_len( prefx )) )), 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1),1,10), 0x800600000000L ), _iotype( 'P.icn.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.ctl', 0x800600000000L ) ) )
  451.                if ( 0 >= t$323 ) then
  451.                    _substr(t$437,1,11) = 'ensmed.f90'
  451.                    _substr(t$438,1,8) = 'FCTDATE'
  451.                   t$396 = 1
  451.                   call _bounds_error(  _substr(t$437,1,11), 951,  _substr(t$438,1,8), 1, 1, t$323, t$396, t$436 )
  451.                endif
  451.                _fwrite( _clist( 0, 0, 3,  _substr(lstingrb(nmembers, 1),1,_len( lstingrb )), Null_Arg, Null_Arg, t$352,  _substr(t$351,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype(  _substr(prefx,1,_ltrim(  _substr(prefx,1,_len( prefx )) )), 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1),1,10), 0x800600000000L ), _iotype( 'P.icn.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.grb', 0x800600000000L ) ) )
  451.             endif
  454.             if ( $I_L409_16 == 1 ) then
  455.                if ( 2 > t$323 ) then
  455.                    _substr(t$440,1,11) = 'ensmed.f90'
  455.                    _substr(t$441,1,8) = 'FCTDATE'
  455.                   t$396 = 2
  455.                   call _bounds_error(  _substr(t$440,1,11), 955,  _substr(t$441,1,8), 1, 1, t$323, t$396, t$439 )
  455.                endif
  455.                _fwrite( _clist( 0, 0, 3,  _substr(lstinctl(nmembers, 2),1,_len( lstinctl )), Null_Arg, Null_Arg, t$354,  _substr(t$353,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype(  _substr(prefx,1,_ltrim(  _substr(prefx,1,_len( prefx )) )), 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(2),1,10), 0x800600000000L ), _iotype( 'P.inz.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.ctl', 0x800600000000L ) ) )
  456.                if ( 2 > t$323 ) then
  456.                    _substr(t$443,1,11) = 'ensmed.f90'
  456.                    _substr(t$444,1,8) = 'FCTDATE'
  456.                   t$396 = 2
  456.                   call _bounds_error(  _substr(t$443,1,11), 956,  _substr(t$444,1,8), 1, 1, t$323, t$396, t$442 )
  456.                endif
  456.                _fwrite( _clist( 0, 0, 3,  _substr(lstingrb(nmembers, 2),1,_len( lstingrb )), Null_Arg, Null_Arg, t$356,  _substr(t$355,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype(  _substr(prefx,1,_ltrim(  _substr(prefx,1,_len( prefx )) )), 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(2),1,10), 0x800600000000L ), _iotype( 'P.inz.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.grb', 0x800600000000L ) ) )
  456.             endif
  459.             if ( ( 1 + $I_L409_16 ) > 2 ) then
  460.                if ( ( ( 1 + $I_L409_16 ) <= 0 .or. ( 1 + $I_L409_16 ) > t$323 ) /= .false. ) then
  460.                    _substr(t$446,1,11) = 'ensmed.f90'
  460.                    _substr(t$447,1,8) = 'FCTDATE'
  460.                   t$396 = 1 + $I_L409_16
  460.                   call _bounds_error(  _substr(t$446,1,11), 960,  _substr(t$447,1,8), 1, 1, t$323, t$396, t$445 )
  460.                endif
  460.                _fwrite( _clist( 0, 0, 3,  _substr(lstinctl(nmembers, 1 + $I_L409_16),1,_len( lstinctl )), Null_Arg, Null_Arg, t$358,  _substr(t$357,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype(  _substr(prefx,1,_ltrim(  _substr(prefx,1,_len( prefx )) )), 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1 + $I_L409_16),1,10), 0x800600000000L ), _iotype( 'P.fct.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.ctl', 0x800600000000L ) ) )
  461.                if ( ( ( 1 + $I_L409_16 ) <= 0 .or. ( 1 + $I_L409_16 ) > t$323 ) /= .false. ) then
  461.                    _substr(t$449,1,11) = 'ensmed.f90'
  461.                    _substr(t$450,1,8) = 'FCTDATE'
  461.                   t$396 = 1 + $I_L409_16
  461.                   call _bounds_error(  _substr(t$449,1,11), 961,  _substr(t$450,1,8), 1, 1, t$323, t$396, t$448 )
  461.                endif
  461.                _fwrite( _clist( 0, 0, 3,  _substr(lstingrb(nmembers, 1 + $I_L409_16),1,_len( lstingrb )), Null_Arg, Null_Arg, t$360,  _substr(t$359,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOS', 0x800600000000L ), _iotype(  _substr(prefx,1,_ltrim(  _substr(prefx,1,_len( prefx )) )), 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1 + $I_L409_16),1,10), 0x800600000000L ), _iotype( 'P.fct.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.grb', 0x800600000000L ) ) )
  461.             endif
  465.             if ( $I_L409_16 == 0 ) then
  466.                if ( 0 >= t$323 ) then
  466.                    _substr(t$452,1,11) = 'ensmed.f90'
  466.                    _substr(t$453,1,8) = 'FCTDATE'
  466.                   t$396 = 1
  466.                   call _bounds_error(  _substr(t$452,1,11), 966,  _substr(t$453,1,8), 1, 1, t$323, t$396, t$451 )
  466.                endif
  466.                _fwrite( _clist( 0, 0, 3,  _substr(lstoutctl(1),1,_len( lstoutctl )), Null_Arg, Null_Arg, t$362,  _substr(t$361,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOSENM', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1),1,10), 0x800600000000L ), _iotype( 'P.icn.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.ctl', 0x800600000000L ) ) )
  468.                if ( 0 >= t$323 ) then
  468.                    _substr(t$455,1,11) = 'ensmed.f90'
  468.                    _substr(t$456,1,8) = 'FCTDATE'
  468.                   t$396 = 1
  468.                   call _bounds_error(  _substr(t$455,1,11), 968,  _substr(t$456,1,8), 1, 1, t$323, t$396, t$454 )
  468.                endif
  468.                _fwrite( _clist( 0, 0, 3,  _substr(lstoutgrb(1),1,_len( lstoutgrb )), Null_Arg, Null_Arg, t$364,  _substr(t$363,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOSENM', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1),1,10), 0x800600000000L ), _iotype( 'P.icn.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.grb', 0x800600000000L ) ) )
  468.             endif
  471.             if ( $I_L409_16 == 1 ) then
  472.                if ( 2 > t$323 ) then
  472.                    _substr(t$458,1,11) = 'ensmed.f90'
  472.                    _substr(t$459,1,8) = 'FCTDATE'
  472.                   t$396 = 2
  472.                   call _bounds_error(  _substr(t$458,1,11), 972,  _substr(t$459,1,8), 1, 1, t$323, t$396, t$457 )
  472.                endif
  472.                _fwrite( _clist( 0, 0, 3,  _substr(lstoutctl(2),1,_len( lstoutctl )), Null_Arg, Null_Arg, t$366,  _substr(t$365,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOSENM', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(2),1,10), 0x800600000000L ), _iotype( 'P.inz.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.ctl', 0x800600000000L ) ) )
  474.                if ( 2 > t$323 ) then
  474.                    _substr(t$461,1,11) = 'ensmed.f90'
  474.                    _substr(t$462,1,8) = 'FCTDATE'
  474.                   t$396 = 2
  474.                   call _bounds_error(  _substr(t$461,1,11), 974,  _substr(t$462,1,8), 1, 1, t$323, t$396, t$460 )
  474.                endif
  474.                _fwrite( _clist( 0, 0, 3,  _substr(lstoutgrb(2),1,_len( lstoutgrb )), Null_Arg, Null_Arg, t$368,  _substr(t$367,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOSENM', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(2),1,10), 0x800600000000L ), _iotype( 'P.inz.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.grb', 0x800600000000L ) ) )
  474.             endif
  477.             if ( ( 1 + $I_L409_16 ) > 2 ) then
  478.                if ( ( ( 1 + $I_L409_16 ) <= 0 .or. ( 1 + $I_L409_16 ) > t$323 ) /= .false. ) then
  478.                    _substr(t$464,1,11) = 'ensmed.f90'
  478.                    _substr(t$465,1,8) = 'FCTDATE'
  478.                   t$396 = 1 + $I_L409_16
  478.                   call _bounds_error(  _substr(t$464,1,11), 978,  _substr(t$465,1,8), 1, 1, t$323, t$396, t$463 )
  478.                endif
  478.                _fwrite( _clist( 0, 0, 3,  _substr(lstoutctl(1 + $I_L409_16),1,_len( lstoutctl )), Null_Arg, Null_Arg, t$370,  _substr(t$369,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOSENM', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1 + $I_L409_16),1,10), 0x800600000000L ), _iotype( 'P.fct.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.ctl', 0x800600000000L ) ) )
  480.                if ( ( ( 1 + $I_L409_16 ) <= 0 .or. ( 1 + $I_L409_16 ) > t$323 ) /= .false. ) then
  480.                    _substr(t$467,1,11) = 'ensmed.f90'
  480.                    _substr(t$468,1,8) = 'FCTDATE'
  480.                   t$396 = 1 + $I_L409_16
  480.                   call _bounds_error(  _substr(t$467,1,11), 980,  _substr(t$468,1,8), 1, 1, t$323, t$396, t$466 )
  480.                endif
  480.                _fwrite( _clist( 0, 0, 3,  _substr(lstoutgrb(1 + $I_L409_16),1,_len( lstoutgrb )), Null_Arg, Null_Arg, t$372,  _substr(t$371,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOSENM', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(1 + $I_L409_16),1,10), 0x800600000000L ), _iotype( 'P.fct.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.grb', 0x800600000000L ) ) )
  480.             endif
  484.             $I_L409_16 = 1 + $I_L409_16
  482.             if ( $I_L409_16 >= ngrbs ) exit
  482.          enddo
  482.       endif
  485.       if ( ( ngrbs <= 0 .or. ngrbs > t$323 ) /= .false. ) then
  485.           _substr(t$470,1,11) = 'ensmed.f90'
  485.           _substr(t$471,1,8) = 'FCTDATE'
  485.          t$396 = ngrbs
  485.          call _bounds_error(  _substr(t$470,1,11), 985,  _substr(t$471,1,8), 1, 1, t$323, t$396, t$469 )
  485.       endif
  485.       _fwrite( _clist( 0, 0, 3,  _substr(lstoutlst,1,_len( lstoutlst )), Null_Arg, Null_Arg, t$374,  _substr(t$373,1,4), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( 'GPOSENM', 0x800600000000L ), _iotype(  _substr(anldate,1,10), 0x800600000000L ), _iotype(  _substr(fctdate(ngrbs),1,10), 0x800600000000L ), _iotype( 'P.fct.', 0x800600000000L ), _iotype(  _substr(resol,1,_ltrim(  _substr(resol,1,_len( resol )) )), 0x800600000000L ), _iotype( '.lst', 0x800600000000L ) ) )
  489.       return
  489.       end
  489.       
  503.       
  503.       subroutine createctlgrib( unitin, unitout, lstoutgrb )
  503.       t$488 = _len( lstoutgrb )
  516.       lname = _ltrim(  _substr(lstoutgrb,1,_len( lstoutgrb )) )
  518.       t$489 = 6 + ( _ltrim(  _substr(lstoutgrb,1,_len( lstoutgrb )) ) )
  518.       t$491 = int( _alloc( _zla( 0, t$489 ) ), 8 )
  518.        _substr(t$490,1,_zla( 0, t$489 )) = //( 'dset ^',  _substr(lstoutgrb,1,_ltrim(  _substr(lstoutgrb,1,_len( lstoutgrb )) )) )
  518.       $Unit_temp_O0 = unitout
  518.       _fwrite( _clist( 0, 0, 3, $Unit_temp_O0, Null_Arg, Null_Arg, t$473,  _substr(t$472,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(t$490,1,_zla( 0, t$489 )), 0x800600000000L ) ) )
  518.       _free( t$491 )
  519.       $Unit_temp_O1 = unitout
  519.       _fwrite( _clist( 0, 0, 3, $Unit_temp_O1, Null_Arg, Null_Arg, t$475,  _substr(t$474,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype( '*', 0x800600000000L ) ) )
  520.       t$492 = 11 + _zla( 0, -4 + lname )
  520.       t$494 = int( _alloc( _zla( 0, 11 + _zla( 0, -4 + lname ) ) ), 8 )
  520.        _substr(t$493,1,_zla( 0, 11 + _zla( 0, -4 + lname ) )) = //( 'index ^', //(  _substr(lstoutgrb,1,_zla( 0, -4 + lname )), '.idx' ) )
  520.       $Unit_temp_O2 = unitout
  520.       _fwrite( _clist( 0, 0, 3, $Unit_temp_O2, Null_Arg, Null_Arg, t$477,  _substr(t$476,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(t$493,1,_zla( 0, 11 + _zla( 0, -4 + lname ) )), 0x800600000000L ) ) )
  520.       _free( t$494 )
  522.       $Unit_temp_O3 = unitin
  522.       _fread( _clist( 0, 0, 3, $Unit_temp_O3, Null_Arg, Null_Arg, t$479,  _substr(t$478,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(line,1,256), 0x800600000000L ) ) )
  523.       $Unit_temp_O4 = unitin
  523.       _fread( _clist( 0, 0, 3, $Unit_temp_O4, Null_Arg, Null_Arg, t$481,  _substr(t$480,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(line,1,256), 0x800600000000L ) ) )
  524.       $Unit_temp_O5 = unitin
  524.       _fread( _clist( 0, 0, 3, $Unit_temp_O5, Null_Arg, Null_Arg, t$483,  _substr(t$482,1,3), Null_Arg, Null_Arg, Null_Arg, Null_Arg, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(line,1,256), 0x800600000000L ) ) )
  524.       do
  528.          $Unit_temp_O6 = unitin
  528.          t$495 = _fread( _clist( 0, 1, 3, $Unit_temp_O6, ierr, Null_Arg, t$485,  _substr(t$484,1,3), Null_Arg, Null_Arg, Null_Arg, 0x2000200000000L, 0, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg, Null_Arg ), _iolist( _iotype(  _substr(line,1,256), 0x800600000000L ) ) )
  529.          if ( ierr /= 0 ) goto 10
  530.          $Unit_temp_O7 = unitout
  530.       enddo
  530.    10 continue
  534.       return
  534.       end
  534.       
